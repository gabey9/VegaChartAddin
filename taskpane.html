<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Vega Chart</title>
    <!-- Office JavaScript API -->
    <script type="text/javascript" src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega@6"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-lite@6"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-embed@6"></script>
    <script type="module" src="./taskpane.js"></script>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            margin: 20px;
            line-height: 1.4;
        }
        
        .chart-selector {
            margin-bottom: 15px;
        }
        
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
            color: #323130;
        }
        
        /* Custom Dropdown Styles */
        .custom-dropdown {
            position: relative;
            width: 100%;
        }
        
        .dropdown-header {
            width: 100%;
            padding: 8px 12px;
            border: 1px solid #8a8886;
            border-radius: 4px;
            font-size: 14px;
            background: white;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-sizing: border-box;
        }
        
        .dropdown-header:hover {
            border-color: #0078d4;
        }
        
        .dropdown-arrow {
            font-size: 12px;
            transition: transform 0.2s;
        }
        
        .dropdown-arrow.expanded {
            transform: rotate(180deg);
        }
        
        .dropdown-list {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: white;
            border: 1px solid #8a8886;
            border-top: none;
            border-radius: 0 0 4px 4px;
            max-height: 300px;
            overflow-y: auto;
            z-index: 1000;
            display: none;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        .dropdown-list.open {
            display: block;
        }
        
        .folder-item {
            padding: 8px 12px;
            cursor: pointer;
            font-weight: 600;
            color: #0078d4;
            background: #f8f9fa;
            border-bottom: 1px solid #e1e4e8;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .folder-item:hover {
            background: #e3f2fd;
        }
        
        .folder-arrow {
            font-size: 10px;
            transition: transform 0.2s;
        }
        
        .folder-arrow.expanded {
            transform: rotate(90deg);
        }
        
        .chart-item {
            padding: 8px 12px 8px 32px;
            cursor: pointer;
            color: #323130;
            border-bottom: 1px solid #f0f0f0;
            display: none;
        }
        
        .chart-item.visible {
            display: block;
        }
        
        .chart-item:hover {
            background: #f5f5f5;
        }
        
        .chart-item:last-child {
            border-bottom: none;
        }
        
        button {
            background-color: #0078d4;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            font-size: 14px;
            cursor: pointer;
            width: 100%;
            margin-bottom: 15px;
        }
        
        button:hover {
            background-color: #106ebe;
        }
        
        .data-requirements {
            background-color: #f8f9fa;
            border: 1px solid #e1e4e8;
            border-radius: 6px;
            padding: 12px;
            margin-top: 10px;
            font-size: 13px;
        }
        
        .data-requirements h4 {
            margin: 0 0 8px 0;
            color: #24292f;
            font-size: 14px;
        }
        
        .data-requirements ul {
            margin: 0;
            padding-left: 18px;
        }
        
        .data-requirements li {
            margin-bottom: 4px;
        }
               
        .hidden {
            display: none;
        }
    </style>
</head>
<body>
    <h2></h2>
    
    <div class="chart-selector">
        <label for="chartDropdown">Select Chart Type:</label>
        <div class="custom-dropdown" id="chartDropdown">
            <div class="dropdown-header" id="dropdownHeader">
                <span id="selectedText">Choose a chart...</span>
                <span class="dropdown-arrow">▼</span>
            </div>
            <div class="dropdown-list" id="dropdownList">
                <div class="folder-item" data-folder="standard">
                    <span>Standard</span>
                    <span class="folder-arrow">►</span>
                </div>
                <div class="chart-item" data-chart="bar" data-folder="standard">Bar</div>
                <div class="chart-item" data-chart="line" data-folder="standard">Line</div>
                <div class="chart-item" data-chart="area" data-folder="standard">Area</div>
                <div class="chart-item" data-chart="point" data-folder="standard">Scatter</div>
                <div class="chart-item" data-chart="bubble" data-folder="standard">Bubble</div>
                <div class="chart-item" data-chart="pie" data-folder="standard">Pie</div>
                <div class="chart-item" data-chart="donut" data-folder="standard">Donut</div>
                <div class="chart-item" data-chart="box" data-folder="standard">Box</div>
                <div class="chart-item" data-chart="radar" data-folder="standard">Radar</div>
                <div class="chart-item" data-chart="map" data-folder="standard">Map</div>
                <div class="chart-item" data-chart="contour" data-folder="standard">Contour</div>
                <div class="chart-item" data-chart="histogram" data-folder="standard">Histogram</div>
                <div class="chart-item" data-chart="funnel" data-folder="standard">Funnel</div>
                <div class="chart-item" data-chart="candlestick" data-folder="standard">Candlestick</div>                          
                <div class="chart-item" data-chart="treemap" data-folder="standard">Treemap</div>
                <div class="chart-item" data-chart="sunburst" data-folder="standard">Sunburst</div>
                <div class="chart-item" data-chart="waterfall" data-folder="standard">Waterfall</div>                
                
                <div class="folder-item" data-folder="special">
                    <span>Special</span>
                    <span class="folder-arrow">►</span>
                </div>
                <div class="chart-item" data-chart="step" data-folder="special">Step</div>
                <div class="chart-item" data-chart="butterfly" data-folder="special">Butterfly</div>
                <div class="chart-item" data-chart="beeswarm" data-folder="special">Beeswarm</div>
                <div class="chart-item" data-chart="radial" data-folder="special">Radial</div>
                <div class="chart-item" data-chart="gauge" data-folder="special">Gauge</div>
                <div class="chart-item" data-chart="ring" data-folder="special">Ring</div>
                <div class="chart-item" data-chart="arc" data-folder="special">Arc</div>
                <div class="chart-item" data-chart="chord" data-folder="special">Chord</div>
                <div class="chart-item" data-chart="circlepack" data-folder="special">Circlepack</div>
                <div class="chart-item" data-chart="tree" data-folder="special">Tree</div>
                <div class="chart-item" data-chart="wordcloud" data-folder="special">Wordcloud</div>
                <div class="chart-item" data-chart="gantt" data-folder="special">Gantt</div>
                <div class="chart-item" data-chart="strip" data-folder="special">Strip</div>
                <div class="chart-item" data-chart="density" data-folder="special">Density</div>
                <div class="chart-item" data-chart="heatmap" data-folder="special">Heatmap</div>
                <div class="chart-item" data-chart="bullet" data-folder="special">Bullet</div>
                <div class="chart-item" data-chart="horizon" data-folder="special">Horizon</div>
                <div class="chart-item" data-chart="dumbbell" data-folder="special">Dumbbell</div>
                <div class="chart-item" data-chart="slope" data-folder="special">Slope</div>
                <div class="chart-item" data-chart="mekko" data-folder="special">Mekko</div>
                <div class="chart-item" data-chart="marimekko" data-folder="special">Marimekko</div>                
                <div class="chart-item" data-chart="bump" data-folder="special">Bump</div>
                <div class="chart-item" data-chart="fan" data-folder="special">Fan</div>
                <div class="chart-item" data-chart="waffle" data-folder="special">Waffle</div>
                <div class="chart-item" data-chart="lollipop" data-folder="special">Lollipop</div>
                <div class="chart-item" data-chart="violin" data-folder="special">Violin</div>
                <div class="chart-item" data-chart="sankey" data-folder="special">Sankey</div>
                <div class="chart-item" data-chart="streamgraph" data-folder="special">Streamgraph</div>
                <div class="chart-item" data-chart="ribbon" data-folder="special">Ribbon</div>
                <div class="chart-item" data-chart="ridgeline" data-folder="special">Ridgeline</div>
                <div class="chart-item" data-chart="deviation" data-folder="special">Deviation</div>
                <div class="chart-item" data-chart="variance" data-folder="special">Variance</div>                 
            </div>
        </div>
    </div>
    
    <button id="drawChart">Generate Chart</button>
    
    <!-- Hidden select for taskpane.js compatibility -->
    <select id="chartType" style="display: none;">
        <option value="">Choose a chart...</option>
        <option value="bar">Bar</option>
        <option value="butterfly">Butterfly</option>
        <option value="beeswarm">Beeswarm</option>
        <option value="line">Line</option>
        <option value="step">Step</option>
        <option value="area">Area</option>
        <option value="point">Scatter</option>
        <option value="bubble">Bubble</option>
        <option value="gauge">Gauge</option>
        <option value="pie">Pie</option>
        <option value="donut">Donut</option>
        <option value="ring">Ring</option>
        <option value="box">Box</option>
        <option value="histogram">Histogram</option>
        <option value="density">Density</option>
        <option value="funnel">Funnel</option>
        <option value="candlestick">Candlestick</option>
        <option value="map">Map</option>
        <option value="contour">Contour</option>
        <option value="radar">Radar</option>
        <option value="heatmap">Heatmap</option>
        <option value="radial">Radial</option>
        <option value="arc">Arc</option>
        <option value="chord">Chord</option>
        <option value="circlepack">Circlepack</option>
        <option value="tree">Tree</option>
        <option value="wordcloud">Wordcloud</option>
        <option value="gantt">Gantt</option>
        <option value="strip">Strip</option>
        <option value="treemap">Treemap</option>
        <option value="sunburst">Sunburst</option>
        <option value="bullet">Bullet</option>
        <option value="horizon">Horizon</option>
        <option value="dumbbell">Dumbbell</option>
        <option value="slope">Slope</option>
        <option value="mekko">Mekko</option>
        <option value="marimekko">Marimekko</option>
        <option value="bump">Bump</option>
        <option value="fan">Fan</option>
        <option value="waffle">Waffle</option>
        <option value="lollipop">Lollipop</option>
        <option value="violin">Violin</option>
        <option value="sankey">Sankey</option>
        <option value="streamgraph">Streamgraph</option>
        <option value="ribbon">Ribbon</option>
        <option value="ridgeline">Ridgeline</option>
        <option value="deviation">Deviation</option>
        <option value="variance">Variance</option>
        <option value="waterfall">Waterfall</option>
    </select>
    
    <!-- Data Requirements for each chart type -->
    <div id="req-point" class="data-requirements hidden">
        <h4>Data Requirements:</h4>
        <ul>
            <li><strong>Column 1:</strong> X-axis values (numbers)</li>
            <li><strong>Column 2:</strong> Y-axis values (numbers)</li>
            <li><strong>Column 3 (optional):</strong> Color grouping (categories for different colors)</li>
            <li><strong>Column 4 (optional):</strong> Shape grouping (categories for different shapes)</li>
        </ul>
    </div>

    <div id="req-bubble" class="data-requirements hidden">
        <h4>Data Requirements:</h4>
        <ul>
            <li><strong>Column 1:</strong> X-axis values (numbers)</li>
            <li><strong>Column 2:</strong> Y-axis values (numbers)</li>
            <li><strong>Column 3:</strong> Bubble size values (numbers)</li>
            <li><strong>Column 4 (optional):</strong> Color grouping (categories for different colors)</li>
        </ul>
    </div>

    <div id="req-bar" class="data-requirements hidden">
        <h4>Data Requirements:</h4>
        <ul>
            <li><strong>Column 1:</strong> Categories or X-axis values</li>
            <li><strong>Column 2:</strong> Values (numbers)</li>
            <li><strong>Column 3 (optional):</strong> Grouping variable for grouped bars</li>
        </ul>
    </div>
    
    <div id="req-funnel" class="data-requirements hidden">
        <h4>Data Requirements:</h4>
        <ul>
            <li><strong>Column 1:</strong> Stage names</li>
            <li><strong>Column 2:</strong> Values</li>
        </ul>
    </div>

    <div id="req-butterfly" class="data-requirements hidden">
        <h4>Data Requirements:</h4>
        <ul>
            <li><strong>Column 1:</strong> Category names (e.g., age groups, regions, products)</li>
            <li><strong>Column 2:</strong> Left side values (will be displayed on left)</li>
            <li><strong>Column 3:</strong> Right side values (will be displayed on right)</li>
        </ul>
    </div>

    <div id="req-beeswarm" class="data-requirements hidden">
        <h4>Data Requirements:</h4>
        <ul>
            <li><strong>Column 1:</strong> Category/Group names</li>
            <li><strong>Column 2:</strong> Numeric Values</li>
        </ul>
    </div>

    <div id="req-line" class="data-requirements hidden">
        <h4>Data Requirements:</h4>
        <ul>
            <li><strong>Column 1:</strong> X-axis values (often dates/time or categories)</li>
            <li><strong>Columns 2-n:</strong> Value series</li>
        </ul>
    </div>
    
    <div id="req-step" class="data-requirements hidden">
        <h4>Data Requirements:</h4>
        <ul>
            <li><strong>Column 1:</strong> Date/Time values (temporal data)</li>
            <li><strong>Column 2:</strong> Quantitative values (e.g., price, stock value)</li>
        </ul>
    </div>

    <div id="req-area" class="data-requirements hidden">
        <h4>Data Requirements:</h4>
        <ul>
            <li><strong>Column 1:</strong> X-axis values (often dates/time)</li>
            <li><strong>Column 2:</strong> Y-axis values (numbers)</li>
            <li><strong>Column 3 (optional):</strong> Series grouping for multiple areas</li>
        </ul>
    </div>

    <div id="req-horizon" class="data-requirements hidden">
        <h4>Data Requirements:</h4>
        <ul>
            <li><strong>Column 1:</strong> X-axis values (time periods, dates, or sequence numbers)</li>
            <li><strong>Column 2:</strong> Y-axis values (numeric data to visualize)</li>
        </ul>
    </div>

    <div id="req-dumbbell" class="data-requirements hidden">
        <h4>Data Requirements:</h4>
        <ul>
            <li><strong>Column 1:</strong> Categories</li>
            <li><strong>Column 2:</strong> First measure (number)</li>
            <li><strong>Column 3:</strong> Second measure (number)</li>
        </ul>
    </div>

    <div id="req-slope" class="data-requirements hidden">
        <h4>Data Requirements:</h4>
        <ul>
            <li><strong>Column 1:</strong> Time periods (e.g., "2023", "2024" or "Q1", "Q4")</li>
            <li><strong>Column 2:</strong> Categories/Series (e.g., "Product A", "Region 1")</li>
            <li><strong>Column 3:</strong> Values (numbers)</li>
        </ul>
    </div>

    <div id="req-radar" class="data-requirements hidden">
        <h4>Data Requirements:</h4>
        <ul>
            <li><strong>Column 1:</strong> Series/Category name (e.g., "Product A", "Team 1")</li>
            <li><strong>Columns 2-n:</strong> Dimension values (e.g., "Speed", "Quality", "Cost")</li>
        </ul>
    </div>
   
    <div id="req-box" class="data-requirements hidden">
        <h4>Data Requirements:</h4>
        <ul>
            <li><strong>Column 1:</strong> Categories/Groups (e.g., "Species", "Department", "Region")</li>
            <li><strong>Column 2:</strong> Values for distribution analysis (numbers)</li>
        </ul>
    </div>

    <div id="req-gauge" class="data-requirements hidden">
        <h4>Data Requirements:</h4>
        <ul>
            <li><strong>Column 1:</strong> Current value (numbers)</li>
            <li><strong>Column 2:</strong> Maximum value (numbers)</li>
        </ul>
    </div>

    <div id="req-pie" class="data-requirements hidden">
        <h4>Data Requirements:</h4>
        <ul>
            <li><strong>Column 1:</strong> Category names</li>
	        <li><strong>Column 2:</strong> Values (numbers for slice sizes)</li>
        </ul>
    </div>
 
    <div id="req-donut" class="data-requirements hidden">
        <h4>Data Requirements:</h4>
        <ul>
            <li><strong>Column 1:</strong> Category names</li>
	        <li><strong>Column 2:</strong> Values (numbers for slice sizes)</li>
        </ul>
    </div>

    <div id="req-ring" class="data-requirements hidden">
        <h4>Data Requirements:</h4>
        <ul>
            <li><strong>Column 1:</strong> Category names (e.g., "Online Sales", "Retail Sales", "Partner Sales")</li>
            <li><strong>Column 2:</strong> Values as percentages (0-100, e.g., 75, 60, 45)</li>
        </ul>
    </div>

    <div id="req-histogram" class="data-requirements hidden">
        <h4>Data Requirements:</h4>
        <ul>
            <li><strong>Column 1:</strong> Continuous numeric values to create distribution bins</li>
        </ul>
    </div>

    <div id="req-density" class="data-requirements hidden">
        <h4>Data Requirements:</h4>
        <ul>
            <li><strong>Column 1:</strong> Numeric values</li>
        </ul>
    </div>

    <div id="req-map" class="data-requirements hidden">
        <h4>Data Requirements:</h4>
        <ul>
            <li><strong>Column 1:</strong> Country ISO (e.g., "USA", "CAN", "MEX")</li>
            <li><strong>Column 2:</strong> Values to visualize (numbers for color intensity)</li>
        </ul>
    </div>

    <div id="req-contour" class="data-requirements hidden">
        <h4>Data Requirements:</h4>
        <ul>
            <li><strong>Column 1:</strong> X-axis values</li>
            <li><strong>Column 2:</strong> Y-axis values</li>
            <li><strong>Column 3 (Optional):</strong> Categories/Groups</li>
        </ul>
    </div>

    <div id="req-candlestick" class="data-requirements hidden">
        <h4>Data Requirements:</h4>
        <ul>
            <li><strong>Column 1:</strong> Date/Time (Excel date values or date strings)</li>
            <li><strong>Column 2:</strong> Open price (numbers)</li>
            <li><strong>Column 3:</strong> High price (numbers)</li>
            <li><strong>Column 4:</strong> Low price (numbers)</li>
            <li><strong>Column 5:</strong> Close price (numbers)</li>
        </ul>
    </div>

    <div id="req-radial" class="data-requirements hidden">
        <h4>Data Requirements:</h4>
        <ul>
            <li><strong>Column 1:</strong> Category names</li>
            <li><strong>Column 2:</strong> Values (determines both angle and radius)</li>
        </ul>
    </div>
  
    <div id="req-arc" class="data-requirements hidden">
        <h4>Data Requirements:</h4>
        <ul>
            <li><strong>Column 1:</strong> Source node/entity (e.g., "Person A", "Department 1")</li>
            <li><strong>Column 2:</strong> Target node/entity (e.g., "Person B", "Department 2")</li>
            <li><strong>Column 3:</strong> Connection strength/weight (numbers, optional)</li>
        </ul>
    </div>

    <div id="req-chord" class="data-requirements hidden">
        <h4>Data Requirements:</h4>
        <ul>
            <li><strong>Column 1:</strong> Source category</li>
            <li><strong>Column 2:</strong> Destination category</li>
            <li><strong>Column 3:</strong> Flow values (numbers)</li>
        </ul>
    </div>

    <div id="req-circlepack" class="data-requirements hidden">
        <h4>Data Requirements:</h4>
        <ul>
            <li>Column 1: Parent category (text)</li>
            <li>Column 2: Child category (text)</li>
            <li>Column 3 (optional): Size value</li>
        </ul>
    </div>
    
    <div id="req-tree" class="data-requirements hidden">
        <h4>Data Requirements:</h4>
        <ul>
            <li><strong>Column 1:</strong> Parent (parent node name, empty for root nodes)</li>
            <li><strong>Column 2:</strong> Child (child node name)</li>
            <li><strong>Column 3 (optional):</strong> Value (affects node size, defaults to 1)</li>
        </ul>
    </div>

    <div id="req-strip" class="data-requirements hidden">
        <h4>Data Requirements:</h4>
        <ul>
	        <li><strong>Column 1:</strong> Categories</li>
            <li><strong>Column 2:</strong> Values</li>            
            <li><strong>Column 3 (optional):</strong> Color grouping (e.g., Brand, Region, Type)</li>
        </ul>
    </div>
 
    <div id="req-treemap" class="data-requirements hidden">
        <h4>Data Requirements:</h4>
        <ul>
            <li><strong>Column 1:</strong> Parent/Group hierarchy (e.g., Region, Division)</li>
            <li><strong>Column 2:</strong> Category/Item names (e.g., Product, Department, File)</li>
            <li><strong>Column 3:</strong> Values/Sizes (e.g., Sales, Budget, File Size)</li>            
        </ul>
    </div>

    <div id="req-sunburst" class="data-requirements hidden">
        <h4>Data Requirements:</h4>
        <ul>
            <li><strong>Column 1:</strong> Parent (parent category, empty for root level)</li>
            <li><strong>Column 2:</strong> Child (child category or item name)</li>
            <li><strong>Column 3 (optional):</strong> Value (size of the segment, defaults to 1)</li>
        </ul>
    </div>

    <div id="req-wordcloud" class="data-requirements hidden">
        <h4>Data Requirements:</h4>
        <ul>
            <li><strong>Column 1:</strong> Text data (sentences, phrases, or words)</li>
        </ul>
    </div>

    <div id="req-gantt" class="data-requirements hidden">
        <h4>Data Requirements:</h4>
        <ul>
            <li><strong>Column 1:</strong> Task ID (number, empty for root tasks)</li>
            <li><strong>Column 2:</strong> Sub Task ID (number)</li>          
            <li><strong>Column 3:</strong> Sub Task Name (text)</li>
            <li><strong>Column 4:</strong> Start Date (date)</li>
            <li><strong>Column 5:</strong> End Date (date)</li>
            <li><strong>Column 6:</strong> Progress (0-1 decimal or percentage)</li>
        </ul>
    </div>
 
    <div id="req-lollipop" class="data-requirements hidden">
        <h4>Data Requirements:</h4>
        <ul>
            <li><strong>Column 1:</strong> Category names (e.g., "Products", "Regions", "Teams")</li>
            <li><strong>Column 2:</strong> Values (numbers for stick length and circle size)</li>
        </ul>
    </div>

    <div id="req-waffle" class="data-requirements hidden">
        <h4>Data Requirements:</h4>
        <ul>
            <li><strong>Column 1:</strong> Category names (e.g., "Product A", "Product B")</li>
            <li><strong>Column 2:</strong> Values (numbers that will be converted to percentages)</li>
        </ul>
    </div>

    <div id="req-bullet" class="data-requirements hidden">
        <h4>Data Requirements:</h4>
        <ul>
            <li><strong>Column 1:</strong> Title/Metric name (e.g., "Revenue", "Profit")</li>
            <li><strong>Column 2:</strong> Poor range max</li>
            <li><strong>Column 3:</strong> Satisfactory range max</li>
            <li><strong>Column 4:</strong> Good range max</li>
            <li><strong>Column 5:</strong> Actual value</li>
            <li><strong>Column 6:</strong> Forecast value (optional)</li>
            <li><strong>Column 7:</strong> Target value (marker)</li>
        </ul>
    </div>

    <div id="req-mekko" class="data-requirements hidden">
        <h4>Data Requirements:</h4>
        <ul>
            <li><strong>Column 1:</strong> Category (text)</li>
            <li><strong>Column 2:</strong> Subcategory (text)</li>
            <li><strong>Column 3:</strong> Value (number)</li>
        </ul>
    </div>

    <div id="req-marimekko" class="data-requirements hidden">
        <h4>Data Requirements:</h4>
        <ul>
            <li><strong>Column 1:</strong> Category (text)</li>
            <li><strong>Column 2:</strong> Subcategory (text)</li>
            <li><strong>Column 3:</strong> Value (number)</li>
        </ul>
    </div>

    <div id="req-heatmap" class="data-requirements hidden">
        <h4>Data Requirements:</h4>
        <ul>
            <li><strong>Column 1:</strong> Y-axis categories (e.g., "Months", "Products", "Regions")</li>
            <li><strong>Column 2:</strong> X-axis categories (e.g., "Days", "Quarters", "Sales Reps")</li>
            <li><strong>Column 3:</strong> Values (numbers for color intensity)</li>
        </ul>
    </div>
   
    <div id="req-bump" class="data-requirements hidden">
        <h4>Data Requirements:</h4>
        <ul>
            <li><strong>Column 1:</strong> Time periods</li>
            <li><strong>Column 2:</strong> Categories (e.g., "Team A", "Team B")</li>
            <li><strong>Column 3:</strong> Rank values (1, 2, 3, etc.)</li>
        </ul>
    </div>

<div id="req-fan" class="data-requirements hidden">
    <h4>Data Requirements:</h4>
    <ul>
        <li><strong>Column 1:</strong> Time periods (Year, Date, Month)</li>
        <li><strong>Column 2:</strong> Value (actual for historical, forecast for future)</li>
        <li><strong>Column 3:</strong> p75_low (75% confidence lower bound)</li>
        <li><strong>Column 4:</strong> p75_high (75% confidence upper bound)</li>
        <li><strong>Column 5 (optional):</strong> p95_low (95% confidence lower bound)</li>
        <li><strong>Column 6 (optional):</strong> p95_high (95% confidence upper bound)</li>
        <li><strong>Note:</strong> Leave confidence columns empty for actual data periods</li>
    </ul>
</div>

    <div id="req-violin" class="data-requirements hidden">
        <h4>Data Requirements:</h4>
        <ul>
            <li><strong>Column 1:</strong> Categories/Groups (e.g., "Country A", "Product Line", "Department")</li>
            <li><strong>Column 2:</strong> Continuous values (numbers for distribution analysis)</li>
        </ul>
    </div>
    
    <div id="req-sankey" class="data-requirements hidden">
        <h4>Data Requirements:</h4>
        <ul>
            <li><strong>Column 1:</strong> Source Category</li>
            <li><strong>Column 2:</strong> Destination Category</li>
            <li><strong>Column 3:</strong> Values (numbers)</li>
        </ul>
    </div>

    <div id="req-streamgraph" class="data-requirements hidden">
        <h4>Data Requirements:</h4>
        <ul>
            <li><strong>Column 1:</strong> Time/Date values (dates, Excel date serials, or time periods)</li>
            <li><strong>Column 2:</strong> Series/Categories (e.g., "Product Lines", "Industries", "Regions")</li>
            <li><strong>Column 3:</strong> Values (numbers for each series at each time point)</li>
        </ul>
    </div>

    <div id="req-ribbon" class="data-requirements hidden">
        <h4>Data Requirements:</h4>
        <ul>
            <li><strong>Column 1:</strong> Time periods (dates/periods)</li>
            <li><strong>Column 2:</strong> Categories (different series)</li>
            <li><strong>Column 3:</strong> Values (numbers)</li>
        </ul>
    </div>
    
    <div id="req-ridgeline" class="data-requirements hidden">
        <h4>Data Requirements:</h4>
        <ul>
            <li><strong>Column 1:</strong> Time periods/X-axis values</li>
            <li><strong>Column 2:</strong> Categories (creates separate ridges)</li>
            <li><strong>Column 3:</strong> Values (creates distribution shape)</li>
        </ul>
    </div>
    
    <div id="req-deviation" class="data-requirements hidden">
        <h4>Data Requirements:</h4>
        <ul>
            <li><strong>Column 1:</strong> Date/Period</li>
            <li><strong>Column 2:</strong> Actual values</li>
            <li><strong>Column 3:</strong> Target/Baseline values</li>
        </ul>
    </div>

    <div id="req-variance" class="data-requirements hidden">
        <h4>Data Requirements:</h4>
        <ul>
            <li><strong>Column 1:</strong> Business Unit/Category names (e.g., "Channel Partners", "Enterprise")</li>
            <li><strong>Column 2:</strong> First metric values (e.g., Actual, Sales, Results)</li>
            <li><strong>Column 3:</strong> Second metric values (e.g., Forecast, Budget, Target)</li>
        </ul>
    </div>

    <div id="req-waterfall" class="data-requirements hidden">
        <h4>Data Requirements:</h4>
        <ul>
            <li><strong>Column 1:</strong> Categories/Labels (e.g., "Begin", "Q1", "Q2", "End")</li>
            <li><strong>Column 2:</strong> Amount values (positive/negative numbers), 0 for total, except for beginning total</li>
            <li><strong>Column 3:</strong> Type (total or not)</li>
        </ul>
    </div>
    
    <div id="chart"></div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const dropdownHeader = document.getElementById('dropdownHeader');
            const dropdownList = document.getElementById('dropdownList');
            const dropdownArrow = dropdownHeader.querySelector('.dropdown-arrow');
            const selectedText = document.getElementById('selectedText');
            const allRequirements = document.querySelectorAll('.data-requirements');
            const hiddenSelect = document.getElementById('chartType');
            
            let isOpen = false;

            // Hide all requirements initially
            allRequirements.forEach(req => req.classList.add('hidden'));

            // Toggle dropdown open/close
            dropdownHeader.addEventListener('click', function() {
                isOpen = !isOpen;
                dropdownList.classList.toggle('open', isOpen);
                dropdownArrow.classList.toggle('expanded', isOpen);
            });

            // Close dropdown when clicking outside
            document.addEventListener('click', function(e) {
                if (!e.target.closest('.custom-dropdown')) {
                    isOpen = false;
                    dropdownList.classList.remove('open');
                    dropdownArrow.classList.remove('expanded');
                }
            });

            // Handle folder clicks
            document.querySelectorAll('.folder-item').forEach(folder => {
                folder.addEventListener('click', function(e) {
                    e.stopPropagation();
                    const folderName = this.dataset.folder;
                    const folderArrow = this.querySelector('.folder-arrow');
                    const charts = document.querySelectorAll(`[data-folder="${folderName}"].chart-item`);
                    
                    // Toggle folder expansion
                    const isExpanded = folderArrow.classList.contains('expanded');
                    folderArrow.classList.toggle('expanded', !isExpanded);
                    
                    charts.forEach(chart => {
                        chart.classList.toggle('visible', !isExpanded);
                    });
                });
            });

            // Handle chart selection
            document.querySelectorAll('.chart-item').forEach(item => {
                item.addEventListener('click', function() {
                    const chartType = this.dataset.chart;
                    const chartName = this.textContent;
                    
                    // Update selected text
                    selectedText.textContent = chartName;
                    
                    // Update hidden select for taskpane.js compatibility
                    hiddenSelect.value = chartType;
                    
                    // Close dropdown
                    isOpen = false;
                    dropdownList.classList.remove('open');
                    dropdownArrow.classList.remove('expanded');
                    
                    // Hide all expanded folders
                    document.querySelectorAll('.folder-arrow').forEach(arrow => {
                        arrow.classList.remove('expanded');
                    });
                    document.querySelectorAll('.chart-item').forEach(chart => {
                        chart.classList.remove('visible');
                    });
                    
                    // Show requirements
                    allRequirements.forEach(req => req.classList.add('hidden'));
                    const selectedReq = document.getElementById(`req-${chartType}`);
                    if (selectedReq) {
                        selectedReq.classList.remove('hidden');
                    }
                });
            });
        });
    </script>
</body>
</html>