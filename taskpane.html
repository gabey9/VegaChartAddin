<!doctype html><html><head><meta charset="UTF-8"/><meta http-equiv="X-UA-Compatible" content="IE=Edge"/><meta name="viewport" content="width=device-width,initial-scale=1"><title>Vega Chart</title><script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script><script src="https://cdn.jsdelivr.net/npm/vega@6"></script><script src="https://cdn.jsdelivr.net/npm/vega-lite@6"></script><script src="https://cdn.jsdelivr.net/npm/vega-embed@6"></script><script type="module" src="0bfc9a7492f15052e0c7.js"></script><style>body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,sans-serif;margin:20px;line-height:1.4}.chart-selector{margin-bottom:15px}label{display:block;margin-bottom:5px;font-weight:600;color:#323130}input[type=color],input[type=number],input[type=range],select{width:100%;padding:8px 12px;border:1px solid #8a8886;border-radius:4px;font-size:14px;box-sizing:border-box}input[type=color]{height:40px;padding:2px}input[type=range]{padding:0;margin:10px 0}input[type=number]{text-align:center;background-color:#fafafa}input[type=number]:focus{background-color:#fff;border-color:#0078d4;outline:0;box-shadow:0 0 0 1px #0078d4}button{background-color:#0078d4;color:#fff;border:none;padding:10px 20px;border-radius:4px;font-size:14px;cursor:pointer;width:100%;margin-bottom:15px}button:hover{background-color:#106ebe}.chart-settings,.data-requirements{background-color:#f8f9fa;border:1px solid #e1e4e8;border-radius:6px;padding:12px;margin-top:10px;font-size:13px}.chart-settings{background-color:#fff4e6;border-color:#fed7aa}.chart-settings h4,.data-requirements h4{margin:0 0 8px 0;color:#24292f;font-size:14px}.chart-settings h4{color:#ea580c}.data-requirements ul{margin:0;padding-left:18px}.data-requirements li{margin-bottom:4px}.setting-group{margin-bottom:15px}.setting-group label{font-weight:500;font-size:12px;margin-bottom:3px}.range-display{display:flex;justify-content:space-between;align-items:center;margin-top:5px;font-size:11px;color:#666}.color-group{display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-top:5px}.color-input-group{display:flex;flex-direction:column}.color-input-group label{font-size:11px;margin-bottom:2px}.dimension-inputs{display:grid;grid-template-columns:1fr 1fr;gap:15px;align-items:end}.dimension-input-group{display:flex;flex-direction:column}.dimension-input-group label{font-size:12px;margin-bottom:5px;font-weight:500}.input-with-unit{position:relative}.input-with-unit::after{content:'px';position:absolute;right:12px;top:50%;transform:translateY(-50%);color:#666;font-size:12px;pointer-events:none}.input-with-unit input{padding-right:30px}.hidden{display:none}</style><script defer="defer" src="polyfill.js"></script><script defer="defer" src="taskpane.js"></script></head><body><h2></h2><div class="chart-selector"><label for="chartType">Select Chart Type:</label> <select id="chartType"><option value="point">Scatter</option><option value="bar">Bar</option><option value="line">Line</option><option value="area">Area</option><option value="pie">Pie</option><option value="radial">Radial</option><option value="arc">Arc</option><option value="wordcloud">Wordcloud</option><option value="bullet">Bullet</option><option value="mekko">Mekko</option><option value="heatmap">Heatmap</option><option value="bump">Bump</option><option value="waffle">Waffle</option><option value="lollipop">Lollipop</option><option value="violin">Violin</option><option value="ribbon">Ribbon</option><option value="ridgeline">Ridgeline</option><option value="deviation">Deviation</option><option value="waterfall">Waterfall</option></select></div><button id="drawChart">Generate Chart</button><div id="req-point" class="data-requirements"><h4>Data Requirements:</h4><ul><li><strong>Column 1:</strong> X-axis values (numbers)</li><li><strong>Column 2:</strong> Y-axis values (numbers)</li></ul></div><div id="req-bar" class="data-requirements hidden"><h4>Data Requirements:</h4><ul><li><strong>Column 1:</strong> Categories or X-axis values</li><li><strong>Column 2:</strong> Values (numbers)</li></ul></div><div id="req-line" class="data-requirements hidden"><h4>Data Requirements:</h4><ul><li><strong>Column 1:</strong> X-axis values (often dates/time)</li><li><strong>Column 2:</strong> Y-axis values (numbers)</li></ul></div><div id="req-area" class="data-requirements hidden"><h4>Data Requirements:</h4><ul><li><strong>Column 1:</strong> X-axis values (often dates/time)</li><li><strong>Column 2:</strong> Y-axis values (numbers)</li></ul></div><div id="req-pie" class="data-requirements hidden"><h4>Data Requirements:</h4><ul><li><strong>Column 1:</strong> Category names (e.g., "Product A", "Product B")</li><li><strong>Column 2:</strong> Values (numbers for slice sizes)</li></ul></div><div id="req-radial" class="data-requirements hidden"><h4>Data Requirements:</h4><ul><li><strong>Column 1:</strong> Category names</li><li><strong>Column 2:</strong> Values (determines both angle and radius)</li></ul></div><div id="req-arc" class="data-requirements hidden"><h4>Data Requirements:</h4><ul><li><strong>Column 1:</strong> Source node/entity (e.g., "Person A", "Department 1")</li><li><strong>Column 2:</strong> Target node/entity (e.g., "Person B", "Department 2")</li><li><strong>Column 3:</strong> Connection strength/weight (numbers, optional)</li><li><strong>Column 4:</strong> Group/Category (optional, for coloring nodes)</li></ul></div><div id="req-wordcloud" class="data-requirements hidden"><h4>Data Requirements:</h4><ul><li><strong>Column 1:</strong> Text data (sentences, phrases, or words)</li></ul></div><div id="req-lollipop" class="data-requirements hidden"><h4>Data Requirements:</h4><ul><li><strong>Column 1:</strong> Category names (e.g., "Products", "Regions", "Teams")</li><li><strong>Column 2:</strong> Values (numbers for stick length and circle size)</li></ul></div><div id="req-waffle" class="data-requirements hidden"><h4>Data Requirements:</h4><ul><li><strong>Column 1:</strong> Category names (e.g., "Product A", "Product B")</li><li><strong>Column 2:</strong> Values (numbers that will be converted to percentages)</li></ul></div><div id="req-bullet" class="data-requirements hidden"><h4>Data Requirements:</h4><ul><li><strong>Column 1:</strong> Title/Metric name (e.g., "Revenue", "Profit")</li><li><strong>Column 2:</strong> Poor range max</li><li><strong>Column 3:</strong> Satisfactory range max</li><li><strong>Column 4:</strong> Good range max</li><li><strong>Column 5:</strong> Actual value</li><li><strong>Column 6:</strong> Forecast value (optional)</li><li><strong>Column 7:</strong> Target value (marker)</li></ul></div><div id="req-mekko" class="data-requirements hidden"><h4>Data Requirements:</h4><ul><li><strong>Column 1:</strong> Primary categories (e.g., "Continent", "Region")</li><li><strong>Column 2:</strong> Sub-categories (e.g., "Country", "Product")</li><li><strong>Column 3:</strong> Values (numbers for sizing)</li></ul></div><div id="req-heatmap" class="data-requirements hidden"><h4>Data Requirements:</h4><ul><li><strong>Column 1:</strong> Y-axis categories (e.g., "Months", "Products", "Regions")</li><li><strong>Column 2:</strong> X-axis categories (e.g., "Days", "Quarters", "Sales Reps")</li><li><strong>Column 3:</strong> Values (numbers for color intensity)</li></ul></div><div id="req-bump" class="data-requirements hidden"><h4>Data Requirements:</h4><ul><li><strong>Column 1:</strong> Time periods</li><li><strong>Column 2:</strong> Categories (e.g., "Team A", "Team B")</li><li><strong>Column 3:</strong> Rank values (1, 2, 3, etc.)</li></ul></div><div id="req-violin" class="data-requirements hidden"><h4>Data Requirements:</h4><ul><li><strong>Column 1:</strong> Categories/Groups (e.g., "Country A", "Product Line", "Department")</li><li><strong>Column 2:</strong> Continuous values (numbers for distribution analysis)</li></ul></div><div id="req-ribbon" class="data-requirements hidden"><h4>Data Requirements:</h4><ul><li><strong>Column 1:</strong> Time periods (dates/periods)</li><li><strong>Column 2:</strong> Categories (different series)</li><li><strong>Column 3:</strong> Values (numbers)</li></ul></div><div id="req-ridgeline" class="data-requirements hidden"><h4>Data Requirements:</h4><ul><li><strong>Column 1:</strong> Time periods/X-axis values</li><li><strong>Column 2:</strong> Categories (creates separate ridges)</li><li><strong>Column 3:</strong> Values (creates distribution shape)</li></ul></div><div id="req-deviation" class="data-requirements hidden"><h4>Data Requirements:</h4><ul><li><strong>Column 1:</strong> Date/Period</li><li><strong>Column 2:</strong> Actual values</li><li><strong>Column 3:</strong> Target/Baseline values</li></ul></div><div id="req-waterfall" class="data-requirements hidden"><h4>Data Requirements:</h4><ul><li><strong>Column 1:</strong> Categories/Labels (e.g., "Begin", "Q1", "Q2", "End")</li><li><strong>Column 2:</strong> Amount values (positive/negative numbers)</li></ul></div><div class="chart-settings"><h4>Chart Settings:</h4><div class="setting-group"><label>Chart Dimensions:</label><div class="dimension-inputs"><div class="dimension-input-group"><label for="chartWidth">Width:</label><div class="input-with-unit"><input type="number" id="chartWidth" min="300" max="1200" value="600" step="10"></div></div><div class="dimension-input-group"><label for="chartHeight">Height:</label><div class="input-with-unit"><input type="number" id="chartHeight" min="200" max="800" value="400" step="10"></div></div></div></div><div id="settings-waterfall" class="setting-group hidden"><label>Waterfall Colors:</label><div class="color-group"><div class="color-input-group"><label for="waterfallPositive">Positive:</label> <input type="color" id="waterfallPositive" value="#93c4aa"></div><div class="color-input-group"><label for="waterfallNegative">Negative:</label> <input type="color" id="waterfallNegative" value="#f78a64"></div><div class="color-input-group"><label for="waterfallTotal">Total:</label> <input type="color" id="waterfallTotal" value="#f7e0b6"></div><div class="color-input-group"><label for="waterfallConnector">Connector:</label> <input type="color" id="waterfallConnector" value="#404040"></div></div></div><div id="settings-bar" class="setting-group hidden"><label for="barColor">Bar Color:</label> <input type="color" id="barColor" value="#0078d4"></div><div id="settings-line" class="setting-group hidden"><label for="lineColor">Line Color:</label> <input type="color" id="lineColor" value="#0078d4"> <label for="lineWidth">Line Width (px):</label> <input type="range" id="lineWidth" min="1" max="10" value="3"><div class="range-display"><span>1px</span> <span id="lineWidthValue">3px</span> <span>10px</span></div></div><div id="settings-point" class="setting-group hidden"><label for="pointColor">Point Color:</label> <input type="color" id="pointColor" value="#0078d4"> <label for="pointSize">Point Size:</label> <input type="range" id="pointSize" min="50" max="500" value="100"><div class="range-display"><span>50</span> <span id="pointSizeValue">100</span> <span>500</span></div></div><div id="settings-pie" class="setting-group hidden"><label for="pieRadius">Outer Radius (px):</label> <input type="range" id="pieRadius" min="80" max="200" value="120"><div class="range-display"><span>80px</span> <span id="pieRadiusValue">120px</span> <span>200px</span></div></div></div><div id="chart"></div><script>function updateRangeDisplay(e,t,n=""){const i=document.getElementById(e),a=document.getElementById(t);i&&a&&i.addEventListener("input",function(){a.textContent=this.value+n})}function validateDimensionInput(e,t,n){let i=parseInt(e.value);isNaN(i)||i<t?e.value=t:i>n&&(e.value=n)}function addArrowKeySupport(e,t=10){e.addEventListener("keydown",function(e){"ArrowUp"===e.key?(e.preventDefault(),this.value=parseInt(this.value||0)+t,validateDimensionInput(this,parseInt(this.min),parseInt(this.max))):"ArrowDown"===e.key&&(e.preventDefault(),this.value=parseInt(this.value||0)-t,validateDimensionInput(this,parseInt(this.min),parseInt(this.max)))})}document.getElementById("chartType").addEventListener("change",function(){const e=this.value,t=document.querySelectorAll(".data-requirements"),n=document.querySelectorAll('[id^="settings-"]');t.forEach(e=>e.classList.add("hidden")),n.forEach(e=>e.classList.add("hidden"));const i=document.getElementById(`req-${e}`);i&&i.classList.remove("hidden");const a=document.getElementById(`settings-${e}`);a&&a.classList.remove("hidden")}),document.getElementById("chartWidth").addEventListener("blur",function(){validateDimensionInput(this,300,1200)}),document.getElementById("chartHeight").addEventListener("blur",function(){validateDimensionInput(this,200,800)}),addArrowKeySupport(document.getElementById("chartWidth")),addArrowKeySupport(document.getElementById("chartHeight")),updateRangeDisplay("lineWidth","lineWidthValue","px"),updateRangeDisplay("pointSize","pointSizeValue"),updateRangeDisplay("pieRadius","pieRadiusValue","px"),document.addEventListener("DOMContentLoaded",function(){document.getElementById("chartType").dispatchEvent(new Event("change"))})</script></body></html>