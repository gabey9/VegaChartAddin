<!doctype html><html><head><meta charset="UTF-8"/><meta http-equiv="X-UA-Compatible" content="IE=Edge"/><meta name="viewport" content="width=device-width,initial-scale=1"><title>Vega Chart</title><script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script><script src="https://cdn.jsdelivr.net/npm/vega@6"></script><script src="https://cdn.jsdelivr.net/npm/vega-lite@6"></script><script src="https://cdn.jsdelivr.net/npm/vega-embed@6"></script><script type="module" src="48d6e01139dde7a1c23e.js"></script><style>body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,sans-serif;margin:20px;line-height:1.4}.chart-selector{margin-bottom:15px}label{display:block;margin-bottom:5px;font-weight:600;color:#323130}select{width:100%;padding:8px 12px;border:1px solid #8a8886;border-radius:4px;font-size:14px}button{background-color:#0078d4;color:#fff;border:none;padding:10px 20px;border-radius:4px;font-size:14px;cursor:pointer;width:100%;margin-bottom:15px}button:hover{background-color:#106ebe}.data-requirements{background-color:#f8f9fa;border:1px solid #e1e4e8;border-radius:6px;padding:12px;margin-top:10px;font-size:13px}.data-requirements h4{margin:0 0 8px 0;color:#24292f;font-size:14px}.data-requirements ul{margin:0;padding-left:18px}.data-requirements li{margin-bottom:4px}.chart-settings{margin-top:20px;padding:15px;background-color:#f3f2f1;border-left:3px solid #f48fb1;border-radius:2px}.chart-settings h4{margin:0 0 12px 0;color:#323130;font-size:14px;font-weight:600}.setting-group{margin-bottom:15px}.setting-label{display:block;font-weight:600;margin-bottom:6px;color:#323130;font-size:13px}.color-input-row{display:flex;align-items:center;gap:8px;margin-bottom:8px}.color-preview{width:24px;height:24px;border-radius:4px;border:2px solid #e1e1e1;cursor:pointer;transition:all .2s ease;position:relative;overflow:hidden}.color-preview:hover{border-color:#0078d4;transform:scale(1.05)}.color-input{opacity:0;position:absolute;width:100%;height:100%;cursor:pointer}.color-label{flex:1;font-size:12px;color:#605e5c}.hex-display{font-family:'Courier New',monospace;font-size:10px;color:#8a8886;background:#fff;padding:2px 4px;border-radius:2px;min-width:55px;text-align:center;border:1px solid #e1e1e1}.hidden{display:none}</style><script defer="defer" src="polyfill.js"></script><script defer="defer" src="taskpane.js"></script></head><body><h2></h2><div class="chart-selector"><label for="chartType">Select Chart Type:</label> <select id="chartType"><option value="point">Scatter</option><option value="bar">Bar</option><option value="line">Line</option><option value="area">Area</option><option value="pie">Pie</option><option value="radial">Radial</option><option value="arc">Arc</option><option value="wordcloud">Wordcloud</option><option value="strip">Strip</option><option value="treemap">Treemap</option><option value="bullet">Bullet</option><option value="mekko">Mekko</option><option value="heatmap">Heatmap</option><option value="bump">Bump</option><option value="waffle">Waffle</option><option value="lollipop">Lollipop</option><option value="violin">Violin</option><option value="ribbon">Ribbon</option><option value="ridgeline">Ridgeline</option><option value="deviation">Deviation</option><option value="waterfall">Waterfall</option></select></div><button id="drawChart">Generate Chart</button><div id="req-point" class="data-requirements"><h4>Data Requirements:</h4><ul><li><strong>Column 1:</strong> X-axis values (numbers)</li><li><strong>Column 2:</strong> Y-axis values (numbers)</li><li><strong>Column 3 (optional):</strong> Color grouping (categories for different colors)</li><li><strong>Column 4 (optional):</strong> Shape grouping (categories for different shapes)</li></ul></div><div id="req-bar" class="data-requirements hidden"><h4>Data Requirements:</h4><ul><li><strong>Column 1:</strong> Categories or X-axis values</li><li><strong>Column 2:</strong> Values (numbers)</li><li><strong>Column 3 (optional):</strong> Grouping variable for grouped bars</li></ul></div><div id="req-line" class="data-requirements hidden"><h4>Data Requirements:</h4><ul><li><strong>Column 1:</strong> X-axis values (often dates/time or categories)</li><li><strong>Column 2:</strong> Y-axis values (numbers)</li><li><strong>Column 3 (optional):</strong> Series grouping for multiple lines</li></ul></div><div id="req-area" class="data-requirements hidden"><h4>Data Requirements:</h4><ul><li><strong>Column 1:</strong> X-axis values (often dates/time)</li><li><strong>Column 2:</strong> Y-axis values (numbers)</li><li><strong>Column 3 (optional):</strong> Series grouping for multiple areas</li></ul></div><div id="req-pie" class="data-requirements hidden"><h4>Data Requirements:</h4><ul><li><strong>Column 1:</strong> Category names (e.g., "Product A", "Product B")</li><li><strong>Column 2:</strong> Values (numbers for slice sizes)</li></ul></div><div id="req-radial" class="data-requirements hidden"><h4>Data Requirements:</h4><ul><li><strong>Column 1:</strong> Category names</li><li><strong>Column 2:</strong> Values (determines both angle and radius)</li></ul></div><div id="req-arc" class="data-requirements hidden"><h4>Data Requirements:</h4><ul><li><strong>Column 1:</strong> Source node/entity (e.g., "Person A", "Department 1")</li><li><strong>Column 2:</strong> Target node/entity (e.g., "Person B", "Department 2")</li><li><strong>Column 3:</strong> Connection strength/weight (numbers, optional)</li><li><strong>Column 4:</strong> Group/Category (optional, for coloring nodes)</li></ul></div><div id="req-strip" class="data-requirements hidden"><h4>Data Requirements:</h4><ul><li><strong>Column A:</strong> Quantitative values (e.g., Horsepower, Sales, Temperature)</li><li><strong>Column B:</strong> Categories/Groups (e.g., Cylinders, Department, Grade)</li><li><strong>Column C (optional):</strong> Color grouping (e.g., Brand, Region, Type)</li></ul></div><div id="req-treemap" class="data-requirements hidden"><h4>Data Requirements:</h4><ul><li><strong>Column A:</strong> Category/Item names (e.g., Product, Department, File)</li><li><strong>Column B:</strong> Values/Sizes (e.g., Sales, Budget, File Size)</li><li><strong>Column C (optional):</strong> Parent/Group hierarchy (e.g., Region, Division)</li></ul></div><div id="req-wordcloud" class="data-requirements hidden"><h4>Data Requirements:</h4><ul><li><strong>Column 1:</strong> Text data (sentences, phrases, or words)</li></ul></div><div id="req-lollipop" class="data-requirements hidden"><h4>Data Requirements:</h4><ul><li><strong>Column 1:</strong> Category names (e.g., "Products", "Regions", "Teams")</li><li><strong>Column 2:</strong> Values (numbers for stick length and circle size)</li></ul></div><div id="req-waffle" class="data-requirements hidden"><h4>Data Requirements:</h4><ul><li><strong>Column 1:</strong> Category names (e.g., "Product A", "Product B")</li><li><strong>Column 2:</strong> Values (numbers that will be converted to percentages)</li></ul></div><div id="req-bullet" class="data-requirements hidden"><h4>Data Requirements:</h4><ul><li><strong>Column 1:</strong> Title/Metric name (e.g., "Revenue", "Profit")</li><li><strong>Column 2:</strong> Poor range max</li><li><strong>Column 3:</strong> Satisfactory range max</li><li><strong>Column 4:</strong> Good range max</li><li><strong>Column 5:</strong> Actual value</li><li><strong>Column 6:</strong> Forecast value (optional)</li><li><strong>Column 7:</strong> Target value (marker)</li></ul></div><div id="req-mekko" class="data-requirements hidden"><h4>Data Requirements:</h4><ul><li><strong>Column 1:</strong> Primary categories (e.g., "Continent", "Region")</li><li><strong>Column 2:</strong> Sub-categories (e.g., "Country", "Product")</li><li><strong>Column 3:</strong> Values (numbers for sizing)</li></ul></div><div id="req-heatmap" class="data-requirements hidden"><h4>Data Requirements:</h4><ul><li><strong>Column 1:</strong> Y-axis categories (e.g., "Months", "Products", "Regions")</li><li><strong>Column 2:</strong> X-axis categories (e.g., "Days", "Quarters", "Sales Reps")</li><li><strong>Column 3:</strong> Values (numbers for color intensity)</li></ul></div><div id="req-bump" class="data-requirements hidden"><h4>Data Requirements:</h4><ul><li><strong>Column 1:</strong> Time periods</li><li><strong>Column 2:</strong> Categories (e.g., "Team A", "Team B")</li><li><strong>Column 3:</strong> Rank values (1, 2, 3, etc.)</li></ul></div><div id="req-violin" class="data-requirements hidden"><h4>Data Requirements:</h4><ul><li><strong>Column 1:</strong> Categories/Groups (e.g., "Country A", "Product Line", "Department")</li><li><strong>Column 2:</strong> Continuous values (numbers for distribution analysis)</li></ul></div><div id="req-ribbon" class="data-requirements hidden"><h4>Data Requirements:</h4><ul><li><strong>Column 1:</strong> Time periods (dates/periods)</li><li><strong>Column 2:</strong> Categories (different series)</li><li><strong>Column 3:</strong> Values (numbers)</li></ul></div><div id="req-ridgeline" class="data-requirements hidden"><h4>Data Requirements:</h4><ul><li><strong>Column 1:</strong> Time periods/X-axis values</li><li><strong>Column 2:</strong> Categories (creates separate ridges)</li><li><strong>Column 3:</strong> Values (creates distribution shape)</li></ul></div><div id="req-deviation" class="data-requirements hidden"><h4>Data Requirements:</h4><ul><li><strong>Column 1:</strong> Date/Period</li><li><strong>Column 2:</strong> Actual values</li><li><strong>Column 3:</strong> Target/Baseline values</li></ul></div><div id="req-waterfall" class="data-requirements hidden"><h4>Data Requirements:</h4><ul><li><strong>Column 1:</strong> Categories/Labels (e.g., "Begin", "Q1", "Q2", "End")</li><li><strong>Column 2:</strong> Amount values (positive/negative numbers)</li></ul></div><div class="chart-settings hidden" id="chartSettings"><h4>Chart Settings</h4><div class="setting-group"><label class="setting-label">Waterfall Colors</label><div class="color-input-row"><div class="color-preview" style="background-color:#70ad47"><input type="color" class="color-input" id="positiveColor" value="#70AD47"></div><span class="color-label">Positive Values</span> <span class="hex-display" id="positiveHex">#70AD47</span></div><div class="color-input-row"><div class="color-preview" style="background-color:#e15759"><input type="color" class="color-input" id="negativeColor" value="#E15759"></div><span class="color-label">Negative Values</span> <span class="hex-display" id="negativeHex">#E15759</span></div><div class="color-input-row"><div class="color-preview" style="background-color:#4472c4"><input type="color" class="color-input" id="totalColor" value="#4472C4"></div><span class="color-label">Total/Subtotal</span> <span class="hex-display" id="totalHex">#4472C4</span></div><div class="color-input-row"><div class="color-preview" style="background-color:#ffc000"><input type="color" class="color-input" id="connectorColor" value="#FFC000"></div><span class="color-label">Connectors</span> <span class="hex-display" id="connectorHex">#FFC000</span></div></div></div><div id="chart"></div><script>document.getElementById("chartType").addEventListener("change",function(){const e=this.value;document.querySelectorAll(".data-requirements").forEach(e=>e.classList.add("hidden"));const t=document.getElementById(`req-${e}`);t&&t.classList.remove("hidden")}),document.addEventListener("DOMContentLoaded",function(){document.getElementById("chartType").dispatchEvent(new Event("change"))});const colorInputs=["positiveColor","negativeColor","totalColor","connectorColor"];colorInputs.forEach(e=>{const t=document.getElementById(e),n=document.getElementById(e.replace("Color","Hex")),o=t.parentElement;t.addEventListener("input",function(){const e=this.value.toUpperCase();n.textContent=e,o.style.backgroundColor=e})}),document.getElementById("chartType").addEventListener("change",function(){const e=this.value,t=document.getElementById("chartSettings");"waterfall"===e?t.classList.remove("hidden"):t.classList.add("hidden")}),document.addEventListener("DOMContentLoaded",function(){document.getElementById("chartType").dispatchEvent(new Event("change"))})</script></body></html>