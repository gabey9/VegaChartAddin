/*! For license information please see taskpane.js.LICENSE.txt */
!function(){"use strict";var t={60947:function(t,e,n){t.exports=n.p+"73aa4c1c46e330a2f4e2.js"}},e={};function n(r){var o=e[r];if(void 0!==o)return o.exports;var a=e[r]={exports:{}};return t[r](a,a.exports,n),a.exports}n.m=t,n.d=function(t,e){for(var r in e)n.o(e,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},function(){var t;n.g.importScripts&&(t=n.g.location+"");var e=n.g.document;if(!t&&e&&(e.currentScript&&"SCRIPT"===e.currentScript.tagName.toUpperCase()&&(t=e.currentScript.src),!t)){var r=e.getElementsByTagName("script");if(r.length)for(var o=r.length-1;o>-1&&(!t||!/^http(s?):/.test(t));)t=r[o--].src}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=t}(),n.b=document.baseURI||self.location.href,function(){function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(){var t,r,o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",c=o.toStringTag||"@@toStringTag";function i(e,o,a,c){var i=o&&o.prototype instanceof l?o:l,s=Object.create(i.prototype);return n(s,"_invoke",function(e,n,o){var a,c,i,l=0,s=o||[],f=!1,p={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(e,n){return a=e,c=0,i=t,p.n=n,u}};function d(e,n){for(c=e,i=n,r=0;!f&&l&&!o&&r<s.length;r++){var o,a=s[r],d=p.p,m=a[2];e>3?(o=m===n)&&(i=a[(c=a[4])?5:(c=3,3)],a[4]=a[5]=t):a[0]<=d&&((o=e<2&&d<a[1])?(c=0,p.v=n,p.n=a[1]):d<m&&(o=e<3||a[0]>n||n>m)&&(a[4]=e,a[5]=n,p.n=m,c=0))}if(o||e>1)return u;throw f=!0,n}return function(o,s,m){if(l>1)throw TypeError("Generator is already running");for(f&&1===s&&d(s,m),c=s,i=m;(r=c<2?t:i)||!f;){a||(c?c<3?(c>1&&(p.n=-1),d(c,i)):p.n=i:p.v=i);try{if(l=2,a){if(c||(o="next"),r=a[o]){if(!(r=r.call(a,i)))throw TypeError("iterator result is not an object");if(!r.done)return r;i=r.value,c<2&&(c=0)}else 1===c&&(r=a.return)&&r.call(a),c<2&&(i=TypeError("The iterator does not provide a '"+o+"' method"),c=1);a=t}else if((r=(f=p.n<0)?i:e.call(n,p))!==u)break}catch(e){a=t,c=1,i=e}finally{l=1}}return{value:r,done:f}}}(e,a,c),!0),s}var u={};function l(){}function s(){}function f(){}r=Object.getPrototypeOf;var p=[][a]?r(r([][a]())):(n(r={},a,function(){return this}),r),d=f.prototype=l.prototype=Object.create(p);function m(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,f):(t.__proto__=f,n(t,c,"GeneratorFunction")),t.prototype=Object.create(d),t}return s.prototype=f,n(d,"constructor",f),n(f,"constructor",s),s.displayName="GeneratorFunction",n(f,c,"GeneratorFunction"),n(d),n(d,c,"Generator"),n(d,a,function(){return this}),n(d,"toString",function(){return"[object Generator]"}),(e=function(){return{w:i,m:m}})()}function n(t,e,r,o){var a=Object.defineProperty;try{a({},"",{})}catch(t){a=0}n=function(t,e,r,o){function c(e,r){n(t,e,function(t){return this._invoke(e,r,t)})}e?a?a(t,e,{value:r,enumerable:!o,configurable:!o,writable:!o}):t[e]=r:(c("next",0),c("throw",1),c("return",2))},n(t,e,r,o)}function r(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function o(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?r(Object(n),!0).forEach(function(e){a(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function a(e,n,r){return(n=function(e){var n=function(e){if("object"!=t(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=t(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==t(n)?n:n+""}(n))in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}function c(t){return function(t){if(Array.isArray(t))return i(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return i(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function u(t,e,n,r,o,a,c){try{var i=t[a](c),u=i.value}catch(t){return void n(t)}i.done?e(u):Promise.resolve(u).then(r,o)}function l(t){return function(){var e=this,n=arguments;return new Promise(function(r,o){var a=t.apply(e,n);function c(t){u(a,r,o,c,i,"next",t)}function i(t){u(a,r,o,c,i,"throw",t)}c(void 0)})}}function s(){return f.apply(this,arguments)}function f(){return f=l(e().m(function t(){var n;return e().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,t.n=1,Excel.run(function(){var t=l(e().m(function t(n){var r,o,a,c,i,u,s,f,d,m,y,v,h,b,g;return e().w(function(t){for(;;)switch(t.n){case 0:return r=n.workbook.worksheets.getActiveWorksheet(),(o=n.workbook.getSelectedRange()).load("values, left, top"),t.n=1,n.sync();case 1:if(!((a=o.values).length<2)){t.n=2;break}return console.warn("Need at least header row + one data row"),t.a(2);case 2:return c=a[0],i=a.slice(1),u=i.map(function(t){var e={};return c.forEach(function(n,r){e[n]=t[r]}),e}),s=document.getElementById("chartType").value,f="waterfall"===s?p(u,c):"pie"===s?{$schema:"https://vega.github.io/schema/vega-lite/v6.json",description:"Pie chart from Excel selection",data:{values:u},mark:{type:"arc",outerRadius:120},encoding:{theta:{field:c[1],type:"quantitative"},color:{field:c[0],type:"nominal"},tooltip:[{field:c[0],type:"nominal"},{field:c[1],type:"quantitative"}]},view:{stroke:null}}:{$schema:"https://vega.github.io/schema/vega-lite/v6.json",description:"Chart from Excel selection",data:{values:u},mark:s,encoding:{x:{field:c[0],type:"quantitative"},y:{field:c[1],type:"quantitative"}}},(d=document.createElement("div")).style.display="none",document.body.appendChild(d),t.n=3,vegaEmbed(d,f,{actions:!1});case 3:return m=t.v,y=m.view,t.n=4,y.toImageURL("png");case 4:return v=t.v,t.n=5,fetch(v);case 5:return h=t.v,t.n=6,h.blob();case 6:b=t.v,(g=new FileReader).onloadend=l(e().m(function t(){var a,c;return e().w(function(t){for(;;)switch(t.n){case 0:return a=g.result.split(",")[1],(c=r.shapes.addImage(a)).left=o.left,c.top=o.top,c.lockAspectRatio=!0,t.n=1,n.sync();case 1:return t.a(2)}},t)})),g.readAsDataURL(b),document.body.removeChild(d);case 7:return t.a(2)}},t)}));return function(e){return t.apply(this,arguments)}}());case 1:t.n=3;break;case 2:t.p=2,n=t.v,console.error(n);case 3:return t.a(2)}},t,null,[[0,2]])})),f.apply(this,arguments)}function p(t,e){var n=e[0],r=e[1],i=t.length,u=Math.max(400,Math.min(1200,70*i)),l=Math.max.apply(Math,c(t.map(function(t){return Math.abs(t[r])}))),s=Math.max(300,Math.min(600,l/100+200)),f=function(t,e,n){var r=c(t);return r.length>0&&(r[r.length-1]=o(o({},r[r.length-1]),{},a({},n,0))),r}(t,0,r);return{$schema:"https://vega.github.io/schema/vega-lite/v6.json",description:"Waterfall chart from Excel selection",data:{values:f},width:u,height:s,transform:[{window:[{op:"sum",field:r,as:"sum"}]},{window:[{op:"lead",field:n,as:"lead"}]},{calculate:"datum.lead === null ? datum.".concat(n," : datum.lead"),as:"lead"},{calculate:"datum.".concat(n," === '").concat(t[t.length-1][n],"' ? 0 : datum.sum - datum.").concat(r),as:"previous_sum"},{calculate:"datum.".concat(n," === '").concat(t[t.length-1][n],"' ? datum.sum : datum.").concat(r),as:"amount"},{calculate:"datum.".concat(n," === '").concat(t[0][n],"' ? datum.").concat(r," / 2 : datum.").concat(n," === '").concat(t[t.length-1][n],"' ? datum.").concat(r," / 2 : (datum.sum + datum.previous_sum) / 2"),as:"center"},{calculate:"datum.".concat(n," === '").concat(t[t.length-1][n],"' ? datum.sum : (datum.").concat(n," !== '").concat(t[0][n],"' && datum.").concat(n," !== '").concat(t[t.length-1][n],"' && datum.").concat(r," > 0 ? '+' : '') + datum.").concat(r),as:"text_amount"},{calculate:"(datum.sum + datum.previous_sum) / 2",as:"center"}],encoding:{x:{field:n,type:"ordinal",sort:null,axis:{labelAngle:0,title:e[0]},scale:{paddingInner:.1,paddingOuter:.05}}},layer:[{mark:{type:"bar",size:60},encoding:{y:{field:"previous_sum",type:"quantitative",title:e[1]},y2:{field:"sum"},color:{condition:[{test:"datum.".concat(n," === '").concat(t[0][n],"' || datum.").concat(n," === '").concat(t[t.length-1][n],"'"),value:"#f7e0b6"},{test:"datum.sum < datum.previous_sum",value:"#f78a64"}],value:"#93c4aa"}}},{mark:{type:"rule",color:"#404040",opacity:1,strokeWidth:2,xOffset:-30,x2Offset:30},encoding:{x2:{field:"lead"},y:{field:"sum",type:"quantitative"}}},{mark:{type:"text",dy:{expr:"datum.amount >= 0 ? -4 : 4"},baseline:{expr:"datum.amount >= 0 ? 'bottom' : 'top'"}},encoding:{y:{field:"sum",type:"quantitative"},text:{field:"sum",type:"nominal"},opacity:{condition:{test:"datum.".concat(n," === '").concat(t[0][n],"' || datum.").concat(n," === '").concat(t[t.length-1][n],"'"),value:0},value:1}}},{mark:{type:"text",fontWeight:"bold",baseline:"middle"},encoding:{y:{field:"center",type:"quantitative"},text:{field:"text_amount",type:"nominal"},color:{condition:[{test:"datum.".concat(n," === '").concat(t[0][n],"' || datum.").concat(n," === '").concat(t[t.length-1][n],"'"),value:"#725a30"}],value:"white"}}}],config:{text:{fontWeight:"bold",color:"#404040"}}}}Office.onReady(function(){document.getElementById("drawChart").onclick=s})}(),new URL(n(60947),n.b)}();
//# sourceMappingURL=taskpane.js.map