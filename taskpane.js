/*! For license information please see taskpane.js.LICENSE.txt */
!function(){"use strict";var e={60947:function(e,t,a){e.exports=a.p+"82ae40f5008306e02d08.js"}},t={};function a(n){var i=t[n];if(void 0!==i)return i.exports;var l=t[n]={exports:{}};return e[n](l,l.exports,a),l.exports}a.m=e,a.d=function(e,t){for(var n in t)a.o(t,n)&&!a.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},a.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){var e;a.g.importScripts&&(e=a.g.location+"");var t=a.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var n=t.getElementsByTagName("script");if(n.length)for(var i=n.length-1;i>-1&&(!e||!/^http(s?):/.test(e));)e=n[i--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),a.p=e}(),a.b=document.baseURI||self.location.href,function(){function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(){var e,n,i="function"==typeof Symbol?Symbol:{},l=i.iterator||"@@iterator",o=i.toStringTag||"@@toStringTag";function r(t,i,l,o){var r=i&&i.prototype instanceof c?i:c,d=Object.create(r.prototype);return a(d,"_invoke",function(t,a,i){var l,o,r,c=0,d=i||[],u=!1,f={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(t,a){return l=t,o=0,r=e,f.n=a,s}};function p(t,a){for(o=t,r=a,n=0;!u&&c&&!i&&n<d.length;n++){var i,l=d[n],p=f.p,g=l[2];t>3?(i=g===a)&&(r=l[(o=l[4])?5:(o=3,3)],l[4]=l[5]=e):l[0]<=p&&((i=t<2&&p<l[1])?(o=0,f.v=a,f.n=l[1]):p<g&&(i=t<3||l[0]>a||a>g)&&(l[4]=t,l[5]=a,f.n=g,o=0))}if(i||t>1)return s;throw u=!0,a}return function(i,d,g){if(c>1)throw TypeError("Generator is already running");for(u&&1===d&&p(d,g),o=d,r=g;(n=o<2?e:r)||!u;){l||(o?o<3?(o>1&&(f.n=-1),p(o,r)):f.n=r:f.v=r);try{if(c=2,l){if(o||(i="next"),n=l[i]){if(!(n=n.call(l,r)))throw TypeError("iterator result is not an object");if(!n.done)return n;r=n.value,o<2&&(o=0)}else 1===o&&(n=l.return)&&n.call(l),o<2&&(r=TypeError("The iterator does not provide a '"+i+"' method"),o=1);l=e}else if((n=(u=f.n<0)?r:t.call(a,f))!==s)break}catch(t){l=e,o=1,r=t}finally{c=1}}return{value:n,done:u}}}(t,l,o),!0),d}var s={};function c(){}function d(){}function u(){}n=Object.getPrototypeOf;var f=[][l]?n(n([][l]())):(a(n={},l,function(){return this}),n),p=u.prototype=c.prototype=Object.create(f);function g(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,u):(e.__proto__=u,a(e,o,"GeneratorFunction")),e.prototype=Object.create(p),e}return d.prototype=u,a(p,"constructor",u),a(u,"constructor",d),d.displayName="GeneratorFunction",a(u,o,"GeneratorFunction"),a(p),a(p,o,"Generator"),a(p,l,function(){return this}),a(p,"toString",function(){return"[object Generator]"}),(t=function(){return{w:r,m:g}})()}function a(e,t,n,i){var l=Object.defineProperty;try{l({},"",{})}catch(e){l=0}a=function(e,t,n,i){function o(t,n){a(e,t,function(e){return this._invoke(t,n,e)})}t?l?l(e,t,{value:n,enumerable:!i,configurable:!i,writable:!i}):e[t]=n:(o("next",0),o("throw",1),o("return",2))},a(e,t,n,i)}function n(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=a){var n,i,l,o,r=[],s=!0,c=!1;try{if(l=(a=a.call(e)).next,0===t){if(Object(a)!==a)return;s=!1}else for(;!(s=(n=l.call(a)).done)&&(r.push(n.value),r.length!==t);s=!0);}catch(e){c=!0,i=e}finally{try{if(!s&&null!=a.return&&(o=a.return(),Object(o)!==o))return}finally{if(c)throw i}}return r}}(e,t)||o(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,t){var a="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!a){if(Array.isArray(e)||(a=o(e))||t&&e&&"number"==typeof e.length){a&&(e=a);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,r=!0,s=!1;return{s:function(){a=a.call(e)},n:function(){var e=a.next();return r=e.done,e},e:function(e){s=!0,l=e},f:function(){try{r||null==a.return||a.return()}finally{if(s)throw l}}}}function l(e){return function(e){if(Array.isArray(e))return r(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||o(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){if(e){if("string"==typeof e)return r(e,t);var a={}.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?r(e,t):void 0}}function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=Array(t);a<t;a++)n[a]=e[a];return n}function s(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,n)}return a}function c(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?s(Object(a),!0).forEach(function(t){d(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):s(Object(a)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}function d(t,a,n){return(a=function(t){var a=function(t){if("object"!=e(t)||!t)return t;var a=t[Symbol.toPrimitive];if(void 0!==a){var n=a.call(t,"string");if("object"!=e(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==e(a)?a:a+""}(a))in t?Object.defineProperty(t,a,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[a]=n,t}function u(e,t,a,n,i,l,o){try{var r=e[l](o),s=r.value}catch(e){return void a(e)}r.done?t(s):Promise.resolve(s).then(n,i)}function f(e){return function(){var t=this,a=arguments;return new Promise(function(n,i){var l=e.apply(t,a);function o(e){u(l,n,i,o,r,"next",e)}function r(e){u(l,n,i,o,r,"throw",e)}o(void 0)})}}function p(){return g.apply(this,arguments)}function g(){return g=f(t().m(function e(){var a;return t().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,Excel.run(function(){var e=f(t().m(function e(a){var o,r,s,u,p,g,m,h,y,v,b,k,x,S,w,z,C,F,E,I,A,M,q,P,U,O,R,D,N,j,T,W,V,L,_,$,B,G,Y,H,K,X,Z,J,Q,ee,te,ae,ne,ie,le,oe,re,se,ce,de,ue,fe,pe,ge,me,he,ye,ve,be,ke,xe,Se,we,ze,Ce,Fe,Ee,Ie,Ae,Me,qe,Pe,Ue,Oe,Re,De,Ne,je,Te,We,Ve,Le,_e,$e,Be,Ge,Ye,He,Ke,Xe,Ze,Je,Qe,et,tt,at,nt,it,lt,ot,rt,st,ct,dt,ut,ft,pt,gt,mt,ht,yt,vt,bt,kt,xt,St,wt,zt,Ct,Ft,Et,It,At,Mt,qt,Pt,Ut,Ot,Rt,Dt,Nt,jt,Tt,Wt,Vt,Lt,_t,$t,Bt,Gt,Yt,Ht,Kt,Xt,Zt,Jt,Qt,ea,ta,aa,na,ia,la,oa,ra,sa,ca,da,ua,fa,pa,ga,ma,ha,ya,va,ba,ka,xa,Sa,wa,za,Ca,Fa,Ea,Ia,Aa,Ma,qa,Pa,Ua,Oa,Ra,Da,Na,ja,Ta,Wa,Va,La,_a,$a,Ba,Ga,Ya,Ha,Ka,Xa,Za,Ja,Qa,en,tn,an,nn,ln,on,rn,sn,cn,dn;return t().w(function(e){for(;;)switch(e.n){case 0:return o=a.workbook.worksheets.getActiveWorksheet(),(r=a.workbook.getSelectedRange()).load("values, left, top"),e.n=1,a.sync();case 1:if(!((s=r.values).length<2)){e.n=2;break}return console.warn("Need at least header row + one data row"),e.a(2);case 2:if(u=s[0],p=s.slice(1),g=p.map(function(e){var t={};return u.forEach(function(a,n){t[a]=e[n]}),t}),"scatter"!==(m=document.getElementById("chartType").value)){e.n=3;break}h=d({$schema:"https://vega.github.io/schema/vega-lite/v6.json",description:"Scatter plot from Excel selection",background:"white",config:{view:{stroke:"transparent"}},data:{values:g},mark:{type:"point",size:100,tooltip:!0},encoding:c(c({x:{field:u[0],type:"quantitative",scale:{zero:!1},axis:{title:u[0],labelFontSize:12,titleFontSize:14}},y:{field:u[1],type:"quantitative",scale:{zero:!1},axis:{title:u[1],labelFontSize:12,titleFontSize:14}}},u.length>=3&&{color:{field:u[2],type:"nominal",legend:{title:u[2],titleFontSize:12,labelFontSize:11}}}),u.length>=4&&{shape:{field:u[3],type:"nominal",legend:{title:u[3],titleFontSize:12,labelFontSize:11}}})},"config",{font:"Segoe UI",axis:{labelColor:"#605e5c",titleColor:"#323130",gridColor:"#f3f2f1"},legend:{titleColor:"#323130",labelColor:"#605e5c"}}),e.n=78;break;case 3:if("bubble"!==m){e.n=4;break}h=d({$schema:"https://vega.github.io/schema/vega-lite/v6.json",description:"Bubble chart from Excel selection",background:"white",config:{view:{stroke:"transparent"}},data:{values:g},mark:{type:"circle",tooltip:!0,opacity:.7},encoding:c({x:{field:u[0],type:"quantitative",scale:{zero:!1},axis:{title:u[0],labelFontSize:12,titleFontSize:14}},y:{field:u[1],type:"quantitative",scale:{zero:!1},axis:{title:u[1],labelFontSize:12,titleFontSize:14}},size:{field:u[2],type:"quantitative",scale:{type:"linear",range:[100,1e3]},legend:{title:u[2],titleFontSize:12,labelFontSize:11}}},u.length>=4&&{color:{field:u[3],type:"nominal",legend:{title:u[3],titleFontSize:12,labelFontSize:11}}})},"config",{font:"Segoe UI",axis:{labelColor:"#605e5c",titleColor:"#323130",gridColor:"#f3f2f1"},legend:{titleColor:"#323130",labelColor:"#605e5c"}}),e.n=78;break;case 4:if("ring"!==m){e.n=7;break}if(!(u.length<2)){e.n=5;break}throw new Error("Ring chart requires 2 columns: Category, Value");case 5:if(0!==(y=g.length)){e.n=6;break}throw new Error("Ring chart requires at least one data row");case 6:for(v=Math.max(15,Math.min(25,120/y)),b=Math.max(3,Math.min(8,40/y)),k=150+5*y,x=function(e,t){var a=Math.max(50,80-5*e),n=Math.max(25,60-8*e);return"hsl(".concat(210,", ").concat(a,"%, ").concat(n,"%)")},S=g.map(function(e,t){return d(d(d(d({},"__".concat(t,"__"),e[u[0]]),"__".concat(t+100,"__"),e[u[1]]),"Ring".concat(t+1,"_Theta2"),2*Math.PI*e[u[1]]/100),"Ring".concat(t+1,"_Percent_Label"),e[u[1]]+"%")}),w=[Object.assign.apply(Object,[{}].concat(l(S)))],z=[],C=k,F=0;F<y;F++)A=((E=C)+(I=E-v))/2,z.push({outer:E,inner:I,middle:A}),C=I-b;M=k+50-25*y/2,h={$schema:"https://vega.github.io/schema/vega-lite/v5.json",config:{autosize:{type:"pad",resize:!0},concat:{spacing:20}},description:"Dynamic ring chart with ".concat(y," concentric rings"),background:"white",data:{values:w},hconcat:[{description:"RINGS - Main Chart",width:2*(k+50),height:2*(k+50),view:{stroke:null},layer:[].concat(l(g.map(function(e,t){return{description:"RING ".concat(t+1," BACKGROUND"),mark:{type:"arc",radius:z[t].outer,radius2:z[t].inner,theta:0,theta2:6.283185307179586,opacity:.25,x:k+50,y:k+50},encoding:{color:{value:x(t)}}}})),l(g.map(function(e,t){return{description:"RING ".concat(t+1," PROGRESS"),mark:{type:"arc",radius:z[t].outer,radius2:z[t].inner,theta:0,theta2:{expr:"datum['Ring".concat(t+1,"_Theta2']")},cornerRadius:Math.min(8,v/2),tooltip:!0,x:k+50,y:k+50},encoding:{color:{value:x(t)},tooltip:[{value:e[u[0]],title:"Category"},{value:e[u[1]]+"%",title:"Progress"}]}}})),l(g.map(function(e,t){return{description:"RING ".concat(t+1," LABEL"),mark:{type:"text",align:"center",baseline:"middle",x:k+50+15,y:k+50-z[t].middle,fontSize:Math.max(10,Math.min(14,180/y)),font:"Segoe UI",fontWeight:"bold",color:"white"},encoding:{text:{value:e[u[1]]+"%"},opacity:{condition:{test:"datum['Ring".concat(t+1,"_Theta2'] > 0"),value:1},value:0}}}})))},{description:"LEGEND - Right Side",width:100,height:2*(k+50),view:{stroke:null},layer:g.map(function(e,t){return[{description:"LEGEND CIRCLE ".concat(t+1),mark:{type:"circle",size:150,x:15,y:M+25*t,color:x(t)}},{description:"LEGEND LABEL ".concat(t+1),mark:{type:"text",x:35,y:M+25*t,align:"left",baseline:"middle",fontSize:11,font:"Segoe UI"},encoding:{text:{value:e[u[0]]}}}]}).flat()}],view:{stroke:null}},e.n=78;break;case 7:if("line"!==m){e.n=8;break}q=[],P=u.slice(1),g.forEach(function(e){P.forEach(function(t){null!==e[t]&&void 0!==e[t]&&""!==e[t]&&q.push(d(d(d({},u[0],e[u[0]]),"series",t),"value",parseFloat(e[t])||0))})}),h=d({$schema:"https://vega.github.io/schema/vega-lite/v6.json",description:"Multi-series line chart from Excel selection",background:"white",config:{view:{stroke:"transparent"}},data:{values:q},mark:{type:"line",point:!1,tooltip:!0,strokeWidth:2},encoding:{x:{field:u[0],type:"ordinal",axis:{title:u[0],labelFontSize:12,titleFontSize:14,labelAngle:0}},y:{field:"value",type:"quantitative",axis:{title:"Value",labelFontSize:12,titleFontSize:14}},color:{field:"series",type:"nominal",scale:{scheme:"category10"},legend:{title:"Series",titleFontSize:12,labelFontSize:11}}}},"config",{font:"Segoe UI",axis:{labelColor:"#605e5c",titleColor:"#323130",gridColor:"#f3f2f1"},legend:{titleColor:"#323130",labelColor:"#605e5c"},point:{size:60,filled:!0}}),e.n=78;break;case 8:if("step"!==m){e.n=11;break}if(U=function(e){return"number"==typeof e?new Date(Math.round(86400*(e-25569)*1e3)):new Date(e)},!(u.length<2)){e.n=9;break}throw new Error("Step chart requires at least 2 columns: Date/Time (X-axis), Values (Y-axis)");case 9:if(0!==(O=g.map(function(e,t){if(!e[u[0]]||null==e[u[1]]||""===e[u[1]])return null;var a=U(e[u[0]]),n=parseFloat(e[u[1]]);return isNaN(a.getTime())||isNaN(n)?null:{date:a.toISOString(),price:n}}).filter(Boolean)).length){e.n=10;break}return console.warn("No valid step chart data found"),e.a(2);case 10:h=d({$schema:"https://vega.github.io/schema/vega-lite/v6.json",width:600,description:"Step chart from Excel selection",background:"white",config:{view:{stroke:"transparent"}},data:{values:O},mark:{type:"line",interpolate:"step-after",strokeWidth:2},encoding:{x:{field:"date",type:"temporal",axis:{title:null,format:"%m/%d",labelAngle:-45,labelFontSize:11,labelColor:"#605e5c",font:"Segoe UI"}},y:{field:"price",type:"quantitative",scale:{zero:!1},axis:{title:null,labelFontSize:11,labelColor:"#605e5c",font:"Segoe UI",grid:!0,gridColor:"#f3f2f1"}},tooltip:[{field:"date",type:"temporal",title:"Date",format:"%Y-%m-%d"},{field:"price",type:"quantitative",title:"Price",format:".2f"}]}},"config",{font:"Segoe UI",axis:{labelColor:"#605e5c",titleColor:"#323130",gridColor:"#f3f2f1"}}),e.n=78;break;case 11:if("gantt"!==m){e.n=12;break}R=function(e){return new Date(Math.round(86400*(e-25569)*1e3))},D=function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=[],o=i(j.get(t)||[]);try{for(o.s();!(e=o.n()).done;){var r=e.value;r.level=a,n.push(r),n.push.apply(n,l(D(r.id,a+1)))}}catch(e){o.e(e)}finally{o.f()}return n},(N=p.map(function(e){var t=e[0]||null,a=e[1],n=e[2]||"Task ".concat(a);if(!a)return null;var i="number"==typeof e[3]?R(e[3]):new Date(e[3]),l="number"==typeof e[4]?R(e[4]):new Date(e[4]);if(!(i instanceof Date)||isNaN(i)||!(l instanceof Date)||isNaN(l))return null;var o=0;return e[5]&&(o="string"==typeof e[5]&&e[5].includes("%")?parseFloat(e[5])/100:e[5]>1?e[5]/100:e[5]),{id:a,parentId:t,name:n,startDate:i,endDate:l,progress:o,dependencies:e[6]?String(e[6]).split(",").map(function(e){return e.trim()}):[]}}).filter(Boolean)).forEach(function(e){var t=e.endDate-e.startDate;e.progressEnd=new Date(e.startDate.getTime()+t*e.progress)}),j=new Map,N.forEach(function(e){j.has(e.parentId)||j.set(e.parentId,[]),j.get(e.parentId).push(e)}),T=i(j.entries());try{for(T.s();!(W=T.n()).done;)(V=n(W.value,2))[0],V[1].sort(function(e,t){return e.startDate-t.startDate})}catch(e){T.e(e)}finally{T.f()}L=D(null),h={$schema:"https://vega.github.io/schema/vega-lite/v5.json",description:"Gantt Chart from Excel Data",width:800,height:Math.max(300,30*L.length),data:{values:L},layer:[{mark:{type:"bar",opacity:.3,height:20},encoding:{y:{field:"name",type:"nominal",axis:{title:null,labelFontSize:11},sort:null},x:{field:"startDate",type:"temporal",axis:{title:"Timeline",format:"%b %d",labelAngle:-45}},x2:{field:"endDate",type:"temporal"},color:{field:"level",type:"ordinal",scale:{scheme:"category10"},legend:{title:"Level"}},tooltip:[{field:"name",type:"nominal",title:"Task"},{field:"startDate",type:"temporal",title:"Start",format:"%Y-%m-%d"},{field:"endDate",type:"temporal",title:"End",format:"%Y-%m-%d"},{field:"progress",type:"quantitative",title:"Progress",format:".0%"}]}},{mark:{type:"bar",opacity:.8,height:20},encoding:{y:{field:"name",type:"nominal",sort:null},x:{field:"startDate",type:"temporal"},x2:{field:"progressEnd",type:"temporal"},color:{field:"level",type:"ordinal",scale:{scheme:"category10"}}}},{mark:{type:"text",align:"left",baseline:"middle",dx:5,fontSize:10},encoding:{y:{field:"name",type:"nominal",sort:null},x:{field:"endDate",type:"temporal"},text:{field:"progress",type:"quantitative",format:".0%"},color:{value:"#666"}}},{mark:{type:"rule",strokeDash:[4,4],opacity:.5},data:{values:[{date:(new Date).toISOString()}]},encoding:{x:{field:"date",type:"temporal"},color:{value:"red"},size:{value:1}}}],config:{view:{stroke:null},axis:{grid:!0,gridColor:"#f0f0f0"}}},e.n=78;break;case 12:if("dumbbell"!==m){e.n=14;break}if(!(u.length<3)){e.n=13;break}return console.warn("Dumbbell chart requires 3 columns: Category, Value 1, Value 2"),e.a(2);case 13:_=[],g.forEach(function(e){var t=e[u[0]],a=parseFloat(e[u[1]])||0,n=parseFloat(e[u[2]])||0;_.push({category:t,period:u[1],value:a}),_.push({category:t,period:u[2],value:n})}),$=l(new Set(g.map(function(e){return e[u[0]]}))),(B=$.length)<=3?(G=Math.max(200,80*B),Y=.3,H=.2):B<=6?(G=Math.max(300,60*B),Y=.2,H=.1):(G=Math.max(400,Math.min(600,50*B)),Y=.1,H=.05),h=d({$schema:"https://vega.github.io/schema/vega-lite/v6.json",description:"Dumbbell chart from Excel selection",background:"white",config:{view:{stroke:"transparent"}},width:500,height:G,data:{values:_},encoding:{x:{field:"value",type:"quantitative",title:null,scale:{zero:!1},axis:{labelFontSize:12,labelColor:"#605e5c",grid:!0,gridColor:"#f3f2f1",labelAlign:"center"}},y:{field:"category",type:"nominal",title:null,scale:{paddingInner:Y,paddingOuter:H},axis:{offset:5,ticks:!1,minExtent:70,domain:!1,labelFontSize:12,labelColor:"#605e5c"}}},layer:[{mark:"line",encoding:{detail:{field:"category",type:"nominal"},color:{value:"#d1d5db"}}},{mark:{type:"point",filled:!0,tooltip:!0},encoding:{color:{field:"period",type:"ordinal",scale:{domain:[u[1],u[2]],range:["#87ceeb","#1e3a8a"]},title:"Measure",legend:{titleFontSize:12,labelFontSize:11,titleColor:"#323130",labelColor:"#605e5c"}},size:{value:100},opacity:{value:1},tooltip:[{field:"category",type:"nominal",title:"Category"},{field:"period",type:"nominal",title:"Measure"},{field:"value",type:"quantitative",title:"Value",format:",.1f"}]}}]},"config",{font:"Segoe UI",axis:{labelColor:"#605e5c",titleColor:"#323130",gridColor:"#f3f2f1"},legend:{titleColor:"#323130",labelColor:"#605e5c"}}),e.n=78;break;case 14:if("slope"!==m){e.n=15;break}K=l(new Set(g.map(function(e){return e[u[0]]}))),X=l(new Set(g.map(function(e){return e[u[1]]}))),Z=K[0],J=K[K.length-1],Q=g.filter(function(e){return e[u[0]]===Z||e[u[0]]===J}),ee=Q.map(function(e){return e[u[2]]}),te=ee.every(function(e){return e>=-1&&e<=1}),ae=te?".1%":",.0f",ne=Math.max(300,Math.min(600,40*X.length)),h=d({$schema:"https://vega.github.io/schema/vega-lite/v6.json",description:"Slope chart from Excel selection",background:"white",config:{view:{stroke:"transparent"},autosize:{type:"fit",contains:"padding"}},width:500,height:ne,data:{values:Q},encoding:{x:{field:u[0],type:"ordinal",axis:{title:null,labelFontSize:14,labelFontWeight:"bold",labelPadding:10,domain:!1,ticks:!1,labelColor:"#323130"},scale:{padding:.1}},y:{field:u[2],type:"quantitative",axis:null,scale:{zero:!1}},color:{field:u[1],type:"nominal",legend:null,scale:{scheme:"category10"}}},layer:[{mark:{type:"rule",strokeDash:[2,2],opacity:.3},data:{values:[{}]},encoding:{x:{datum:Z},x2:{datum:J},y:{value:0},color:{value:"#e0e0e0"}}},{mark:{type:"line",strokeWidth:2,opacity:.7,tooltip:!0},encoding:{detail:{field:u[1],type:"nominal"},tooltip:[{field:u[1],type:"nominal",title:"Category"},{field:u[0],type:"nominal",title:"Period"},{field:u[2],type:"quantitative",title:"Value",format:ae}]}},{mark:{type:"circle",size:100,opacity:1,tooltip:!0}},{transform:[{filter:"datum['".concat(u[0],"'] == '").concat(Z,"'")}],mark:{type:"text",align:"right",baseline:"middle",dx:-8,fontSize:11,fontWeight:"normal"},encoding:{text:{field:u[2],type:"quantitative",format:ae}}},{transform:[{filter:"datum['".concat(u[0],"'] == '").concat(Z,"'")},{window:[{op:"rank",as:"rank"}],sort:[{field:u[2],order:"descending"}]},{filter:"datum.rank <= 3"}],mark:{type:"text",align:"right",baseline:"bottom",dx:-8,dy:-12,fontSize:10,fontWeight:"bold",fontStyle:"italic"},encoding:{text:{field:u[1],type:"nominal"}}},{transform:[{filter:"datum['".concat(u[0],"'] == '").concat(J,"'")}],mark:{type:"text",align:"left",baseline:"middle",dx:8,fontSize:11,fontWeight:"normal"},encoding:{text:{field:u[2],type:"quantitative",format:ae}}},{transform:[{filter:"datum['".concat(u[0],"'] == '").concat(J,"'")}],mark:{type:"text",align:"left",baseline:"middle",dx:35,fontSize:10,fontWeight:"bold"},encoding:{text:{field:u[1],type:"nominal"}}}]},"config",{view:{stroke:"transparent"},font:"Segoe UI",text:{font:"Segoe UI",fontSize:11,fill:"#605E5C"},axis:{labelColor:"#605e5c",titleColor:"#323130",gridColor:"#f3f2f1"}}),e.n=78;break;case 15:if("bullet"!==m){e.n=16;break}ie=p.map(function(e){return{title:e[0],ranges:[+e[1],+e[2],+e[3]],measures:[+e[4],+e[5]],markers:[+e[6]]}}),h=d({$schema:"https://vega.github.io/schema/vega-lite/v6.json",background:"white",config:{view:{stroke:"transparent"}},data:{values:ie},facet:{row:{field:"title",type:"ordinal",header:{labelAngle:0,title:"",labelAlign:"left"}}},spacing:10,spec:{encoding:{x:{type:"quantitative",scale:{nice:!1},title:null}},layer:[{mark:{type:"bar",color:"#eee"},encoding:{x:{field:"ranges[2]"}}},{mark:{type:"bar",color:"#ddd"},encoding:{x:{field:"ranges[1]"}}},{mark:{type:"bar",color:"#ccc"},encoding:{x:{field:"ranges[0]"}}},{mark:{type:"bar",color:"lightsteelblue",size:10},encoding:{x:{field:"measures[1]"}}},{mark:{type:"bar",color:"steelblue",size:10},encoding:{x:{field:"measures[0]"}}},{mark:{type:"tick",color:"black"},encoding:{x:{field:"markers[0]"}}}]},resolve:{scale:{x:"independent"}}},"config",{tick:{thickness:2},scale:{barBandPaddingInner:0}}),e.n=78;break;case 16:if("box"!==m){e.n=17;break}le=p.filter(function(e){return e[0]&&!isNaN(+e[1])}).map(function(e){return{category:e[0],value:+e[1]}}),h={$schema:"https://vega.github.io/schema/vega-lite/v6.json",description:"Box plot from Excel selection",data:{values:le},mark:{type:"boxplot",extent:"min-max"},encoding:{x:{field:"category",type:"nominal"},y:{field:"value",type:"quantitative",scale:{zero:!1}},color:{field:"category",type:"nominal",legend:null}}},e.n=78;break;case 17:if("horizon"!==m){e.n=18;break}oe=g.map(function(e,t){return{x:e[u[0]]||t+1,y:parseFloat(e[u[1]])||0}}),re=oe.map(function(e){return e.y}),se=Math.max.apply(Math,l(re)),ce=Math.min.apply(Math,l(re)),ue=(de=se-ce)/6,fe=ce+de/2,pe=oe.length,ge=Math.max(300,Math.min(800,15*pe)),h={$schema:"https://vega.github.io/schema/vega-lite/v6.json",description:"Horizon Graph from Excel selection (IDL methodology)",width:ge,height:60,background:"white",config:{view:{stroke:"transparent"},area:{interpolate:"monotone"}},data:{values:oe},encoding:{x:{field:"x",type:u[0].toLowerCase().includes("date")?"temporal":"quantitative",scale:{zero:!1,nice:!1},axis:{title:u[0],labelFontSize:10,titleFontSize:12,labelColor:"#605e5c",titleColor:"#323130",font:"Segoe UI"}},y:{type:"quantitative",scale:{domain:[0,ue]},axis:{title:u[1],orient:"left",labelFontSize:10,titleFontSize:12,labelColor:"#605e5c",titleColor:"#323130",font:"Segoe UI",tickCount:3}}},layer:[{transform:[{calculate:"max(0, min(datum.y - ".concat(fe,", ").concat(ue,"))"),as:"band1"}],mark:{type:"area",clip:!0,opacity:.3,color:"#4a90e2",interpolate:"monotone"},encoding:{y:{field:"band1"}}},{transform:[{calculate:"max(0, min(datum.y - ".concat(fe," - ").concat(ue,", ").concat(ue,"))"),as:"band2"}],mark:{type:"area",clip:!0,opacity:.6,color:"#2e7bd6",interpolate:"monotone"},encoding:{y:{field:"band2"}}},{transform:[{calculate:"max(0, datum.y - ".concat(fe," - ").concat(2*ue,")"),as:"band3"}],mark:{type:"area",clip:!0,opacity:.9,color:"#1a5bb8",interpolate:"monotone"},encoding:{y:{field:"band3"}}},{transform:[{calculate:"max(0, min(".concat(fe," - datum.y, ").concat(ue,"))"),as:"nband1"}],mark:{type:"area",clip:!0,opacity:.3,color:"#e74c3c",interpolate:"monotone"},encoding:{y:{field:"nband1"}}},{transform:[{calculate:"max(0, min(".concat(fe," - datum.y - ").concat(ue,", ").concat(ue,"))"),as:"nband2"}],mark:{type:"area",clip:!0,opacity:.6,color:"#c0392b",interpolate:"monotone"},encoding:{y:{field:"nband2"}}},{transform:[{calculate:"max(0, ".concat(fe," - datum.y - ").concat(2*ue,")"),as:"nband3"}],mark:{type:"area",clip:!0,opacity:.9,color:"#a93226",interpolate:"monotone"},encoding:{y:{field:"nband3"}}}]},e.n=78;break;case 18:if("tree"!==m){e.n=19;break}me=new Map,g.forEach(function(e,t){var a=e[u[0]]||"",n=e[u[1]]||"node_".concat(t),i=u.length>=3&&parseFloat(e[u[2]])||1;if(a&&!me.has(a)&&me.set(a,{id:a,parent:"",name:a,value:1}),me.has(n)){var l=me.get(n);l.parent=a,l.value=i}else me.set(n,{id:n,parent:a,name:n,value:i})}),he=Array.from(me.values()),ye=new Set(he.map(function(e){return e.id})),he.forEach(function(e){e.parent&&!ye.has(e.parent)&&(e.parent="")}),ve=he.length,be=Math.max(600,Math.min(1200,40*ve)),ke=Math.max(400,Math.min(1600,30*ve)),h={$schema:"https://vega.github.io/schema/vega/v6.json",description:"Tree diagram from Excel selection",width:be,height:ke,padding:20,background:"white",config:{view:{stroke:"transparent"}},signals:[{name:"layout",value:"tidy"},{name:"links",value:"diagonal"}],data:[{name:"tree",values:he,transform:[{type:"stratify",key:"id",parentKey:"parent"},{type:"tree",method:{signal:"layout"},size:[{signal:"height - 40"},{signal:"width - 100"}],as:["y","x","depth","children"]}]},{name:"links",source:"tree",transform:[{type:"treelinks"},{type:"linkpath",orient:"horizontal",shape:{signal:"links"}}]}],scales:[{name:"color",type:"ordinal",range:["#0078d4","#00bcf2","#40e0d0","#00cc6a","#10893e","#107c10","#bad80a","#ffb900","#ff8c00","#d13438"],domain:{data:"tree",field:"depth"}},{name:"size",type:"linear",range:[100,400],domain:{data:"tree",field:"value"}}],marks:[{type:"path",from:{data:"links"},encode:{update:{path:{field:"path"},stroke:{value:"#8a8886"},strokeWidth:{value:2},strokeOpacity:{value:.6}}}},{type:"symbol",from:{data:"tree"},encode:{enter:{stroke:{value:"#ffffff"},strokeWidth:{value:2}},update:{x:{field:"x"},y:{field:"y"},size:{scale:"size",field:"value"},fill:{scale:"color",field:"depth"},fillOpacity:{value:.8},tooltip:{signal:"{'Name': datum.name, 'ID': datum.id, 'Parent': datum.parent, 'Depth': datum.depth, 'Value': datum.value}"}},hover:{fillOpacity:{value:1},strokeWidth:{value:3}}}},{type:"text",from:{data:"tree"},encode:{enter:{fontSize:{value:11},baseline:{value:"middle"},font:{value:"Segoe UI"},fontWeight:{value:"bold"}},update:{x:{field:"x"},y:{field:"y"},text:{field:"name"},dx:{signal:"datum.children ? -12 : 12"},align:{signal:"datum.children ? 'right' : 'left'"},fill:{value:"#323130"}}}}]},e.n=78;break;case 19:if("sunburst"!==m){e.n=20;break}xe=new Map,g.forEach(function(e,t){var a=e[u[0]]||"",n=e[u[1]]||"node_".concat(t),i=u.length>=3&&parseFloat(e[u[2]])||1;if(a&&!xe.has(a)&&xe.set(a,{id:a,parent:"",name:a,size:0}),xe.has(n)){var l=xe.get(n);l.parent=a,l.size=i}else xe.set(n,{id:n,parent:a,name:n,size:i})}),Se=Array.from(xe.values()),we=new Set(Se.map(function(e){return e.id})),Se.forEach(function(e){e.parent&&!we.has(e.parent)&&(e.parent="")}),ze=Se.length,Ce=Math.max(400,Math.min(600,15*ze+300)),h={$schema:"https://vega.github.io/schema/vega/v6.json",description:"Sunburst chart from Excel selection",width:Ce,height:Ce,padding:10,autosize:"none",background:"white",config:{view:{stroke:"transparent"}},signals:[{name:"centerX",update:"width / 2"},{name:"centerY",update:"height / 2"},{name:"outerRadius",update:"min(width, height) / 2 - 10"}],data:[{name:"tree",values:Se,transform:[{type:"stratify",key:"id",parentKey:"parent"},{type:"partition",field:"size",sort:{field:"size",order:"descending"},size:[{signal:"2 * PI"},{signal:"outerRadius"}],as:["a0","r0","a1","r1","depth","children"]}]}],scales:[{name:"color",type:"ordinal",domain:{data:"tree",field:"depth"},range:["#0078d4","#00bcf2","#40e0d0","#00cc6a","#10893e","#107c10","#bad80a","#ffb900","#ff8c00","#d13438","#8764b8","#e3008c","#00b7c3","#038387","#486991"]},{name:"opacity",type:"linear",domain:{data:"tree",field:"depth"},range:[.8,.4]}],marks:[{type:"arc",from:{data:"tree"},encode:{enter:{x:{signal:"centerX"},y:{signal:"centerY"},stroke:{value:"white"},strokeWidth:{value:1}},update:{startAngle:{field:"a0"},endAngle:{field:"a1"},innerRadius:{field:"r0"},outerRadius:{field:"r1"},fill:{scale:"color",field:"depth"},fillOpacity:{scale:"opacity",field:"depth"}}}},{type:"text",from:{data:"tree"},encode:{enter:{x:{signal:"centerX"},y:{signal:"centerY"},radius:{signal:"(datum.r0 + datum.r1) / 2"},theta:{signal:"(datum.a0 + datum.a1) / 2"},fill:{value:"#323130"},font:{value:"Segoe UI"},fontSize:{value:10},fontWeight:{value:"bold"},align:{value:"center"},baseline:{value:"middle"}},update:{text:{signal:"(datum.r1 - datum.r0) > 20 && (datum.a1 - datum.a0) > 0.3 ? datum.name : ''"},opacity:{signal:"(datum.r1 - datum.r0) > 20 && (datum.a1 - datum.a0) > 0.3 ? 1 : 0"}}}}]},e.n=78;break;case 20:if("radar"!==m){e.n=21;break}Fe=[],Ee=u.slice(1),g.forEach(function(e,t){var a=e[u[0]]||"Series ".concat(t+1);Ee.forEach(function(n){var i=parseFloat(e[n])||0;Fe.push({series:a,dimension:n,value:i,category:t})})}),Ie=l(new Set(Fe.map(function(e){return e.dimension}))),h={$schema:"https://vega.github.io/schema/vega/v6.json",description:"Radar chart from Excel selection",width:400,height:400,padding:60,autosize:{type:"none",contains:"padding"},background:"white",config:{view:{stroke:"transparent"}},signals:[{name:"radius",update:"width / 2"}],data:[{name:"table",values:Fe},{name:"dimensions",values:Ie.map(function(e){return{dimension:e}})}],scales:[{name:"angular",type:"point",range:{signal:"[-PI, PI]"},padding:.5,domain:Ie},{name:"radial",type:"linear",range:{signal:"[0, radius]"},zero:!0,nice:!0,domain:{data:"table",field:"value"},domainMin:0},{name:"color",type:"ordinal",domain:{data:"table",field:"category"},range:["#0078d4","#00bcf2","#40e0d0","#00cc6a","#10893e","#107c10","#bad80a","#ffb900","#ff8c00","#d13438"]}],encode:{enter:{x:{signal:"radius"},y:{signal:"radius"}}},marks:[{type:"group",name:"categories",zindex:1,from:{facet:{data:"table",name:"facet",groupby:["category","series"]}},marks:[{type:"line",name:"category-line",from:{data:"facet"},encode:{enter:{interpolate:{value:"linear-closed"},x:{signal:"scale('radial', datum.value) * cos(scale('angular', datum.dimension))"},y:{signal:"scale('radial', datum.value) * sin(scale('angular', datum.dimension))"},stroke:{scale:"color",field:"category"},strokeWidth:{value:2},fill:{scale:"color",field:"category"},fillOpacity:{value:.1},strokeOpacity:{value:.8}}}},{type:"symbol",name:"category-points",from:{data:"facet"},encode:{enter:{x:{signal:"scale('radial', datum.value) * cos(scale('angular', datum.dimension))"},y:{signal:"scale('radial', datum.value) * sin(scale('angular', datum.dimension))"},size:{value:50},fill:{scale:"color",field:"category"},stroke:{value:"white"},strokeWidth:{value:1}}}}]},{type:"rule",name:"radial-grid",from:{data:"dimensions"},zindex:0,encode:{enter:{x:{value:0},y:{value:0},x2:{signal:"radius * cos(scale('angular', datum.dimension))"},y2:{signal:"radius * sin(scale('angular', datum.dimension))"},stroke:{value:"#e1e4e8"},strokeWidth:{value:1}}}},{type:"text",name:"dimension-label",from:{data:"dimensions"},zindex:1,encode:{enter:{x:{signal:"(radius + 20) * cos(scale('angular', datum.dimension))"},y:{signal:"(radius + 20) * sin(scale('angular', datum.dimension))"},text:{field:"dimension"},align:[{test:"abs(scale('angular', datum.dimension)) > PI / 2",value:"right"},{value:"left"}],baseline:[{test:"scale('angular', datum.dimension) > 0",value:"top"},{test:"scale('angular', datum.dimension) == 0",value:"middle"},{value:"bottom"}],fill:{value:"#323130"},fontWeight:{value:"bold"},font:{value:"Segoe UI"},fontSize:{value:12}}}},{type:"line",name:"outer-line",from:{data:"radial-grid"},encode:{enter:{interpolate:{value:"linear-closed"},x:{field:"x2"},y:{field:"y2"},stroke:{value:"#8a8886"},strokeWidth:{value:2},strokeOpacity:{value:.6}}}}]},e.n=78;break;case 21:if("waterfall"!==m){e.n=22;break}(Ae=l(g)).length>0&&(Ae[Ae.length-1]=c(c({},Ae[Ae.length-1]),{},d({},u[1],0))),Me=g.length,qe=Math.max(400,Math.min(1600,50*Me)),Pe=Math.max.apply(Math,l(g.map(function(e){return Math.abs(e[u[1]])}))),Ue=Math.max(300,Math.min(600,Pe/100+200)),h=d({$schema:"https://vega.github.io/schema/vega-lite/v6.json",description:"Waterfall chart with multiple subtotals",background:"white",data:{values:Ae},config:{view:{stroke:"transparent"}},width:qe,height:Ue,transform:[{window:[{op:"sum",field:u[1],as:"sum"}]},{window:[{op:"lead",field:u[0],as:"lead"}]},{calculate:"datum.lead === null ? datum.".concat(u[0]," : datum.lead"),as:"lead"},{calculate:"datum.".concat(u[2]," == 'total' ? 0 : datum.sum - datum.").concat(u[1]),as:"previous_sum"},{calculate:"datum.".concat(u[2]," == 'total' ? datum.sum : datum.").concat(u[1]),as:"amount"},{calculate:"datum.".concat(u[2]," == 'total' ? datum.").concat(u[1]," / 2 : (datum.sum + datum.previous_sum) / 2"),as:"center"},{calculate:"datum.".concat(u[2]," == 'total' ? datum.sum : (datum.").concat(u[1]," > 0 ? '+' : '') + datum.").concat(u[1]),as:"text_amount"},{calculate:"(datum.sum + datum.previous_sum) / 2",as:"center"},{window:[{op:"rank",as:"group_index"}],frame:[null,null],groupby:[u[0]]},{calculate:"\n                datum.".concat(u[2]," == 'total'\n                    ? '#00B0F0'\n                    : datum.amount >= 0\n                    ? (datum.group_index == 1 ? '#70AD47'\n                        : (datum.group_index == 2 ? '#8BC97A'\n                        : (datum.group_index == 3 ? '#A7DA9D'\n                        : '#C3EBC0')))\n                    : (datum.group_index == 1 ? '#E15759'\n                        : (datum.group_index == 2 ? '#EC7A7C'\n                        : (datum.group_index == 3 ? '#F29C9D'\n                        : '#F8BEBF')))\n                "),as:"bar_color"}],encoding:{x:{field:u[0],type:"ordinal",sort:null,axis:{labelAngle:-45,title:null},scale:{paddingInner:.05,paddingOuter:.025}}},layer:[{mark:{type:"bar",size:60},encoding:{y:{field:"previous_sum",type:"quantitative",title:null},y2:{field:"sum"},color:{field:"bar_color",type:"nominal",scale:null}}},{mark:{type:"text",fontWeight:"bold",baseline:"middle"},encoding:{y:{field:"center",type:"quantitative"},text:{field:"text_amount",type:"nominal"},color:{condition:[{test:"datum.".concat(u[2]," == 'total'"),value:"#725a30"}],value:"white"}}}]},"config",{text:{fontWeight:"bold",color:"#D9D9D9"}}),e.n=78;break;case 22:if("gauge"!==m){e.n=24;break}if(!(u.length<2)){e.n=23;break}return console.warn("Gauge chart requires 2 columns: Current Value, Max Value"),e.a(2);case 23:Oe=g[0],Re=parseFloat(Oe[u[0]])||0,De=parseFloat(Oe[u[1]])||100,h={$schema:"https://vega.github.io/schema/vega/v5.json",description:"Gauge chart from Excel selection",width:400,height:220,background:"white",config:{view:{stroke:"transparent"}},signals:[{name:"centerX",update:"width / 2"},{name:"centerY",update:"height - 20"},{name:"outerRadius",update:"min(width / 2, height) - 20"},{name:"innerRadius",update:"outerRadius - outerRadius * 0.25"},{name:"mainValue",value:Re},{name:"minValue",value:0},{name:"maxValue",value:De},{name:"usedValue",update:"min(max(minValue, mainValue), maxValue)"},{name:"fontFactor",update:"(min(width, height)/5)/25"},{name:"backgroundColor",value:"#e1e4e8"},{name:"fillColor",value:"#0078d4"},{name:"needleColor",value:"#323130"},{name:"needleSize",update:"innerRadius"}],scales:[{name:"gaugeScale",type:"linear",domain:[{signal:"minValue"},{signal:"maxValue"}],range:[{signal:"-PI/2"},{signal:"PI/2"}]},{name:"needleScale",type:"linear",domain:[{signal:"minValue"},{signal:"maxValue"}],range:[-90,90]}],marks:[{type:"arc",name:"gauge",encode:{enter:{x:{signal:"centerX"},y:{signal:"centerY"},startAngle:{signal:"-PI/2"},endAngle:{signal:"PI/2"},outerRadius:{signal:"outerRadius"},innerRadius:{signal:"innerRadius"},fill:{signal:"backgroundColor"}}}},{type:"arc",encode:{enter:{startAngle:{signal:"-PI/2"}},update:{x:{signal:"centerX"},y:{signal:"centerY"},innerRadius:{signal:"innerRadius"},outerRadius:{signal:"outerRadius"},endAngle:{scale:"gaugeScale",signal:"usedValue"},fill:{signal:"fillColor"}}}},{type:"text",description:"displayed main value at the center",encode:{enter:{x:{signal:"centerX"},y:{signal:"centerY + fontFactor * 15"},baseline:{value:"middle"},align:{value:"center"},fontSize:{signal:"fontFactor * 7"},font:{value:"Segoe UI"},fontWeight:{value:"bold"}},update:{text:{signal:"mainValue < 1 ? format(mainValue, '.0%') : format(mainValue, ',.0f')"},fill:{signal:"fillColor"}}}},{type:"symbol",name:"needle",encode:{enter:{x:{signal:"centerX"},y:{signal:"centerY"}},update:{shape:{signal:"'M-2.5 -2.5 Q 0 0 2.5 -2.5 L 0 -' + toString(needleSize) + ' Z '"},angle:{signal:"usedValue",scale:"needleScale"},size:{signal:"4"},stroke:{signal:"needleColor"},fill:{signal:"needleColor"}}}},{type:"symbol",description:"center circle",encode:{enter:{x:{signal:"centerX"},y:{signal:"centerY"},shape:{value:"circle"},size:{signal:"pow(fontFactor * 8, 2)"},fill:{signal:"needleColor"},stroke:{value:"white"},strokeWidth:{value:2}}}}]},e.n=78;break;case 24:if("pie"!==m){e.n=25;break}h={$schema:"https://vega.github.io/schema/vega-lite/v6.json",background:"white",config:{view:{stroke:"transparent"}},description:"Pie chart from Excel selection",data:{values:g},mark:{type:"arc",outerRadius:120},encoding:{theta:{field:u[1],type:"quantitative"},color:{field:u[0],type:"nominal"}}},e.n=78;break;case 25:if("donut"!==m){e.n=28;break}if(!(u.length<2)){e.n=26;break}throw new Error("Donut chart requires 2 columns: Category, Value");case 26:if(!g.some(function(e){return isNaN(e[u[1]])||e[u[1]]<=0})){e.n=27;break}throw new Error("Donut chart values must be positive numbers");case 27:h=d({$schema:"https://vega.github.io/schema/vega-lite/v6.json",background:"white",config:{view:{stroke:"transparent"}},description:"Donut chart from Excel selection",data:{values:g},mark:{type:"arc",innerRadius:50,outerRadius:120,tooltip:!0,stroke:"white",strokeWidth:2},encoding:{theta:{field:u[1],type:"quantitative",scale:{type:"linear",range:[0,6.28]}},color:{field:u[0],type:"nominal",scale:{scheme:"category10"},legend:{title:u[0],titleFontSize:12,labelFontSize:11,orient:"right"}},tooltip:[{field:u[0],type:"nominal",title:"Category"},{field:u[1],type:"quantitative",title:"Value",format:",.0f"}]}},"config",{font:"Segoe UI",legend:{titleColor:"#323130",labelColor:"#605e5c"}}),e.n=78;break;case 28:if("histogram"!==m){e.n=29;break}Ne=p.filter(function(e){return!isNaN(+e[0])}).map(function(e){return{value:+e[0]}}),je=Ne.map(function(e){return e.value}),Te=Math.min.apply(Math,l(je)),We=Math.max.apply(Math,l(je)),Ve=(We-Te)/20,Le=Math.floor(Te/Ve)*Ve,_e=Math.ceil(We/Ve)*Ve,h=d({$schema:"https://vega.github.io/schema/vega-lite/v6.json",description:"Histogram from Excel selection",background:"white",config:{view:{stroke:"transparent"}},data:{values:Ne},mark:{type:"bar",tooltip:!0,stroke:"white",strokeWidth:1},encoding:{x:{field:"value",bin:{extent:[Le,_e],step:Ve,nice:!1},type:"quantitative",axis:{title:"Value",labelFontSize:12,titleFontSize:14,labelColor:"#605e5c",titleColor:"#323130"},scale:{domain:[Le,_e],range:"width",paddingInner:.05,paddingOuter:.02}},y:{aggregate:"count",type:"quantitative",axis:{title:"Count",labelFontSize:12,titleFontSize:14,labelColor:"#605e5c",titleColor:"#323130",gridColor:"#f3f2f1"}},color:{value:"#0078d4"}}},"config",{font:"Segoe UI",axis:{labelColor:"#605e5c",titleColor:"#323130",gridColor:"#f3f2f1"}}),e.n=78;break;case 29:if("density"!==m){e.n=31;break}if(!(u.length<1)){e.n=30;break}return console.warn("Density plot requires at least 1 column (Values)"),e.a(2);case 30:h=d({$schema:"https://vega.github.io/schema/vega-lite/v6.json",description:"Density plot from Excel selection",background:"white",config:{view:{stroke:"transparent"}},width:400,height:100,data:{values:g},transform:[{density:u[0],bandwidth:.3}],mark:"area",encoding:{x:{field:"value",title:u[0],type:"quantitative",axis:{labelFontSize:12,titleFontSize:14,labelColor:"#605e5c",titleColor:"#323130",gridColor:"#f3f2f1"}},y:{field:"density",type:"quantitative",title:"Density",axis:{labelFontSize:12,titleFontSize:14,labelColor:"#605e5c",titleColor:"#323130",gridColor:"#f3f2f1"}},color:{value:"#0078d4"},tooltip:[{field:"value",type:"quantitative",title:u[0],format:".2f"},{field:"density",type:"quantitative",title:"Density",format:".4f"}]}},"config",{font:"Segoe UI",axis:{labelColor:"#605e5c",titleColor:"#323130",gridColor:"#f3f2f1"}}),e.n=78;break;case 31:if("candlestick"!==m){e.n=33;break}if($e=function(e){return"number"==typeof e?new Date(Math.round(86400*(e-25569)*1e3)):new Date(e)},0!==(Be=g.map(function(e,t){if(!e[u[0]]||null==e[u[1]]||""===e[u[1]]||null==e[u[2]]||""===e[u[2]]||null==e[u[3]]||""===e[u[3]]||null==e[u[4]]||""===e[u[4]])return null;var a=$e(e[u[0]]),n=parseFloat(e[u[1]]),i=parseFloat(e[u[2]]),l=parseFloat(e[u[3]]),o=parseFloat(e[u[4]]);return isNaN(a.getTime())||isNaN(n)||isNaN(i)||isNaN(l)||isNaN(o)?null:{date:a.toISOString(),open:n,high:i,low:l,close:o}}).filter(Boolean)).length){e.n=32;break}return console.warn("No valid candlestick data found"),e.a(2);case 32:Ge=Be.length,Ye=Math.max(500,Math.min(1400,18*Ge)),He=Be.map(function(e){return c(c({},e),{},{dateDisplay:new Date(e.date).toLocaleDateString("en-US",{month:Ge>50?"numeric":"short",day:"numeric",year:Ge>100?void 0:"2-digit"})})}),h=d({$schema:"https://vega.github.io/schema/vega-lite/v6.json",width:Ye,height:400,description:"Candlestick chart V4 from Excel selection",background:"white",padding:{left:10,right:10,top:10,bottom:10},config:{view:{stroke:"transparent"}},data:{values:He},encoding:{x:{field:"dateDisplay",type:"ordinal",title:"Date",axis:{labelAngle:Ge>15?-45:0,labelFontSize:10,titleFontSize:12,labelColor:"#605e5c",titleColor:"#323130",font:"Segoe UI",labelLimit:100,labelOverlap:!1,titlePadding:5,labelPadding:3},scale:{type:"band",paddingInner:.1,paddingOuter:.05}},y:{type:"quantitative",scale:{zero:!1},axis:{title:"Price",labelFontSize:11,titleFontSize:12,labelColor:"#605e5c",titleColor:"#323130",font:"Segoe UI",grid:!0,gridColor:"#f3f2f1",titlePadding:5,labelPadding:3}},color:{condition:{test:"datum.open < datum.close",value:"#06982d"},value:"#ae1325"}},layer:[{mark:{type:"rule",tooltip:!0,strokeWidth:1},encoding:{y:{field:"low"},y2:{field:"high"},tooltip:[{field:"date",type:"temporal",title:"Date",format:"%Y-%m-%d"},{field:"open",type:"quantitative",title:"Open",format:".2f"},{field:"high",type:"quantitative",title:"High",format:".2f"},{field:"low",type:"quantitative",title:"Low",format:".2f"},{field:"close",type:"quantitative",title:"Close",format:".2f"}]}},{mark:{type:"bar",tooltip:!0,stroke:"white",strokeWidth:.5},encoding:{y:{field:"open"},y2:{field:"close"},tooltip:[{field:"date",type:"temporal",title:"Date",format:"%Y-%m-%d"},{field:"open",type:"quantitative",title:"Open",format:".2f"},{field:"high",type:"quantitative",title:"High",format:".2f"},{field:"low",type:"quantitative",title:"Low",format:".2f"},{field:"close",type:"quantitative",title:"Close",format:".2f"}]}}]},"config",{font:"Segoe UI",axis:{labelColor:"#605e5c",titleColor:"#323130",gridColor:"#f3f2f1"}}),e.n=78;break;case 33:if("map"!==m){e.n=34;break}Ke={AFG:4,AGO:24,ALB:8,AND:20,ARE:784,ARG:32,ARM:51,ATA:10,ATG:28,AUS:36,AUT:40,AZE:31,BDI:108,BEL:56,BEN:204,BFA:854,BGD:50,BGR:100,BHR:48,BHS:44,BIH:70,BLR:112,BLZ:84,BOL:68,BRA:76,BRB:52,BRN:96,BTN:64,BWA:72,CAF:140,CAN:124,CHE:756,CHL:152,CHN:156,CIV:384,CMR:120,COD:180,COG:178,COL:170,COM:174,CPV:132,CRI:188,CUB:192,CYP:196,CZE:203,DEU:276,DJI:262,DMA:212,DNK:208,DOM:214,DZA:12,ECU:218,EGY:818,ERI:232,ESH:732,ESP:724,EST:233,ETH:231,FIN:246,FJI:242,FRA:250,FSM:583,GAB:266,GBR:826,GEO:268,GHA:288,GIN:324,GMB:270,GNB:624,GNQ:226,GRC:300,GRD:308,GRL:304,GTM:320,GUY:328,HND:340,HRV:191,HTI:332,HUN:348,IDN:360,IND:356,IRL:372,IRN:364,IRQ:368,ISL:352,ISR:376,ITA:380,JAM:388,JOR:400,JPN:392,KAZ:398,KEN:404,KGZ:417,KHM:116,KIR:296,KNA:659,KOR:410,KWT:414,LAO:418,LBN:422,LBR:430,LBY:434,LCA:662,LIE:438,LKA:144,LSO:426,LTU:440,LUX:442,LVA:428,MAR:504,MCO:492,MDA:498,MDG:450,MDV:462,MEX:484,MHL:584,MKD:807,MLI:466,MLT:470,MMR:104,MNE:499,MNG:496,MOZ:508,MRT:478,MUS:480,MWI:454,MYS:458,NAM:516,NCL:540,NER:562,NGA:566,NIC:558,NLD:528,NOR:578,NPL:524,NRU:520,NZL:554,OMN:512,PAK:586,PAN:591,PER:604,PHL:608,PLW:585,PNG:598,POL:616,PRI:630,PRK:408,PRT:620,PRY:600,PSE:275,QAT:634,ROU:642,RUS:643,RWA:646,SAU:682,SDN:729,SEN:686,SGP:702,SLB:90,SLE:694,SLV:222,SMR:674,SOM:706,SRB:688,SSD:728,STP:678,SUR:740,SVK:703,SVN:705,SWE:752,SWZ:748,SYC:690,SYR:760,TCD:148,TGO:768,THA:764,TJK:762,TKM:795,TLS:626,TON:776,TTO:780,TUN:788,TUR:792,TUV:798,TWN:158,TZA:834,UGA:800,UKR:804,URY:858,USA:840,UZB:860,VAT:336,VCT:670,VEN:862,VNM:704,VUT:548,WSM:882,XKX:383,YEM:887,ZAF:710,ZMB:894,ZWE:716},Xe=p.filter(function(e){return e[0]&&!isNaN(+e[1])}).map(function(e){var t=(e[0]||"").toUpperCase().trim();return{id:Ke[t],iso:t,rate:+e[1]}}).filter(function(e){return e.id}),h={$schema:"https://vega.github.io/schema/vega-lite/v6.json",width:800,height:450,data:{url:"https://cdn.jsdelivr.net/npm/world-atlas@2/countries-110m.json",format:{type:"topojson",feature:"countries"}},transform:[{lookup:"id",from:{data:{values:Xe},key:"id",fields:["rate","iso"]}}],projection:{type:"equalEarth"},mark:{type:"geoshape",stroke:"white",strokeWidth:.5},encoding:{color:{field:"rate",type:"quantitative",scale:{scheme:"blues"}},tooltip:[{field:"iso",type:"nominal",title:"Country (ISO3)"},{field:"rate",type:"quantitative",title:"Value"}]}},e.n=78;break;case 34:if("contour"!==m){e.n=37;break}if(!(u.length<2)){e.n=35;break}return console.error("Contour plot requires at least 2 columns (X values, Y values, optional Categories)"),e.a(2);case 35:if(0!==(Ze=g.filter(function(e){return null!==e[u[0]]&&void 0!==e[u[0]]&&""!==e[u[0]]&&null!==e[u[1]]&&void 0!==e[u[1]]&&""!==e[u[1]]})).length){e.n=36;break}return console.error("No valid data points for contour plot"),e.a(2);case 36:Je=Ze.map(function(e){return parseFloat(e[u[0]])}),Qe=Ze.map(function(e){return parseFloat(e[u[1]])}),et=Math.max.apply(Math,l(Je))-Math.min.apply(Math,l(Je)),tt=Math.max.apply(Math,l(Qe))-Math.min.apply(Math,l(Qe)),at=Math.max(500,Math.min(800,10*et)),nt=Math.max(400,Math.min(600,10*tt)),it=u.length>=3,h={$schema:"https://vega.github.io/schema/vega/v6.json",description:"Contour plot from Excel selection - density estimate overlay",width:at,height:nt,padding:5,autosize:"pad",background:"white",signals:[{name:"bandwidth",value:-1,description:"Bandwidth for density estimation (-1 for auto)"},{name:"resolve",value:"shared",description:"Scale resolution for contours"},{name:"counts",value:!0,description:"Use counts vs density"}],data:[{name:"source",values:Ze,transform:[{type:"filter",expr:"datum['".concat(u[0],"'] != null && datum['").concat(u[1],"'] != null")}]},{name:"density",source:"source",transform:[c(c({type:"kde2d"},it&&{groupby:[u[2]]}),{},{size:[{signal:"width"},{signal:"height"}],x:{expr:"scale('x', datum['".concat(u[0],"'])")},y:{expr:"scale('y', datum['".concat(u[1],"'])")},bandwidth:{signal:"[bandwidth, bandwidth]"},counts:{signal:"counts"}})]},{name:"contours",source:"density",transform:[{type:"isocontour",field:"grid",resolve:{signal:"resolve"},levels:5}]}],scales:[{name:"x",type:"linear",round:!0,nice:!0,zero:!1,domain:{data:"source",field:u[0]},range:"width"},{name:"y",type:"linear",round:!0,nice:!0,zero:!1,domain:{data:"source",field:u[1]},range:"height"}].concat(l(it?[{name:"color",type:"ordinal",domain:{data:"source",field:u[2],sort:{order:"descending"}},range:"category"}]:[{name:"color",type:"ordinal",domain:["Data"],range:["#0078d4"]}])),axes:[{scale:"x",grid:!0,domain:!1,orient:"bottom",tickCount:5,title:u[0],labelFontSize:11,titleFontSize:13,labelFont:"Segoe UI",titleFont:"Segoe UI",labelColor:"#605e5c",titleColor:"#323130",gridColor:"#f3f2f1"},{scale:"y",grid:!0,domain:!1,orient:"left",titlePadding:5,title:u[1],labelFontSize:11,titleFontSize:13,labelFont:"Segoe UI",titleFont:"Segoe UI",labelColor:"#605e5c",titleColor:"#323130",gridColor:"#f3f2f1"}],legends:it?[{stroke:"color",symbolType:"stroke",title:u[2],titleFont:"Segoe UI",titleFontSize:12,titleColor:"#323130",labelFont:"Segoe UI",labelFontSize:11,labelColor:"#605e5c"}]:[],marks:[{name:"points",type:"symbol",from:{data:"source"},encode:{update:{x:{scale:"x",field:u[0]},y:{scale:"y",field:u[1]},size:{value:16},fill:{value:"#cccccc"},fillOpacity:{value:.4},stroke:{value:"#999999"},strokeWidth:{value:.5}}}},{type:"image",from:{data:"density"},encode:{update:{x:{value:0},y:{value:0},width:{signal:"width"},height:{signal:"height"},aspect:{value:!1}}},transform:[{type:"heatmap",field:"datum.grid",resolve:{signal:"resolve"},color:it?{expr:"scale('color', datum.datum['".concat(u[2],"'])")}:{expr:"scale('color', 'Data')"}}]},{type:"path",clip:!0,from:{data:"contours"},encode:{enter:{strokeWidth:{value:1.5},strokeOpacity:{value:.8},stroke:it?{scale:"color",field:u[2]}:{value:"#0078d4"},fill:{value:null}}},transform:[{type:"geopath",field:"datum.contour"}]}],config:{font:"Segoe UI",view:{stroke:"transparent"}}},e.n=78;break;case 37:if("mekko"!==m){e.n=38;break}h={$schema:"https://vega.github.io/schema/vega/v5.json",description:"Mekko chart from Excel selection",width:800,height:500,background:"white",config:{view:{stroke:"transparent"}},view:{stroke:null},padding:{top:60,bottom:80,left:60,right:60},data:[{name:"table",values:g},{name:"categories",source:"table",transform:[{type:"aggregate",fields:[u[2]],ops:["sum"],as:["categoryTotal"],groupby:[u[0]]},{type:"stack",offset:"normalize",sort:{field:"categoryTotal",order:"descending"},field:"categoryTotal",as:["x0","x1"]},{type:"formula",as:"Percent",expr:"datum.x1-datum.x0"},{type:"formula",as:"Label",expr:"datum.".concat(u[0]," + ' (' + format(datum.Percent,'.1%') + ')'")}]},{name:"finalTable",source:"table",transform:[{type:"stack",offset:"normalize",groupby:[u[0]],sort:{field:u[2],order:"descending"},field:u[2],as:["y0","y1"]},{type:"stack",groupby:[u[0]],sort:{field:u[2],order:"descending"},field:u[2],as:["z0","z1"]},{type:"lookup",from:"categories",key:u[0],values:["x0","x1"],fields:[u[0]]},{type:"formula",as:"Percent",expr:"datum.y1-datum.y0"},{type:"formula",as:"Label",expr:"[datum.".concat(u[1],", format(datum.").concat(u[2],", '.0f') + ' (' + format(datum.Percent, '.1%') + ')']")},{type:"window",sort:{field:"y0",order:"ascending"},ops:["row_number"],fields:[null],as:["rank"],groupby:[u[0]]}]}],scales:[{name:"x",type:"linear",range:"width",domain:{data:"finalTable",field:"x1"}},{name:"y",type:"linear",range:"height",nice:!1,zero:!0,domain:{data:"finalTable",field:"z1"}},{name:"opacity",type:"linear",range:[1,.6],domain:{data:"finalTable",field:"rank"}},{name:"color",type:"ordinal",range:{scheme:"category20"},domain:{data:"categories",field:u[0],sort:{field:"x0",order:"ascending",op:"sum"}}}],axes:[{orient:"left",scale:"y",zindex:1,format:"",tickCount:5,tickSize:15,labelColor:{value:"#333740"},labelFontWeight:{value:"normal"},labelFontSize:{value:12},labelFont:{value:"Segoe UI"},offset:5,domain:!1,encode:{labels:{update:{text:{signal:"format(datum.value, '.0f')"}}}}}],marks:[{type:"rect",name:"bars",from:{data:"finalTable"},encode:{update:{x:{scale:"x",field:"x0"},x2:{scale:"x",field:"x1"},y:{scale:"y",field:"z0"},y2:{scale:"y",field:"z1"},fill:{scale:"color",field:u[0]},stroke:{value:"white"},strokeWidth:{value:1},fillOpacity:{scale:"opacity",field:"rank"},tooltip:{signal:"datum"}}}},{type:"text",name:"labels",interactive:!1,from:{data:"bars"},encode:{update:{x:{signal:"(datum.x2 - datum.x)*0.5 + datum.x"},align:{value:"center"},text:{field:"datum.Label"},y:{signal:"(datum.y2 - datum.y)*0.5 + datum.y"},fill:{value:"white"},font:{value:"Segoe UI"},lineHeight:{value:12},fontSize:{value:10},opacity:{signal:"(datum.x2 - datum.x) > 0.05 && (datum.y2 - datum.y) > 20 ? 1 : 0"}}}},{type:"text",name:"categoryLabels",from:{data:"categories"},encode:{update:{x:{scale:"x",signal:"(datum.x1-datum.x0)/2 + datum.x0"},y:{signal:"-15"},text:{field:u[0]},align:{value:"center"},baseline:{value:"bottom"},fill:{value:"#333740"},fontWeight:{value:"bold"},fontSize:{value:12},font:{value:"Segoe UI"}}}},{type:"text",name:"categoryPercentages",from:{data:"categories"},encode:{update:{x:{scale:"x",signal:"(datum.x1-datum.x0)/2 + datum.x0"},y:{signal:"height + 30"},text:{field:"Label"},align:{value:"center"},baseline:{value:"top"},fill:{value:"#666666"},fontWeight:{value:"normal"},fontSize:{value:10},font:{value:"Segoe UI"}}}}]},e.n=78;break;case 38:if("marimekko"!==m){e.n=40;break}if(!(u.length<3)){e.n=39;break}return console.warn("Marimekko chart requires at least 3 columns: Category, Subcategory, Value"),e.a(2);case 39:h={$schema:"https://vega.github.io/schema/vega/v5.json",description:"Marimekko Chart from Excel selection",width:600,height:400,background:"white",config:{view:{stroke:"transparent"}},padding:{top:30,bottom:60,left:60,right:60},data:[{name:"table",values:g,transform:[{type:"formula",as:"Category",expr:"datum['".concat(u[0],"']")},{type:"formula",as:"Subcategory",expr:"datum['".concat(u[1],"']")},{type:"formula",as:"Value",expr:"datum['".concat(u[2],"']")}]},{name:"categories",source:"table",transform:[{type:"aggregate",fields:["Value"],ops:["sum"],as:["categoryTotal"],groupby:["Category"]},{type:"stack",offset:"normalize",sort:{field:"categoryTotal",order:"descending"},field:"categoryTotal",as:["x0","x1"]},{type:"formula",as:"Percent",expr:"datum.x1 - datum.x0"}]},{name:"finalTable",source:"table",transform:[{type:"stack",offset:"normalize",groupby:["Category"],sort:{field:"Value",order:"descending"},field:"Value",as:["y0","y1"]},{type:"lookup",from:"categories",key:"Category",values:["x0","x1"],fields:["Category"]},{type:"formula",as:"Percent",expr:"datum.y1 - datum.y0"}]}],scales:[{name:"x",type:"linear",range:"width",domain:{data:"finalTable",field:"x1"}},{name:"y",type:"linear",range:"height",nice:!1,zero:!0,domain:{data:"finalTable",field:"y1"}},{name:"color",type:"ordinal",range:{scheme:"category10"},domain:{data:"categories",field:"Category",sort:{field:"x0",order:"ascending",op:"sum"}}}],axes:[{orient:"left",scale:"y",format:"%",tickCount:5,labelColor:"#333333",labelFontSize:11,domain:!1},{orient:"bottom",scale:"x",format:"%",tickCount:5,labelColor:"#333333",labelFontSize:11,domain:!1}],marks:[{type:"rect",name:"bars",from:{data:"finalTable"},encode:{update:{x:{scale:"x",field:"x0"},x2:{scale:"x",field:"x1"},y:{scale:"y",field:"y0"},y2:{scale:"y",field:"y1"},fill:{scale:"color",field:"Category"},stroke:{value:"white"},strokeWidth:{value:1},opacity:{value:.8},tooltip:{signal:"{'Category': datum.Category, 'Subcategory': datum.Subcategory, 'Value': datum.Value, 'Percentage': format(datum.Percent, '.1%')}"}},hover:{opacity:{value:1}}}},{type:"text",name:"valueLabels",from:{data:"finalTable"},encode:{update:{x:{scale:"x",signal:"(datum.x1 - datum.x0)/2 + datum.x0"},y:{scale:"y",signal:"(datum.y1 - datum.y0)/2 + datum.y0"},text:{signal:"datum.Percent > 0.027 ? [datum.Subcategory, format(datum.Value, ',.0f') + ' (' + format(datum.Percent, '.0%') + ')'] : []"},align:{value:"center"},baseline:{value:"middle"},fill:{value:"white"},fontSize:{value:10},fontWeight:{value:"normal"},font:{value:"Segoe UI"},lineHeight:{value:12},opacity:{signal:"datum.Percent > 0.027 ? 1 : 0"}}}}]},e.n=78;break;case 40:if("arc"!==m){e.n=41;break}lt=g.map(function(e,t){return{source:e[u[0]],target:e[u[1]],value:u.length>=3&&e[u[2]]?e[u[2]]:1,group:u.length>=4&&e[u[3]]?e[u[3]]:"default"}}),ot=new Map,lt.forEach(function(e){ot.has(e.source)||ot.set(e.source,{name:e.source,group:e.group,index:ot.size}),ot.has(e.target)||ot.set(e.target,{name:e.target,group:e.group,index:ot.size})}),rt=Array.from(ot.values()),st=lt.map(function(e){return{source:ot.get(e.source).index,target:ot.get(e.target).index,value:e.value}}),h=d({$schema:"https://vega.github.io/schema/vega/v5.json",description:"Arc diagram from Excel selection",width:Math.max(600,30*rt.length),height:100,padding:{top:20,bottom:20,left:20,right:20},background:"white",config:{view:{stroke:"transparent"}},data:[{name:"edges",values:st},{name:"sourceDegree",source:"edges",transform:[{type:"aggregate",groupby:["source"],as:["count"]}]},{name:"targetDegree",source:"edges",transform:[{type:"aggregate",groupby:["target"],as:["count"]}]},{name:"nodes",values:rt,transform:[{type:"window",ops:["rank"],as:["order"]},{type:"lookup",from:"sourceDegree",key:"source",fields:["index"],as:["sourceDegree"],default:{count:0}},{type:"lookup",from:"targetDegree",key:"target",fields:["index"],as:["targetDegree"],default:{count:0}},{type:"formula",as:"degree",expr:"(datum.sourceDegree.count || 0) + (datum.targetDegree.count || 0)"}]}],scales:[{name:"position",type:"band",domain:{data:"nodes",field:"order",sort:!0},range:"width"},{name:"color",type:"ordinal",range:{scheme:"category20"},domain:{data:"nodes",field:"group"}}],marks:[{type:"symbol",name:"layout",interactive:!1,from:{data:"nodes"},encode:{enter:{opacity:{value:0}},update:{x:{scale:"position",field:"order"},y:{value:0},size:{field:"degree",mult:8,offset:50},fill:{scale:"color",field:"group"}}}},{type:"path",from:{data:"edges"},encode:{update:{stroke:{value:"#0078d4"},strokeOpacity:{value:.4},strokeWidth:{field:"value",mult:2,offset:1}}},transform:[{type:"lookup",from:"layout",key:"datum.index",fields:["datum.source","datum.target"],as:["sourceNode","targetNode"]},{type:"linkpath",sourceX:{expr:"min(datum.sourceNode.x, datum.targetNode.x)"},targetX:{expr:"max(datum.sourceNode.x, datum.targetNode.x)"},sourceY:{expr:"0"},targetY:{expr:"0"},shape:"arc"}]},{type:"symbol",from:{data:"layout"},encode:{update:{x:{field:"x"},y:{field:"y"},fill:{field:"fill"},size:{field:"size"},stroke:{value:"white"},strokeWidth:{value:1},tooltip:{signal:"{'Node': datum.datum.name, 'Group': datum.datum.group, 'Connections': datum.datum.degree}"}}}},{type:"text",from:{data:"nodes"},encode:{update:{x:{scale:"position",field:"order"},y:{value:25},fontSize:{value:10},align:{value:"center"},baseline:{value:"top"},angle:{value:-45},text:{field:"name"},fill:{value:"#323130"},font:{value:"Segoe UI"}}}}]},"config",{view:{stroke:"transparent"},font:"Segoe UI",text:{font:"Segoe UI",fontSize:10,fill:"#605e5c"}}),e.n=78;break;case 41:if("lollipop"!==m){e.n=42;break}h=d({$schema:"https://vega.github.io/schema/vega-lite/v5.json",description:"Lollipop chart from Excel selection",background:"white",config:{view:{stroke:"transparent"}},data:{values:g},encoding:{y:{field:u[0],type:"nominal",sort:"-x",axis:{domain:!1,title:null,ticks:!1,labelFont:"Segoe UI",labelFontSize:14,labelPadding:10,labelColor:"#605e5c"}},x:{field:u[1],type:"quantitative",axis:{domain:!1,ticks:!1,grid:!0,gridColor:"#e0e0e0",labelFont:"Segoe UI",labelFontSize:12,labelColor:"#605e5c",title:u[1],titleFont:"Segoe UI",titleFontSize:14,titleColor:"#323130"}},color:{value:"#0078d4"}},layer:[{mark:{type:"rule",tooltip:!0,strokeWidth:3,opacity:.7}},{mark:{type:"circle",tooltip:!0,size:300,opacity:.9},encoding:{size:{field:u[1],type:"quantitative",scale:{range:[200,800]},legend:null}}}]},"config",{autosize:{type:"fit",contains:"padding"},view:{stroke:"transparent"},font:"Segoe UI",text:{font:"Segoe UI",fontSize:12,fill:"#605E5C"}}),e.n=78;break;case 42:if("strip"!==m){e.n=43;break}h={$schema:"https://vega.github.io/schema/vega-lite/v6.json",description:"Strip plot showing distribution using tick marks",background:"white",config:{view:{stroke:"transparent"},axis:{labelFontSize:11,titleFontSize:12,labelColor:"#605E5C",titleColor:"#323130"}},data:{values:g},mark:{type:"tick",thickness:2,size:15,color:"#0078d4",opacity:.8,tooltip:!0},encoding:c(c({y:{field:u[0],type:"ordinal",axis:{title:u[0],labelAngle:0}},x:{field:u[1],type:"quantitative",axis:{title:u[1],grid:!0,gridColor:"#f3f2f1",gridOpacity:.5}}},u.length>2&&{color:{field:u[2],type:"nominal",scale:{scheme:"category10"},legend:{title:u[2],orient:"right",titleFontSize:11,labelFontSize:10}}}),{},{tooltip:u.map(function(e){return{field:e,type:"nominal"}})})},e.n=78;break;case 43:if("treemap"!==m){e.n=44;break}u.length>=3?(ct=g.map(function(e,t){return{id:"".concat(e[u[1]],"_").concat(t),name:e[u[1]],parent:e[u[0]]||"root",size:parseFloat(e[u[2]])||0}}),l(new Set(ct.map(function(e){return e.parent}))).forEach(function(e){"root"===e||ct.find(function(t){return t.id===e})||ct.push({id:e,name:e,parent:"root",size:0})}),ct.push({id:"root",name:"Root",parent:"",size:0})):ct=[{id:"root",name:"Root",parent:"",size:0}].concat(l(g.map(function(e,t){return{id:"item_".concat(t),name:e[u[1]],parent:"root",size:parseFloat(e[u[2]])||0}}))),h={$schema:"https://vega.github.io/schema/vega/v5.json",description:"Treemap visualization from Excel data",background:"white",width:600,height:400,padding:5,autosize:"fit",data:[{name:"tree",values:ct,transform:[{type:"stratify",key:"id",parentKey:"parent"},{type:"treemap",field:"size",sort:{field:"value"},round:!0,method:"squarify",ratio:1.6,size:[{signal:"width"},{signal:"height"}]}]},{name:"nodes",source:"tree",transform:[{type:"filter",expr:"datum.children"}]},{name:"leaves",source:"tree",transform:[{type:"filter",expr:"!datum.children"}]}],scales:[{name:"color",type:"ordinal",domain:{data:"nodes",field:"name"},range:["#0078d4","#00bcf2","#40e0d0","#00cc6a","#10893e","#107c10","#bad80a","#ffb900","#ff8c00","#d13438"]},{name:"fontSize",type:"ordinal",domain:[0,1,2,3],range:[20,16,12,10]},{name:"opacity",type:"ordinal",domain:[0,1,2,3],range:[.3,.6,.8,1]}],marks:[{type:"rect",from:{data:"nodes"},interactive:!1,encode:{enter:{fill:{scale:"color",field:"name"},fillOpacity:{scale:"opacity",field:"depth"}},update:{x:{field:"x0"},y:{field:"y0"},x2:{field:"x1"},y2:{field:"y1"},stroke:{value:"#ffffff"},strokeWidth:{value:1}}}},{type:"rect",from:{data:"leaves"},encode:{enter:{stroke:{value:"#ffffff"},strokeWidth:{value:2}},update:{x:{field:"x0"},y:{field:"y0"},x2:{field:"x1"},y2:{field:"y1"},fill:{value:"transparent"},tooltip:{signal:"{'Category': datum.name, 'Value': datum.size, 'Parent': datum.parent}"}},hover:{fill:{value:"#323130"},fillOpacity:{value:.1}}}},{type:"text",from:{data:"leaves"},interactive:!1,encode:{enter:{font:{value:"Segoe UI, Arial, sans-serif"},align:{value:"center"},baseline:{value:"middle"},fill:{value:"#323130"},fontWeight:{value:"bold"},text:{field:"name"},fontSize:{scale:"fontSize",field:"depth"}},update:{x:{signal:"0.5 * (datum.x0 + datum.x1)"},y:{signal:"0.5 * (datum.y0 + datum.y1)"},opacity:{signal:"(datum.x1 - datum.x0) > 50 && (datum.y1 - datum.y0) > 20 ? 1 : 0"}}}}]},e.n=78;break;case 44:if("waffle"!==m){e.n=45;break}h=d({$schema:"https://vega.github.io/schema/vega-lite/v5.json",description:"Waffle chart from Excel selection",background:"white",config:{view:{stroke:"transparent"}},data:{values:g},transform:[{joinaggregate:[{op:"sum",field:u[1],as:"TotalValue"}]},{calculate:"round(datum.".concat(u[1],"/datum.TotalValue * 100)"),as:"PercentOfTotal"},{aggregate:[{op:"min",field:"PercentOfTotal",as:"Percent"}],groupby:[u[0]]},{calculate:"sequence(1,101)",as:"Sequence"},{flatten:["Sequence"]},{calculate:"if(datum.Sequence <= datum.Percent, datum.".concat(u[0],",'_blank')"),as:"Plot"},{calculate:"ceil (datum.Sequence / 10)",as:"row"},{calculate:"datum.Sequence - datum.row * 10",as:"col"}],facet:{column:{field:u[0],header:{labelOrient:"bottom"}}},spec:{layer:[{mark:{type:"circle",filled:!0,tooltip:!0,stroke:"#9e9b9b",strokeWidth:.7},encoding:{x:{field:"col",type:"ordinal",axis:null},y:{field:"row",type:"ordinal",axis:null,sort:"-y"},color:{condition:{test:"datum.Plot == '_blank'",value:"#e6e3e3"},scale:{scheme:"set1"},field:"Plot",type:"nominal",legend:null},size:{value:241},tooltip:[{field:u[0],type:"nominal"}]}},{mark:{type:"text",fontSize:30,fontWeight:"bold"},encoding:{y:{value:30},text:{condition:{test:"datum.Sequence == 1",value:{expr:"datum.Percent + '%'"}}},color:{scale:{scheme:"set1"},field:"Plot"}}}]}},"config",{view:{stroke:"transparent"},font:"Segoe UI",text:{font:"Segoe UI",fontSize:12,fill:"#605E5C"},axis:{ticks:!1,grid:!1,domain:!1,labelColor:"#605E5C",labelFontSize:12},header:{titleFont:"Segoe UI",titleFontSize:16,titleColor:"#757575",labelFont:"Segoe UI",labelFontSize:13,labelColor:"#605E5C"},legend:{titleFont:"Segoe UI",titleFontWeight:"bold",titleColor:"#605E5C",labelFont:"Segoe UI",labelFontSize:13,labelColor:"#605E5C",symbolType:"circle",symbolSize:75}}),e.n=78;break;case 45:if("violin"!==m){e.n=46;break}h={$schema:"https://vega.github.io/schema/vega-lite/v5.20.1.json",description:"Violin chart from Excel selection",background:"white",config:{view:{continuousWidth:300,continuousHeight:300,stroke:null},facet:{spacing:0}},data:{values:g},mark:{type:"area",orient:"horizontal"},encoding:{color:{field:u[0],type:"nominal"},column:{field:u[0],header:{labelOrient:"bottom",labelPadding:0,titleOrient:"bottom"},type:"nominal"},x:{axis:{grid:!1,labels:!1,ticks:!0,values:[0]},field:"density",impute:null,stack:"center",title:null,type:"quantitative"},y:{field:u[1],type:"quantitative"}},transform:[{density:u[1],groupby:[u[0]],as:[u[1],"density"]}],width:100},e.n=78;break;case 46:if("heatmap"!==m){e.n=47;break}h={$schema:"https://vega.github.io/schema/vega-lite/v5.json",description:"Heatmap from Excel selection",background:"white",data:{values:g},mark:{type:"rect",stroke:"white",tooltip:!0},encoding:{y:{field:u[0],type:"ordinal",title:u[0],axis:{domain:!1,ticks:!1,labels:!0,labelAngle:0,labelPadding:5}},x:{field:u[1],type:"ordinal",title:u[1],axis:{domain:!1,ticks:!1,labels:!0,labelAngle:0}},color:{aggregate:"mean",field:u[2],type:"quantitative",legend:{title:null,direction:"vertical",orient:"right",titleAlign:"center",labelAlign:"center"}}},config:{view:{stroke:"transparent"},font:"Segoe UI",text:{font:"Segoe UI",fontSize:12,fill:"#605E5C"},axis:{ticks:!1,grid:!1,domain:!1,labelColor:"#605E5C",labelFontSize:12,titleFontSize:14,titleColor:"#323130"},legend:{titleFont:"Segoe UI",titleFontWeight:"bold",titleColor:"#605E5C",labelFont:"Segoe UI",labelFontSize:12,labelColor:"#605E5C",titleAlign:"center",labelAlign:"center"}}},e.n=78;break;case 47:if("tablebubble"!==m){e.n=48;break}h={$schema:"https://vega.github.io/schema/vega-lite/v5.json",description:"Table Bubble Chart from Excel selection",background:"white",data:{values:g},mark:{type:"circle",opacity:.9,stroke:"transparent",tooltip:!0},encoding:{y:{field:u[0],type:"ordinal",sort:"descending",title:u[0],axis:{domain:!1,ticks:!1,labels:!0,labelAngle:0,labelPadding:5}},x:{field:u[1],type:"ordinal",title:u[1],axis:{domain:!1,ticks:!1,labels:!0,labelAngle:0}},size:{aggregate:"sum",field:u[2],type:"quantitative",legend:{title:u[2],direction:"vertical",orient:"right",titleAlign:"center",labelAlign:"center"}},color:{aggregate:"sum",field:u[2],type:"quantitative",scale:{range:["#2999AA","orange"]},legend:null}},config:{view:{stroke:"transparent"},font:"Segoe UI",text:{font:"Segoe UI",fontSize:12,fill:"#605E5C"},axis:{ticks:!1,grid:!1,domain:!1,labelColor:"#605E5C",labelFontSize:12,titleFontSize:14,titleColor:"#323130"},legend:{titleFont:"Segoe UI",titleFontWeight:"bold",titleColor:"#605E5C",labelFont:"Segoe UI",labelFontSize:12,labelColor:"#605E5C",titleAlign:"center",labelAlign:"center"}}},e.n=78;break;case 48:if("variance"!==m){e.n=50;break}if(!(u.length<3)){e.n=49;break}return console.warn("Variance chart requires 3 columns: Business Unit, First Metric, Second Metric"),e.a(2);case 49:h={$schema:"https://vega.github.io/schema/vega-lite/v5.json",data:{values:g},transform:[{aggregate:[{op:"sum",field:u[1],as:u[1]},{op:"sum",field:u[2],as:u[2]}],groupby:[u[0]]},{calculate:"datum['".concat(u[1],"'] - datum['").concat(u[2],"']"),as:"Variance Absolute"},{calculate:"datum['".concat(u[2],"'] === 0 ? 0 : datum['").concat(u[1],"']/datum['").concat(u[2],"']-1"),as:"Variance Percent"}],hconcat:[{width:350,height:{step:50},view:{stroke:"transparent"},encoding:{color:{type:"nominal",scale:{domain:[u[1],u[2]],range:["#404040","silver"]},legend:{title:null,orient:"top"}},y:{field:u[0],type:"nominal",sort:null,axis:{domain:!1,offset:0,ticks:!1,title:"",labelPadding:35}},x:{type:"quantitative",axis:{domain:!1,labels:!1,title:null,ticks:!1,grid:!0,gridColor:{condition:{test:"datum.value === 0",value:"#605E5C"},value:"transparent"}}}},layer:[{mark:{type:"bar",tooltip:!0,cornerRadius:3,yOffset:12,height:{band:.5}},encoding:{x:{field:u[2]},color:{datum:u[2]}}},{mark:{type:"bar",tooltip:!0,cornerRadius:3,yOffset:0,height:{band:.5}},encoding:{x:{field:u[1]},color:{datum:u[1]}}},{mark:{type:"text",align:{expr:"datum['".concat(u[1],"'] < 0 ? 'right' : 'left'")},dx:{expr:"datum['".concat(u[1],"'] < 0 ? -5 : 5")},color:"black",fontSize:11},encoding:{x:{field:u[1],type:"quantitative"},text:{field:u[1],type:"quantitative",format:","}}}]},{width:150,height:{step:50},view:{stroke:"transparent"},encoding:{y:{field:u[0],type:"nominal",sort:null,axis:null},x:{field:"Variance Absolute",type:"quantitative",axis:{domain:!1,labels:!1,title:null,ticks:!1,grid:!0,gridWidth:1,gridColor:{condition:{test:"datum.value === 0",value:"#605E5C"},value:"transparent"}}}},layer:[{mark:{type:"bar",tooltip:!0,cornerRadius:3,yOffset:0,height:{band:.5}},encoding:{fill:{condition:{test:"datum['Variance Absolute'] < 0",value:"#b92929"},value:"#329351"}}},{mark:{type:"text",align:{expr:"datum['Variance Absolute'] < 0 ? 'right' : 'left'"},dx:{expr:"datum['Variance Absolute'] < 0 ? -5 : 5"}},encoding:{text:{field:"Variance Absolute",type:"quantitative",format:"+,"}}}]},{width:150,height:{step:50},view:{stroke:"transparent"},transform:[{calculate:"datum['".concat(u[2],"'] === 0 ? 'n/m' : format(datum['Variance Percent'], '+.1%')"),as:"PercentDisplay"}],encoding:{y:{field:u[0],type:"nominal",sort:null,axis:null},x:{field:"Variance Percent",type:"quantitative",axis:{domain:!1,labels:!1,title:null,ticks:!1,grid:!0,gridColor:{condition:{test:"datum.value === 0",value:"#605E5C"},value:"transparent"}}}},layer:[{mark:{type:"rule",tooltip:!0},encoding:{strokeWidth:{value:2},stroke:{condition:{test:"datum['Variance Absolute'] < 0",value:"#b92929"},value:"#329351"}}},{mark:{type:"circle",tooltip:!0},encoding:{size:{value:100},color:{condition:{test:"datum['Variance Absolute'] < 0",value:"#b92929"},value:"#329351"}}},{mark:{type:"text",align:{expr:"datum['Variance Absolute'] < 0 ? 'right' : 'left'"},dx:{expr:"datum['Variance Absolute'] < 0 ? -10 : 10"}},encoding:{text:{field:"PercentDisplay",type:"nominal"}}}]}],config:{view:{stroke:"transparent"},padding:{left:5,top:20,right:5,bottom:5},font:"Segoe UI",axis:{labelFontSize:12,labelPadding:10,offset:5,labelFont:"Segoe UI",labelColor:"#252423"},text:{fontSize:12,font:"Segoe UI",color:"#605E5C"},concat:{spacing:50},legend:{labelFontSize:12,labelFont:"Segoe UI",labelColor:"#605E5C"}}},e.n=78;break;case 50:if("deviation"!==m){e.n=51;break}h=d({$schema:"https://vega.github.io/schema/vega-lite/v6.json",description:"Deviation chart from Excel selection",background:"white",config:{view:{stroke:"transparent"}},data:{values:g},layer:[{mark:{type:"line",tooltip:!0,color:"grey"},encoding:{x:{field:u[0],type:"ordinal"},y:{field:u[1],type:"quantitative"}}},{mark:{type:"circle",size:80,color:"grey",tooltip:!0},encoding:{x:{field:u[0],type:"ordinal"},y:{field:u[1],type:"quantitative"}}},{mark:{type:"rule",strokeWidth:2,tooltip:!0},encoding:{x:{field:u[0],type:"ordinal"},y:{field:u[1],type:"quantitative"},y2:{field:u[2]},color:{condition:{test:'datum["'.concat(u[1],'"] < datum["').concat(u[2],'"]'),value:"red"},value:"green"}}},{mark:{type:"circle",size:60,tooltip:!0},encoding:{x:{field:u[0],type:"ordinal"},y:{field:u[2],type:"quantitative"},color:{condition:{test:'datum["'.concat(u[1],'"] < datum["').concat(u[2],'"]'),value:"red"},value:"green"}}}],encoding:{x:{field:u[0],type:"ordinal",axis:{title:null,labelAngle:0}},y:{type:"quantitative",axis:{title:""}}}},"config",{view:{stroke:"transparent"},line:{strokeWidth:3,strokeCap:"round",strokeJoin:"round"},axis:{ticks:!1,grid:!1,domain:!1,labelColor:"#605E5C",labelFontSize:12}}),e.n=78;break;case 51:if("radial"!==m){e.n=52;break}h={$schema:"https://vega.github.io/schema/vega-lite/v6.json",description:"Radial chart from Excel selection",background:"white",config:{view:{stroke:"transparent"},font:"Segoe UI",legend:{titleColor:"#323130",labelColor:"#605e5c"}},data:{values:g},transform:[{window:[{op:"rank",as:"sortOrder"}],sort:[{field:u[1],order:"descending"}]}],layer:[{mark:{type:"arc",innerRadius:20,stroke:"#fff"}},{mark:{type:"text",radiusOffset:10},encoding:{text:{field:u[1],type:"quantitative"}}}],encoding:{theta:{field:u[1],type:"quantitative",stack:!0},radius:{field:u[1],scale:{type:"sqrt",zero:!0,rangeMin:20}},color:{field:u[0],type:"nominal",legend:{title:u[0],titleFontSize:12,labelFontSize:11,orient:"right"}},order:{field:"sortOrder",type:"quantitative"}}},e.n=78;break;case 52:if("circularbar"!==m){e.n=53;break}dt=g.map(function(e,t){var a=360/g.length,n=t*a,i=.7*a;return c(c({},e),{},{theta:n,thetaStart:n-i/2,thetaEnd:n+i/2})}),h={$schema:"https://vega.github.io/schema/vega-lite/v6.json",description:"Circular bar chart from Excel selection",background:"white",config:{view:{stroke:"transparent"},font:"Segoe UI"},data:{values:dt},layer:[{mark:{type:"arc",stroke:"#fff",strokeWidth:2,opacity:.7},encoding:{theta:{field:"thetaStart",type:"quantitative",scale:{domain:[0,360],type:"linear"},stack:null},theta2:{field:"thetaEnd",type:"quantitative"},radius:{field:u[1],type:"quantitative",scale:{type:"linear",zero:!0,rangeMin:20}},radius2:{value:20},color:{field:u[0],type:"nominal",scale:{scheme:"tableau20"},legend:{title:u[0],titleFontSize:12,labelFontSize:11,orient:"right"}},tooltip:[{field:u[0],type:"nominal"},{field:u[1],type:"quantitative"}]}},{mark:{type:"text",radiusOffset:15,fontSize:10},encoding:{theta:{field:"theta",type:"quantitative",scale:{domain:[0,360],type:"linear"}},radius:{field:u[1],type:"quantitative",scale:{type:"linear",zero:!0,rangeMin:20}},text:{field:u[1],type:"quantitative"},color:{value:"#323130"}}}]},e.n=78;break;case 53:if("chord"!==m){e.n=56;break}if(3===u.length){e.n=54;break}return alert("Chord chart requires exactly 3 columns: Source, Destination, Value"),e.a(2);case 54:for(ut=new Set,g.forEach(function(e){ut.add(e[u[0]]),ut.add(e[u[1]])}),ft=Array.from(ut),pt=ft.length,gt={},ft.forEach(function(e,t){gt[e]=t}),mt=Array(pt).fill(0).map(function(){return Array(pt).fill(0)}),g.forEach(function(e){var t=e[u[0]],a=e[u[1]],n=parseFloat(e[u[2]])||0,i=gt[t],l=gt[a];void 0!==i&&void 0!==l&&(mt[i][l]=n)}),ht=new Array(pt).fill(0),yt=0;yt<pt;yt++)for(vt=0;vt<pt;vt++)ht[yt]+=mt[yt][vt],ht[yt]+=mt[vt][yt];if(0!==(bt=ht.reduce(function(e,t){return e+t},0))){e.n=55;break}return alert("All values are zero. Please provide non-zero values."),e.a(2);case 55:for(kt=[],xt=0,St=.02*pt,wt=2*Math.PI-St,zt=0;zt<pt;zt++)Ct=ht[zt]/bt*wt,kt.push({index:zt,label:ft[zt],startAngle:xt,endAngle:xt+Ct,value:ht[zt]}),xt+=Ct+.02;for(Ft=kt.map(function(e){return{start:e.startAngle,end:e.startAngle}}),Et=[],It=270,At=0;At<pt;At++)for(Mt=0;Mt<pt;Mt++)(qt=mt[At][Mt])>0&&(Pt=kt[At],Ut=kt[Mt],Ot=qt/ht[At]*(Pt.endAngle-Pt.startAngle),Rt=Ft[At].end,Dt=Rt+Ot,Ft[At].end=Dt,Nt=qt/ht[Mt]*(Ut.endAngle-Ut.startAngle),jt=Ft[Mt].end,Tt=jt+Nt,Ft[Mt].end=Tt,Wt=It*Math.cos(Rt-Math.PI/2),Vt=It*Math.sin(Rt-Math.PI/2),Lt=It*Math.cos(Dt-Math.PI/2),_t=It*Math.sin(Dt-Math.PI/2),$t=It*Math.cos(jt-Math.PI/2),Bt=It*Math.sin(jt-Math.PI/2),Gt=It*Math.cos(Tt-Math.PI/2),Yt=It*Math.sin(Tt-Math.PI/2),Ht=Dt-Rt>Math.PI?1:0,Kt=Tt-jt>Math.PI?1:0,Xt="M".concat(Wt,",").concat(Vt,"A").concat(It,",").concat(It,",0,").concat(Ht,",1,").concat(Lt,",").concat(_t,"Q0,0,").concat($t,",").concat(Bt,"A").concat(It,",").concat(It,",0,").concat(Kt,",1,").concat(Gt,",").concat(Yt,"Q0,0,").concat(Wt,",").concat(Vt,"Z"),Et.push({path:Xt,source:At,target:Mt,sourceLabel:ft[At],targetLabel:ft[Mt],value:qt}));h={$schema:"https://vega.github.io/schema/vega/v5.json",description:"Chord diagram from Excel data",width:700,height:700,padding:5,background:"white",config:{view:{stroke:"transparent"}},signals:[{name:"originX",value:0},{name:"originY",value:0},{name:"inner_radius",value:270},{name:"outer_radius",value:290}],scales:[{name:"color",type:"ordinal",domain:{data:"chords",field:"index"},range:{scheme:"category10"}}],data:[{name:"chords",values:kt,transform:[{type:"formula",expr:"(((datum.startAngle + datum.endAngle) / 2) * 180 / PI) - 90",as:"angle_degrees"},{type:"formula",expr:"PI * datum.angle_degrees / 180",as:"radians"},{type:"formula",expr:"inrange(datum.angle_degrees, [90, 270])",as:"leftside"},{type:"formula",expr:"originX + outer_radius * cos(datum.radians)",as:"x"},{type:"formula",expr:"originY + outer_radius * sin(datum.radians)",as:"y"}]},{name:"ribbonsPaths",values:Et}],marks:[{type:"arc",from:{data:"chords"},encode:{enter:{fill:{scale:"color",field:"index"},x:{signal:"width / 2"},y:{signal:"height / 2"}},update:{startAngle:{field:"startAngle"},endAngle:{field:"endAngle"},padAngle:{value:0},innerRadius:{signal:"inner_radius"},outerRadius:{signal:"outer_radius"},opacity:{value:.9},tooltip:{signal:"{'Category': datum.label, 'Total Value': format(datum.value, ',.0f')}"}},hover:{opacity:{value:1}}}},{type:"text",from:{data:"chords"},encode:{enter:{text:{field:"label"},fontSize:{value:11},font:{value:"Segoe UI"},fill:{value:"#323130"},fontWeight:{value:"normal"}},update:{x:{signal:"width / 2 + datum.x"},y:{signal:"height / 2 + datum.y"},dx:{signal:"(datum.leftside ? -1 : 1) * 6"},angle:{signal:"datum.leftside ? datum.angle_degrees - 180 : datum.angle_degrees"},align:{signal:"datum.leftside ? 'right' : 'left'"},baseline:{value:"middle"}}}},{type:"path",from:{data:"ribbonsPaths"},encode:{enter:{x:{signal:"width / 2"},y:{signal:"height / 2"}},update:{path:{field:"path"},fill:{scale:"color",field:"source"},opacity:{value:.6},stroke:{value:"white"},strokeWidth:{value:.5},tooltip:{signal:"{'From': datum.sourceLabel, 'To': datum.targetLabel, 'Value': format(datum.value, ',.0f')}"}},hover:{opacity:{value:.8}}}}]},e.n=78;break;case 56:if("bump"!==m){e.n=57;break}Zt=l(new Set(g.map(function(e){return e[u[0]]}))),Jt=Math.max(400,80*Zt.length),h=d({$schema:"https://vega.github.io/schema/vega-lite/v6.json",description:"Bump chart from Excel selection",background:"white",config:{view:{stroke:"transparent"}},data:{values:g},width:Jt,height:200,autosize:{type:"fit",contains:"padding"},padding:{left:10,right:10,top:5,bottom:5},encoding:{x:{field:u[0],type:"nominal",axis:{title:""},scale:{type:"point",padding:.2}},y:{field:u[2],type:"ordinal",axis:!1}},layer:[{mark:{type:"line",interpolate:"monotone"},encoding:{color:{field:u[1],type:"nominal",legend:!1}}},{mark:{type:"circle",size:400,tooltip:!0},encoding:{color:{field:u[1],type:"nominal",legend:!1}}},{mark:{type:"text",color:"white"},encoding:{text:{field:u[2]}}},{transform:[{window:[{op:"rank",as:"rank"}],sort:[{field:u[0],order:"descending"}]},{filter:"datum.rank === 1"}],mark:{type:"text",align:"left",baseline:"middle",dx:15,fontWeight:"bold",fontSize:12},encoding:{text:{field:u[1],type:"nominal"},color:{field:u[1],type:"nominal",legend:!1}}},{transform:[{window:[{op:"rank",as:"rank"}],sort:[{field:u[0],order:"ascending"}]},{filter:"datum.rank === 1"}],mark:{type:"text",align:"right",baseline:"middle",dx:-15,fontWeight:"bold",fontSize:12},encoding:{text:{field:u[1],type:"nominal"},color:{field:u[1],type:"nominal",legend:!1}}}]},"config",{view:{stroke:"transparent"},line:{strokeWidth:3,strokeCap:"round",strokeJoin:"round"},axis:{ticks:!1,grid:!1,domain:!1,labelColor:"#666666",labelFontSize:12}}),e.n=78;break;case 57:if("sankey"!==m){e.n=59;break}if(Qt=g.filter(function(e){return e[u[0]]&&e[u[1]]&&!isNaN(+e[u[2]])}).map(function(e){return{source:String(e[u[0]]).trim(),destination:String(e[u[1]]).trim(),value:+e[u[2]]}}),0!==Qt.length){e.n=58;break}return showError("No valid data found for Sankey chart"),e.a(2);case 58:ea=function(e){var t=new Map,a=new Map,n=new Map,i=new Set;e.forEach(function(e){i.add(e.source),i.add(e.destination),n.has(e.source)||n.set(e.source,[]),n.get(e.source).push(e.destination),a.set(e.destination,(a.get(e.destination)||0)+1)});var l=[];if(i.forEach(function(e){a.has(e)&&0!==a.get(e)||(l.push(e),t.set(e,0))}),0===l.length&&i.size>0){var o=Array.from(i)[0];l.push(o),t.set(o,0)}for(var r=new Set,s=function(){var e=l.shift();if(r.has(e))return 1;r.add(e);var a=t.get(e)||0;(n.get(e)||[]).forEach(function(e){var n=a+1,i=t.get(e);(void 0===i||n>i)&&t.set(e,n),r.has(e)||l.push(e)})};l.length>0;)s();return i.forEach(function(e){t.has(e)||t.set(e,0)}),t},ta=ea(Qt),aa=new Set,Qt.forEach(function(e){aa.add(e.source),aa.add(e.destination)}),na=[],ia=new Map,aa.forEach(function(e){var t=ta.get(e);ia.has(t)||ia.set(t,[]),ia.get(t).push(e)}),la=Array.from(ia.keys()).sort(function(e,t){return e-t}),la.forEach(function(e,t){var a=ia.get(e);a.sort(),a.forEach(function(e,a){var n=t+1;na.push({category:e,stack:n,sort:a+1,labels:0===t?"left":null})})}),oa=[].concat(na,l(Qt)),h={$schema:"https://vega.github.io/schema/vega/v5.json",description:"Sankey diagram",width:800,height:600,padding:{bottom:20,left:80,right:80,top:40},background:"white",signals:[{name:"standardGap",value:14,description:"Gap as a percentage of full domain"},{name:"base",value:"center",description:"How to stack (center or zero)"}],data:[{name:"input",values:oa},{name:"stacks",source:"input",transform:[{type:"filter",expr:"datum.source != null"},{type:"formula",as:"end",expr:"['source','destination']"},{type:"formula",as:"name",expr:"[datum.source, datum.destination]"},{type:"project",fields:["end","name","value"]},{type:"flatten",fields:["end","name"]},{type:"lookup",from:"input",key:"category",values:["stack","sort","gap","labels"],fields:["name"],as:["stack","sort","gap","labels"]},{type:"aggregate",fields:["value","stack","sort","gap","labels"],groupby:["end","name"],ops:["sum","max","max","max","max"],as:["value","stack","sort","gap","labels"]},{type:"aggregate",fields:["value","stack","sort","gap","labels"],groupby:["name"],ops:["max","max","max","max","max"],as:["value","stack","sort","gap","labels"]},{type:"formula",as:"gap",expr:"datum.gap ? datum.gap : 0"}]},{name:"maxValue",source:["stacks"],transform:[{type:"aggregate",fields:["value"],groupby:["stack"],ops:["sum"],as:["value"]},{type:"aggregate",fields:["value"],ops:["max"],as:["value"]}]},{name:"plottedStacks",source:["stacks"],transform:[{type:"formula",as:"spacer",expr:"(data('maxValue')[0].value/100)*(standardGap+datum.gap)"},{type:"formula",as:"type",expr:"['data','spacer']"},{type:"formula",as:"spacedValue",expr:"[datum.value, datum.spacer]"},{type:"flatten",fields:["type","spacedValue"]},{type:"stack",groupby:["stack"],sort:{field:"sort",order:"descending"},field:"spacedValue",offset:{signal:"base"}},{type:"formula",expr:"((datum.value)/2)+datum.y0",as:"yc"}]},{name:"finalTable",source:["plottedStacks"],transform:[{type:"filter",expr:"datum.type == 'data'"}]},{name:"linkTable",source:["input"],transform:[{type:"filter",expr:"datum.source != null"},{type:"lookup",from:"finalTable",key:"name",values:["y0","y1","stack","sort"],fields:["source"],as:["sourceStacky0","sourceStacky1","sourceStack","sourceSort"]},{type:"lookup",from:"finalTable",key:"name",values:["y0","y1","stack","sort"],fields:["destination"],as:["destinationStacky0","destinationStacky1","destinationStack","destinationSort"]},{type:"stack",groupby:["source"],sort:{field:"destinationSort",order:"descending"},field:"value",offset:"zero",as:["syi0","syi1"]},{type:"formula",expr:"datum.syi0+datum.sourceStacky0",as:"sy0"},{type:"formula",expr:"datum.sy0+datum.value",as:"sy1"},{type:"stack",groupby:["destination"],sort:{field:"sourceSort",order:"descending"},field:"value",offset:"zero",as:["dyi0","dyi1"]},{type:"formula",expr:"datum.dyi0+datum.destinationStacky0",as:"dy0"},{type:"formula",expr:"datum.dy0+datum.value",as:"dy1"},{type:"formula",expr:"((datum.value)/2)+datum.sy0",as:"syc"},{type:"formula",expr:"((datum.value)/2)+datum.dy0",as:"dyc"},{type:"linkpath",orient:"horizontal",shape:"diagonal",sourceY:{expr:"scale('y', datum.syc)"},sourceX:{expr:"scale('x', toNumber(datum.sourceStack)) + bandwidth('x')"},targetY:{expr:"scale('y', datum.dyc)"},targetX:{expr:"scale('x', datum.destinationStack)"}},{type:"formula",expr:"range('y')[0]-scale('y', datum.value)",as:"strokeWidth"}]}],scales:[{name:"x",type:"band",range:"width",domain:{data:"finalTable",field:"stack"},paddingInner:.88},{name:"y",type:"linear",range:"height",domain:{data:"finalTable",field:"y1"},reverse:!1},{name:"color",type:"ordinal",range:["#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#aec7e8","#ffbb78","#98df8a","#ff9896","#c5b0d5","#c49c94","#f7b6d2","#c7c7c7","#dbdb8d","#9edae5"],domain:{data:"stacks",field:"name"}}],marks:[{type:"rect",from:{data:"finalTable"},encode:{update:{x:{scale:"x",field:"stack"},width:{scale:"x",band:1},y:{scale:"y",field:"y0"},y2:{scale:"y",field:"y1"},fill:{scale:"color",field:"name"},fillOpacity:{value:.75},strokeWidth:{value:0},stroke:{scale:"color",field:"name"}},hover:{tooltip:{signal:"{'Name': datum.name, 'Value': format(datum.value, ',.2f')}"},fillOpacity:{value:1}}}},{type:"path",name:"links",from:{data:"linkTable"},clip:!0,encode:{update:{strokeWidth:{field:"strokeWidth"},path:{field:"path"},strokeOpacity:{signal:"0.3"},stroke:{field:"destination",scale:"color"}},hover:{strokeOpacity:{value:.8},tooltip:{signal:"{'Source': datum.source, 'Destination': datum.destination, 'Value': format(datum.value, ',.2f')}"}}}},{type:"group",name:"labelText",zindex:1,from:{facet:{data:"finalTable",name:"labelFacet",groupby:["name","stack","yc","value","labels"]}},clip:!1,encode:{update:{x:{signal:"datum.labels=='left' ? scale('x', datum.stack)-8 : scale('x', datum.stack) + bandwidth('x') + 8"},yc:{scale:"y",signal:"datum.yc"},width:{signal:"0"},height:{signal:"0"}}},marks:[{type:"text",name:"heading",from:{data:"labelFacet"},encode:{update:{x:{value:0},y:{value:-2},text:{field:"name"},align:{signal:"datum.labels=='left' ? 'right' : 'left'"},fontWeight:{value:"bold"},fontSize:{value:11}}}},{type:"text",name:"amount",from:{data:"labelFacet"},encode:{update:{x:{value:0},y:{value:12},text:{signal:"format(datum.value, ',.0f')"},align:{signal:"datum.labels=='left' ? 'right' : 'left'"},fontSize:{value:10}}}}]},{type:"rect",from:{data:"labelText"},encode:{update:{x:{field:"bounds.x1",offset:-2},x2:{field:"bounds.x2",offset:2},y:{field:"bounds.y1",offset:-2},y2:{field:"bounds.y2",offset:2},fill:{value:"white"},opacity:{value:.8},cornerRadius:{value:4}}}}],config:{view:{stroke:"transparent"},text:{fontSize:11,fill:"#333333"}}},e.n=78;break;case 59:if("streamgraph"!==m){e.n=61;break}if(!(u.length<3)){e.n=60;break}throw new Error("Streamgraph requires 3 columns: Time/Date, Series/Category, Values");case 60:ra="ordinal",sa=g.map(function(e){var t=c({},e),a=e[u[0]];if("number"==typeof a&&a>25569)t[u[0]]=new Date(86400*(a-25569)*1e3),ra="temporal";else if("string"==typeof a&&a.includes("-")){var n=new Date(a);isNaN(n.getTime())||(t[u[0]]=n,ra="temporal")}return t}),ca="temporal"===ra?{field:u[0],type:"temporal",axis:{domain:!1,format:"%Y-%m",tickSize:0,title:u[0],labelFontSize:11,titleFontSize:12,labelColor:"#605e5c",titleColor:"#323130",labelAngle:-45}}:{field:u[0],type:"ordinal",axis:{domain:!1,tickSize:0,title:u[0],labelFontSize:11,titleFontSize:12,labelColor:"#605e5c",titleColor:"#323130"}},h=d({$schema:"https://vega.github.io/schema/vega-lite/v6.json",width:700,height:400,background:"white",config:{view:{stroke:"transparent"}},description:"Streamgraph from Excel selection",data:{values:sa},mark:{type:"area",tooltip:!0,interpolate:"basis",opacity:.8},encoding:{x:ca,y:{aggregate:"sum",field:u[2],type:"quantitative",axis:null,stack:"center"},color:{field:u[1],type:"nominal",scale:{scheme:"category20b"},legend:{title:u[1],titleFontSize:12,labelFontSize:11,orient:"right"}},tooltip:[{field:u[0],type:"temporal"===ra?"temporal":"ordinal",title:"Period",format:"temporal"===ra?"%Y-%m-%d":void 0},{field:u[1],type:"nominal",title:"Series"},{field:u[2],type:"quantitative",title:"Value",format:",.0f"}]}},"config",{font:"Segoe UI",legend:{titleColor:"#323130",labelColor:"#605e5c"}}),e.n=78;break;case 61:if("ribbon"!==m){e.n=62;break}da=l(new Set(g.map(function(e){return e[u[0]]}))),ua=Math.max(600,100*da.length),h=d({$schema:"https://vega.github.io/schema/vega-lite/v6.json",description:"Ribbon chart from Excel selection",background:"white",width:ua,height:400,config:{view:{stroke:"transparent"}},data:{values:g},layer:[{mark:{type:"area",interpolate:"monotone",tooltip:!0,opacity:.8},encoding:{x:{field:u[0],type:"ordinal",scale:{type:"point",padding:.3},axis:{title:u[0],labelAngle:-45,labelFontSize:12,titleFontSize:14,labelPadding:10,titlePadding:20}},y:{aggregate:"sum",field:u[2],type:"quantitative",axis:{title:u[2],labelFontSize:12,titleFontSize:14,grid:!0,gridOpacity:.3},stack:"center"},color:{field:u[1],type:"nominal",legend:{title:u[1],titleFontSize:12,labelFontSize:11,orient:"right"}},order:{aggregate:"sum",field:u[2],type:"quantitative"}}}]},"config",{view:{stroke:"transparent"},font:"Segoe UI",axis:{ticks:!1,grid:!0,gridColor:"#f0f0f0",gridOpacity:.5,gridWidth:1,domain:!1,labelColor:"#605e5c",titleColor:"#323130"},legend:{titleFont:"Segoe UI",titleFontWeight:"bold",titleColor:"#323130",labelFont:"Segoe UI",labelColor:"#605e5c",symbolType:"circle",symbolSize:75}}),e.n=78;break;case 62:if("ridgeline"!==m){e.n=63;break}h=d({$schema:"https://vega.github.io/schema/vega-lite/v6.json",description:"Ridgeline (Joyplot) chart from Excel selection",background:"white",config:{view:{stroke:"transparent"}},data:{values:g},mark:{type:"area",fillOpacity:.7,strokeOpacity:1,strokeWidth:1,interpolate:"monotone"},width:400,height:20,encoding:{x:{field:u[0],type:"ordinal",title:u[0]},y:{aggregate:"sum",field:u[2],type:"quantitative",scale:{range:[20,-40]},axis:{title:null,values:[0],domain:!1,labels:!1,ticks:!1}},row:{field:u[1],type:"nominal",title:u[1],header:{title:null,labelAngle:0,labelOrient:"left",labelAlign:"left",labelPadding:0},sort:{field:u[0],op:"max",order:"ascending"}},fill:{field:u[1],type:"nominal",legend:null,scale:{scheme:"plasma"}}},resolve:{scale:{y:"independent"}}},"config",{view:{stroke:"transparent"},facet:{spacing:20},header:{labelFontSize:12,labelFontWeight:500,labelAngle:0,labelAnchor:"end",labelOrient:"top",labelPadding:-19},axis:{domain:!1,grid:!1,ticks:!1,tickCount:5,labelFontSize:12,titleFontSize:12,titleFontWeight:400,titleColor:"#605E5C"}}),e.n=78;break;case 63:if("wordcloud"!==m){e.n=64;break}h={$schema:"https://vega.github.io/schema/vega/v5.json",description:"Word cloud from Excel selection",width:800,height:400,padding:0,background:"white",config:{view:{stroke:"transparent"}},data:[{name:"table",values:g,transform:[{type:"countpattern",field:u[0],case:"upper",pattern:"[\\w']{3,}",stopwords:"(i|me|my|myself|we|us|our|ours|ourselves|you|your|yours|yourself|yourselves|he|him|his|himself|she|her|hers|herself|it|its|itself|they|them|their|theirs|themselves|what|which|who|whom|whose|this|that|these|those|am|is|are|was|were|be|been|being|have|has|had|having|do|does|did|doing|will|would|should|can|could|ought|i'm|you're|he's|she's|it's|we're|they're|i've|you've|we've|they've|i'd|you'd|he'd|she'd|we'd|they'd|i'll|you'll|he'll|she'll|we'll|they'll|isn't|aren't|wasn't|weren't|hasn't|haven't|hadn't|doesn't|don't|didn't|won't|wouldn't|shan't|shouldn't|can't|cannot|couldn't|mustn't|let's|that's|who's|what's|here's|there's|when's|where's|why's|how's|a|an|the|and|but|if|or|because|as|until|while|of|at|by|for|with|about|against|between|into|through|during|before|after|above|below|to|from|up|upon|down|in|out|on|off|over|under|again|further|then|once|here|there|when|where|why|how|all|any|both|each|few|more|most|other|some|such|no|nor|not|only|own|same|so|than|too|very|say|says|said|shall)"},{type:"formula",as:"angle",expr:"[-45, 0, 45][~~(random() * 3)]"},{type:"formula",as:"weight",expr:"if(datum.count > 10, 600, 300)"}]}],scales:[{name:"color",type:"ordinal",domain:{data:"table",field:"text"},range:["#d5a928","#652c90","#939597","#2563eb","#dc2626","#059669"]}],marks:[{type:"text",from:{data:"table"},encode:{enter:{text:{field:"text"},align:{value:"center"},baseline:{value:"alphabetic"},fill:{scale:"color",field:"text"}},update:{fillOpacity:{value:1}},hover:{fillOpacity:{value:.5}}},transform:[{type:"wordcloud",size:[800,400],text:{field:"text"},rotate:{field:"datum.angle"},font:"Helvetica Neue, Arial",fontSize:{field:"datum.count"},fontWeight:{field:"datum.weight"},fontSizeRange:[12,56],padding:2}]}]},e.n=78;break;case 64:if("area"!==m){e.n=65;break}h={$schema:"https://vega.github.io/schema/vega-lite/v6.json",description:"Area chart from Excel selection",background:"white",data:{values:g},mark:{type:"area",interpolate:"monotone",tooltip:!0,line:{color:"#3A3D56"},color:{x1:1,y1:1,x2:1,y2:0,gradient:"linear",stops:[{offset:.1,color:"white"},{offset:1,color:"blue"}]}},encoding:c({x:{field:u[0],type:"ordinal",axis:{title:u[0],labelFontSize:12,titleFontSize:14}},y:{field:u[1],type:"quantitative",axis:{title:u[1],labelFontSize:12,titleFontSize:14}}},u.length>=3&&{color:{field:u[2],type:"nominal",legend:{title:u[2],titleFontSize:12,labelFontSize:11}}}),config:{view:{stroke:"transparent"},font:"Segoe UI",axis:{labelColor:"#605e5c",titleColor:"#323130",gridColor:"#f3f2f1"},legend:{titleColor:"#323130",labelColor:"#605e5c"}}},e.n=78;break;case 65:if("bar"!==m){e.n=66;break}fa=u[0],pa=u[1],ga=u.length>=3?u[2]:null,ma={},ga&&g.forEach(function(e){var t=e[fa],a=e[ga];ma[t]||(ma[t]=new Set),ma[t].add(a)}),ha=ga&&Object.values(ma).some(function(e){return e.size>1}),ya={},va=g.map(function(e){var t="".concat(e[fa],"|").concat(ga?e[ga]:"none"),a=ya[t]||0;return ya[t]=a+1,c(c({},e),{},{shadeLevel:a})}),h=d({$schema:"https://vega.github.io/schema/vega-lite/v6.json",description:"Bar chart from Excel selection",background:"white",config:{view:{stroke:"transparent"}},data:{values:va},mark:{type:"bar",tooltip:!0},encoding:c(c({y:{field:fa,type:"nominal",axis:{title:fa,labelFontSize:12,titleFontSize:14}},x:{field:pa,type:"quantitative",axis:{title:pa,labelFontSize:12,titleFontSize:14},stack:"zero"}},ha&&{yOffset:{field:ga}}),ga&&{color:{field:ga,type:"nominal",legend:{title:ga,titleFontSize:12,labelFontSize:11},scale:{scheme:"category10"}},fillOpacity:{field:"shadeLevel",type:"quantitative",scale:{domain:[0,3],range:[1,.5]}}})},"config",{font:"Segoe UI",axis:{labelColor:"#605e5c",titleColor:"#323130",gridColor:"#f3f2f1"},legend:{titleColor:"#323130",labelColor:"#605e5c"}}),e.n=78;break;case 66:if("column"!==m){e.n=67;break}ba=u[0],ka=u[1],xa=u.length>=3?u[2]:null,Sa={},xa&&g.forEach(function(e){var t=e[ba],a=e[xa];Sa[t]||(Sa[t]=new Set),Sa[t].add(a)}),wa=xa&&Object.values(Sa).some(function(e){return e.size>1}),za={},Ca=g.map(function(e){var t="".concat(e[ba],"|").concat(xa?e[xa]:"none"),a=za[t]||0;return za[t]=a+1,c(c({},e),{},{shadeLevel:a})}),h=d({$schema:"https://vega.github.io/schema/vega-lite/v6.json",description:"Column chart from Excel selection",background:"white",config:{view:{stroke:"transparent"}},data:{values:Ca},mark:{type:"bar",tooltip:!0},encoding:c(c({x:{field:ba,type:"nominal",axis:{title:ba,labelFontSize:12,titleFontSize:14}},y:{field:ka,type:"quantitative",axis:{title:ka,labelFontSize:12,titleFontSize:14},stack:"zero"}},wa&&{xOffset:{field:xa}}),xa&&{color:{field:xa,type:"nominal",legend:{title:xa,titleFontSize:12,labelFontSize:11},scale:{scheme:"category10"}},fillOpacity:{field:"shadeLevel",type:"quantitative",scale:{domain:[0,3],range:[1,.5]}}})},"config",{font:"Segoe UI",axis:{labelColor:"#605e5c",titleColor:"#323130",gridColor:"#f3f2f1"},legend:{titleColor:"#323130",labelColor:"#605e5c"}}),e.n=78;break;case 67:if("butterfly"!==m){e.n=69;break}if(!(u.length<3)){e.n=68;break}return console.error("Butterfly chart requires 3 columns (Category, Left Values, Right Values)"),e.a(2);case 68:Fa=Math.max.apply(Math,l(g.map(function(e){return Math.abs(e[u[1]]||0)}))),Ea=Math.max.apply(Math,l(g.map(function(e){return Math.abs(e[u[2]]||0)}))),Ia=Math.max(Fa,Ea),h={$schema:"https://vega.github.io/schema/vega-lite/v6.json",description:"Butterfly chart from Excel selection",background:"white",config:{view:{stroke:null},axis:{grid:!1}},data:{values:g},spacing:0,hconcat:[{transform:[{filter:{field:u[1],valid:!0}}],title:u[1],mark:"bar",encoding:{y:{field:u[0],axis:null,sort:"descending"},x:{aggregate:"sum",field:u[1],title:null,axis:{format:"s"},scale:{domain:[0,Ia]},sort:"descending"},color:{value:"#675193"}}},{width:20,view:{stroke:null},mark:{type:"text",align:"center"},encoding:{y:{field:u[0],type:"ordinal",axis:null,sort:"descending"},text:{field:u[0],type:"nominal"}}},{transform:[{filter:{field:u[2],valid:!0}}],title:u[2],mark:"bar",encoding:{y:{field:u[0],title:null,axis:null,sort:"descending"},x:{aggregate:"sum",field:u[2],title:null,axis:{format:"s"},scale:{domain:[0,Ia]}},color:{value:"#ca8861"}}}]},e.n=78;break;case 69:if("beeswarm"!==m){e.n=71;break}if(!(u.length<2)){e.n=70;break}return showError("Beeswarm chart requires at least 2 columns (Category, Value)"),e.a(2);case 70:Aa=g.map(function(e,t){return{group:e[u[0]],value:parseFloat(e[u[1]])||0,id:t,name:u.length>=3?e[u[2]]:"Item ".concat(t+1)}}),Ma=l(new Set(Aa.map(function(e){return e.group}))),qa=Math.max(600,150*Ma.length),h={$schema:"https://vega.github.io/schema/vega/v5.json",description:"Beeswarm chart using force-directed layout from Excel selection",width:qa,height:300,padding:{left:5,right:5,top:20,bottom:40},autosize:"none",background:"white",signals:[{name:"cx",update:"width / 2"},{name:"cy",update:"height / 2"},{name:"radius",value:6},{name:"collide",value:1},{name:"gravityX",value:.3},{name:"gravityY",value:.2},{name:"static",value:!0}],data:[{name:"people",values:Aa}],scales:[{name:"xscale",type:"band",domain:{data:"people",field:"group",sort:!0},range:"width"},{name:"color",type:"ordinal",domain:{data:"people",field:"group"},range:{scheme:"tableau10"}}],axes:[{orient:"bottom",scale:"xscale",labelAngle:-45,labelAlign:"right",labelBaseline:"middle",labelFont:"Segoe UI",labelFontSize:11,labelColor:"#605e5c",titleFont:"Segoe UI",titleFontSize:12,titleColor:"#323130",domain:!0,domainColor:"#8a8886",ticks:!0,tickColor:"#8a8886"}],marks:[{name:"nodes",type:"symbol",from:{data:"people"},encode:{enter:{fill:{scale:"color",field:"group"},xfocus:{scale:"xscale",field:"group",band:.5},yfocus:{signal:"cy"}},update:{size:{signal:"pow(2 * radius, 2)"},stroke:{value:"white"},strokeWidth:{value:1.5},zindex:{value:0},tooltip:{signal:"{'Name': datum.name, 'Group': datum.group, 'Value': datum.value}"}},hover:{stroke:{value:"#323130"},strokeWidth:{value:3},zindex:{value:1}}},transform:[{type:"force",iterations:300,static:{signal:"static"},forces:[{force:"collide",iterations:{signal:"collide"},radius:{signal:"radius + 1"}},{force:"x",x:"xfocus",strength:{signal:"gravityX"}},{force:"y",y:"yfocus",strength:{signal:"gravityY"}}]}]}],config:{view:{stroke:"transparent"},font:"Segoe UI"}},e.n=78;break;case 71:if("funnel"!==m){e.n=72;break}for(g.sort(function(e,t){return t[u[1]]-e[u[1]]}),Pa=g.reduce(function(e,t){return e+t[u[1]]},0),Ua=g.every(function(e){var t=e[u[1]];return t>=0&&t<=1||t>1&&t<=100&&Number.isInteger(t)}),Oa=g.map(function(e){var t=e[u[1]],a=Ua?(t<=1?(100*t).toFixed(1):t.toFixed(1))+"%":t.toLocaleString();return d(d(d(d({},u[0],e[u[0]]),u[1],t),"percentage",(t/Pa*100).toFixed(1)+"%"),"label",a)}),Ra=g.length,Da=[],Na=0;Na<Ra;Na++)ja=1-Na/(Ra-1)*.6,Ta=Math.round(0+255*(1-ja)),Wa=Math.round(120+135*(1-ja)),Va=Math.round(212+43*(1-ja)),Da.push("rgb(".concat(Ta,", ").concat(Wa,", ").concat(Va,")"));h={$schema:"https://vega.github.io/schema/vega-lite/v5.json",description:"Centered funnel chart",background:"white",width:400,height:250,config:{view:{stroke:"transparent"},font:"Segoe UI"},data:{values:Oa},encoding:{y:{type:"nominal",field:u[0],sort:"-x",axis:{labelFontSize:11,labelColor:"#323130",title:null,labelPadding:5}}},layer:[{mark:{type:"bar",tooltip:!0,orient:"horizontal"},encoding:{x:{field:u[1],type:"quantitative",stack:"center",axis:null},color:{field:u[0],type:"nominal",legend:null,scale:{range:Da}},tooltip:[{field:u[0],type:"nominal",title:"Stage"},{field:u[1],type:"quantitative",title:"Count",format:",.0f"},{field:"percentage",type:"nominal",title:"Percentage"}]}},{mark:{type:"text",align:"left",dx:5,fontSize:12,fontWeight:"nominal",color:"#FF6347"},encoding:{text:{field:"label",type:"nominal"},x:{field:u[1],type:"quantitative",stack:"center",aggregate:null},y:{field:u[0],type:"nominal"}}}]},e.n=78;break;case 72:if("fan"!==m){e.n=77;break}if(5===u.length||7===u.length){e.n=73;break}return console.warn("Fan chart requires exactly 5 or 7 columns of data."),e.a(2);case 73:La=g.map(function(e){var t=d({},u[0],e[u[0]]);return t.actual=e[u[1]]?parseFloat(e[u[1]]):null,t.p50=e[u[2]]?parseFloat(e[u[2]]):null,t.p75_low=e[u[3]]?parseFloat(e[u[3]]):null,t.p75_high=e[u[4]]?parseFloat(e[u[4]]):null,7===u.length?(t.p95_low=e[u[5]]?parseFloat(e[u[5]]):null,t.p95_high=e[u[6]]?parseFloat(e[u[6]]):null):(t.p95_low=null,t.p95_high=null),t}),_a=null,$a=0;case 74:if(!($a<La.length)){e.n=76;break}if(null==La[$a].p75_low&&null==La[$a].p95_low){e.n=75;break}return _a=La[$a][u[0]],e.a(3,76);case 75:$a++,e.n=74;break;case 76:Ba=u[0].toLowerCase().includes("date")||u[0].toLowerCase().includes("time"),Ga={field:u[0],type:Ba?"temporal":"ordinal",title:u[0],sort:La.map(function(e){return e[u[0]]}),axis:{labelAngle:Ba?-45:0,labelFontSize:11,titleFontSize:12,format:"d",values:La.map(function(e){return e[u[0]]})}},Ya={title:"Value",labelFontSize:11,titleFontSize:12,grid:!0,gridColor:"#f3f2f1"},h={$schema:"https://vega.github.io/schema/vega-lite/v6.json",description:"Fan chart with actual and forecast data",width:700,height:400,background:"white",data:{values:La},encoding:{x:Ga},layer:[].concat(l(La.some(function(e){return null!=e.p95_low})?[{transform:[{filter:"datum['".concat(u[0],"'] >= ").concat(_a)}],mark:{type:"area",opacity:.2,color:"steelblue"},encoding:{y:{field:"p95_high",type:"quantitative",axis:Ya},y2:{field:"p95_low",type:"quantitative"}}}]:[]),[{transform:[{filter:"datum['".concat(u[0],"'] >= ").concat(_a)}],mark:{type:"area",opacity:.35,color:"steelblue"},encoding:{y:{field:"p75_high",type:"quantitative",axis:Ya},y2:{field:"p75_low",type:"quantitative"}}},{transform:[{filter:"datum['".concat(u[0],"'] >= ").concat(_a)}],mark:{type:"line",color:"steelblue",strokeDash:[4,2],strokeWidth:2},encoding:{y:{field:"p50",type:"quantitative",axis:Ya}}},{transform:[{filter:_a?"datum['".concat(u[0],"'] <= ").concat(_a):"datum.p75_low == null"}],mark:{type:"line",color:"steelblue",strokeWidth:2},encoding:{y:{field:"actual",type:"quantitative",axis:Ya}}},{transform:[{filter:_a?"datum['".concat(u[0],"'] <= ").concat(_a):"datum.p75_low == null"}],mark:{type:"circle",color:"steelblue",size:50},encoding:{y:{field:"actual",type:"quantitative"},tooltip:[{field:u[0],title:u[0]},{field:"actual",title:"Actual Value",format:".1f"}]}}]),config:{font:"Segoe UI",axis:{labelColor:"#605e5c",titleColor:"#323130"}}},e.n=78;break;case 77:"circlepacking"===m?(Ha=new Map,g.forEach(function(e,t){var a=e[u[0]]||"",n=e[u[1]]||"node_".concat(t),i=u.length>=3&&parseFloat(e[u[2]])||1;if(a&&!Ha.has(a)&&Ha.set(a,{id:a,parent:"",name:a,size:0}),Ha.has(n)){var l=Ha.get(n);l.parent=a,l.size=i}else Ha.set(n,{id:n,parent:a,name:n,size:i})}),Ka=Array.from(Ha.values()),Xa=new Set(Ka.map(function(e){return e.id})),Ka.forEach(function(e){e.parent&&!Xa.has(e.parent)&&(e.parent="")}),Za=Ka.length,Ja=Math.max(500,Math.min(700,20*Za+300)),h={$schema:"https://vega.github.io/schema/vega/v6.json",description:"Circle packing chart from Excel selection",width:Ja,height:Ja,padding:5,autosize:"none",background:"white",data:[{name:"tree",values:Ka,transform:[{type:"stratify",key:"id",parentKey:"parent"},{type:"pack",field:"size",sort:{field:"value"},size:[{signal:"width"},{signal:"height"}]}]}],scales:[{name:"color",type:"ordinal",domain:{data:"tree",field:"depth"},range:{scheme:"category20"}}],marks:[{type:"symbol",from:{data:"tree"},encode:{enter:{shape:{value:"circle"},fill:{scale:"color",field:"depth"},tooltip:{signal:"datum.name + (datum.size ? ', ' + format(datum.size, ',.0f') : '')"}},update:{x:{field:"x"},y:{field:"y"},size:{signal:"4 * datum.r * datum.r"},stroke:{value:"white"},strokeWidth:{value:.5},opacity:{value:.8}},hover:{stroke:{value:"#0078d4"},strokeWidth:{value:2},opacity:{value:1}}}},{type:"text",from:{data:"tree"},encode:{enter:{align:{value:"center"},baseline:{value:"middle"},fill:{value:"#323130"},font:{value:"Segoe UI"},fontWeight:{value:"500"}},update:{x:{field:"x"},y:{field:"y"},text:{signal:"datum.r > 15 ? datum.name : ''"},fontSize:{signal:"datum.r > 30 ? 12 : datum.r > 20 ? 10 : 8"},opacity:{signal:"datum.r > 15 ? 1 : 0"}}}}]}):"heatmap_bar"===m?h=d({$schema:"https://vega.github.io/schema/vega-lite/v5.json",description:"Heatmap with bars from Excel selection",background:"white",config:{view:{stroke:"transparent"}},data:{values:g},spacing:15,bounds:"flush",vconcat:[{height:60,mark:{type:"bar",stroke:null,cornerRadiusEnd:2,tooltip:!0,color:"lightgrey"},encoding:{x:{field:u[1],type:"ordinal",axis:null},y:{field:u[2],aggregate:"mean",type:"quantitative",axis:null}}},{spacing:15,bounds:"flush",hconcat:[{mark:{type:"rect",stroke:"white",tooltip:!0},encoding:{y:{field:u[0],type:"ordinal",title:u[0],axis:{domain:!1,ticks:!1,labels:!0,labelAngle:0,labelPadding:5}},x:{field:u[1],type:"ordinal",title:u[1],axis:{domain:!1,ticks:!1,labels:!0,labelAngle:0}},color:{aggregate:"mean",field:u[2],type:"quantitative",title:u[2],scale:{scheme:"blues"},legend:{direction:"vertical",gradientLength:120}}}},{mark:{type:"bar",stroke:null,cornerRadiusEnd:2,tooltip:!0,color:"lightgrey"},width:60,encoding:{y:{field:u[0],type:"ordinal",axis:null},x:{field:u[2],type:"quantitative",aggregate:"mean",axis:null}}}]}]},"config",{autosize:{type:"fit",contains:"padding"},view:{stroke:"transparent"},font:"Segoe UI",text:{font:"Segoe UI",fontSize:12,fill:"#605E5C"},axis:{ticks:!1,grid:!1,domain:!1,labelColor:"#605E5C",labelFontSize:12,titleFontSize:14,titleColor:"#323130"},legend:{titleFont:"Segoe UI",titleFontWeight:"bold",titleColor:"#605E5C",labelFont:"Segoe UI",labelFontSize:12,labelColor:"#605E5C"}}):"scatter_line"===m?h={$schema:"https://vega.github.io/schema/vega-lite/v6.json",description:"Scatter plot with regression line from Excel selection",background:"white",config:{view:{stroke:"transparent"},font:"Segoe UI",axis:{labelColor:"#605e5c",titleColor:"#323130",gridColor:"#f3f2f1"},legend:{titleColor:"#323130",labelColor:"#605e5c"}},data:{values:g},layer:[{mark:{type:"point",size:100,tooltip:!0},encoding:{x:{field:u[0],type:"quantitative",scale:{zero:!1},axis:{title:u[0],labelFontSize:12,titleFontSize:14}},y:{field:u[1],type:"quantitative",scale:{zero:!1},axis:{title:u[1],labelFontSize:12,titleFontSize:14}}}},{mark:{type:"line",color:"firebrick",strokeWidth:2},transform:[{loess:u[1],on:u[0]}],encoding:{x:{field:u[0],type:"quantitative"},y:{field:u[1],type:"quantitative"}}}]}:"line_rectangle"===m&&(Qa=[],g.forEach(function(e){null!==e[u[1]]&&void 0!==e[u[1]]&&""!==e[u[1]]&&Qa.push(d(d({},u[0],e[u[0]]),"value",parseFloat(e[u[1]])||0))}),en=[],tn=null,an=null,g.forEach(function(e,t){var a=e[u[2]],n=e[u[0]];a&&""!==a?(tn!==a&&(null!==tn&&null!==an&&en.push({start:an,end:g[t-1][u[0]],event:tn}),tn=a,an=n),t===g.length-1&&en.push({start:an,end:n,event:tn})):null!==tn&&null!==an&&(en.push({start:an,end:g[t-1][u[0]],event:tn}),tn=null,an=null)}),h=d({$schema:"https://vega.github.io/schema/vega-lite/v6.json",description:"Line chart with highlighted rectangles",background:"white",config:{view:{stroke:"transparent"}},layer:[{mark:{type:"rect",opacity:.2},data:{values:en},encoding:{x:{field:"start",type:"ordinal"},x2:{field:"end",type:"ordinal"},color:{field:"event",type:"nominal",scale:{scheme:"pastel1"},legend:{title:u[2]||"Highlights",titleFontSize:12,labelFontSize:11}}}},{mark:{type:"line",point:!1,tooltip:!0,strokeWidth:2,color:"#323130"},data:{values:Qa},encoding:{x:{field:u[0],type:"ordinal",axis:{title:u[0],labelFontSize:12,titleFontSize:14,labelAngle:-45,labelAlign:"right"}},y:{field:"value",type:"quantitative",axis:{title:u[1],labelFontSize:12,titleFontSize:14}}}},{mark:{type:"point",filled:!0,size:60,color:"#323130"},data:{values:Qa},encoding:{x:{field:u[0],type:"ordinal",axis:{title:u[0],labelFontSize:12,titleFontSize:14,labelAngle:-45,labelAlign:"right"}},y:{field:"value",type:"quantitative"}}}]},"config",{font:"Segoe UI",axis:{labelColor:"#605e5c",titleColor:"#323130",gridColor:"#f3f2f1"},legend:{titleColor:"#323130",labelColor:"#605e5c"}}));case 78:return(nn=document.createElement("div")).style.display="none",document.body.appendChild(nn),e.n=79,vegaEmbed(nn,h,{actions:!1});case 79:return ln=e.v,on=ln.view,e.n=80,on.toImageURL("png");case 80:return rn=e.v,e.n=81,fetch(rn);case 81:return sn=e.v,e.n=82,sn.blob();case 82:cn=e.v,(dn=new FileReader).onloadend=f(t().m(function e(){var n,i;return t().w(function(e){for(;;)switch(e.n){case 0:return n=dn.result.split(",")[1],(i=o.shapes.addImage(n)).left=r.left,i.top=r.top,i.lockAspectRatio=!0,e.n=1,a.sync();case 1:return e.a(2)}},e)})),dn.readAsDataURL(cn),document.body.removeChild(nn);case 83:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}());case 1:e.n=3;break;case 2:e.p=2,a=e.v,console.error(a);case 3:return e.a(2)}},e,null,[[0,2]])})),g.apply(this,arguments)}Office.onReady(function(){document.getElementById("drawChart").onclick=p})}(),new URL(a(60947),a.b)}();
//# sourceMappingURL=taskpane.js.map