/*! For license information please see taskpane.js.LICENSE.txt */
!function(){"use strict";var t={60947:function(t,e,n){t.exports=n.p+"11147ba7189ccca34fb8.js"}},e={};function n(r){var o=e[r];if(void 0!==o)return o.exports;var a=e[r]={exports:{}};return t[r](a,a.exports,n),a.exports}n.m=t,n.d=function(t,e){for(var r in e)n.o(e,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},function(){var t;n.g.importScripts&&(t=n.g.location+"");var e=n.g.document;if(!t&&e&&(e.currentScript&&"SCRIPT"===e.currentScript.tagName.toUpperCase()&&(t=e.currentScript.src),!t)){var r=e.getElementsByTagName("script");if(r.length)for(var o=r.length-1;o>-1&&(!t||!/^http(s?):/.test(t));)t=r[o--].src}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=t}(),n.b=document.baseURI||self.location.href,function(){function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(){var t,r,o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",i=o.toStringTag||"@@toStringTag";function c(e,o,a,i){var c=o&&o.prototype instanceof l?o:l,s=Object.create(c.prototype);return n(s,"_invoke",function(e,n,o){var a,i,c,l=0,s=o||[],d=!1,f={p:0,n:0,v:t,a:h,f:h.bind(t,4),d:function(e,n){return a=e,i=0,c=t,f.n=n,u}};function h(e,n){for(i=e,c=n,r=0;!d&&l&&!o&&r<s.length;r++){var o,a=s[r],h=f.p,m=a[2];e>3?(o=m===n)&&(c=a[(i=a[4])?5:(i=3,3)],a[4]=a[5]=t):a[0]<=h&&((o=e<2&&h<a[1])?(i=0,f.v=n,f.n=a[1]):h<m&&(o=e<3||a[0]>n||n>m)&&(a[4]=e,a[5]=n,f.n=m,i=0))}if(o||e>1)return u;throw d=!0,n}return function(o,s,m){if(l>1)throw TypeError("Generator is already running");for(d&&1===s&&h(s,m),i=s,c=m;(r=i<2?t:c)||!d;){a||(i?i<3?(i>1&&(f.n=-1),h(i,c)):f.n=c:f.v=c);try{if(l=2,a){if(i||(o="next"),r=a[o]){if(!(r=r.call(a,c)))throw TypeError("iterator result is not an object");if(!r.done)return r;c=r.value,i<2&&(i=0)}else 1===i&&(r=a.return)&&r.call(a),i<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),i=1);a=t}else if((r=(d=f.n<0)?c:e.call(n,f))!==u)break}catch(e){a=t,i=1,c=e}finally{l=1}}return{value:r,done:d}}}(e,a,i),!0),s}var u={};function l(){}function s(){}function d(){}r=Object.getPrototypeOf;var f=[][a]?r(r([][a]())):(n(r={},a,function(){return this}),r),h=d.prototype=l.prototype=Object.create(f);function m(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,n(t,i,"GeneratorFunction")),t.prototype=Object.create(h),t}return s.prototype=d,n(h,"constructor",d),n(d,"constructor",s),s.displayName="GeneratorFunction",n(d,i,"GeneratorFunction"),n(h),n(h,i,"Generator"),n(h,a,function(){return this}),n(h,"toString",function(){return"[object Generator]"}),(e=function(){return{w:c,m:m}})()}function n(t,e,r,o){var a=Object.defineProperty;try{a({},"",{})}catch(t){a=0}n=function(t,e,r,o){function i(e,r){n(t,e,function(t){return this._invoke(e,r,t)})}e?a?a(t,e,{value:r,enumerable:!o,configurable:!o,writable:!o}):t[e]=r:(i("next",0),i("throw",1),i("return",2))},n(t,e,r,o)}function r(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function o(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?r(Object(n),!0).forEach(function(e){a(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function a(e,n,r){return(n=function(e){var n=function(e){if("object"!=t(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=t(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==t(n)?n:n+""}(n))in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}function i(t){return function(t){if(Array.isArray(t))return c(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return c(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?c(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function u(t,e,n,r,o,a,i){try{var c=t[a](i),u=c.value}catch(t){return void n(t)}c.done?e(u):Promise.resolve(u).then(r,o)}function l(t){return function(){var e=this,n=arguments;return new Promise(function(r,o){var a=t.apply(e,n);function i(t){u(a,r,o,i,c,"next",t)}function c(t){u(a,r,o,i,c,"throw",t)}i(void 0)})}}function s(){return d.apply(this,arguments)}function d(){return d=l(e().m(function t(){var n;return e().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,t.n=1,Excel.run(function(){var t=l(e().m(function t(n){var r,o,a,i,c,u,s,d,h,m,p,y,v,g,b;return e().w(function(t){for(;;)switch(t.n){case 0:return r=n.workbook.worksheets.getActiveWorksheet(),(o=n.workbook.getSelectedRange()).load("values, left, top"),t.n=1,n.sync();case 1:if(!((a=o.values).length<2)){t.n=2;break}return console.warn("Need at least header row + one data row"),t.a(2);case 2:return i=a[0],c=a.slice(1),u=c.map(function(t){var e={};return i.forEach(function(n,r){e[n]=t[r]}),e}),s=document.getElementById("chartType").value,d="waterfall"===s?f(u,i):"pie"===s?{$schema:"https://vega.github.io/schema/vega-lite/v6.json",description:"Pie chart from Excel selection",data:{values:u},mark:{type:"arc",outerRadius:120},encoding:{theta:{field:i[1],type:"quantitative"},color:{field:i[0],type:"nominal"}}}:"radial"===s?{$schema:"https://vega.github.io/schema/vega-lite/v6.json",description:"Radial chart from Excel selection",data:{values:u},layer:[{mark:{type:"arc",innerRadius:20,stroke:"#fff"}},{mark:{type:"text",radiusOffset:10},encoding:{text:{field:i[1],type:"quantitative"}}}],encoding:{theta:{field:i[1],type:"quantitative",stack:!0},radius:{field:i[1],scale:{type:"sqrt",zero:!0,rangeMin:20}},color:{field:i[0],type:"nominal",legend:null}}}:"wordcloud"===s?{$schema:"https://vega.github.io/schema/vega/v5.json",description:"Word cloud from Excel selection",width:800,height:400,padding:0,data:[{name:"table",values:u,transform:[{type:"countpattern",field:i[0],case:"upper",pattern:"[\\w']{3,}",stopwords:"(i|me|my|myself|we|us|our|ours|ourselves|you|your|yours|yourself|yourselves|he|him|his|himself|she|her|hers|herself|it|its|itself|they|them|their|theirs|themselves|what|which|who|whom|whose|this|that|these|those|am|is|are|was|were|be|been|being|have|has|had|having|do|does|did|doing|will|would|should|can|could|ought|i'm|you're|he's|she's|it's|we're|they're|i've|you've|we've|they've|i'd|you'd|he'd|she'd|we'd|they'd|i'll|you'll|he'll|she'll|we'll|they'll|isn't|aren't|wasn't|weren't|hasn't|haven't|hadn't|doesn't|don't|didn't|won't|wouldn't|shan't|shouldn't|can't|cannot|couldn't|mustn't|let's|that's|who's|what's|here's|there's|when's|where's|why's|how's|a|an|the|and|but|if|or|because|as|until|while|of|at|by|for|with|about|against|between|into|through|during|before|after|above|below|to|from|up|upon|down|in|out|on|off|over|under|again|further|then|once|here|there|when|where|why|how|all|any|both|each|few|more|most|other|some|such|no|nor|not|only|own|same|so|than|too|very|say|says|said|shall)"},{type:"formula",as:"angle",expr:"[-45, 0, 45][~~(random() * 3)]"},{type:"formula",as:"weight",expr:"if(datum.count > 10, 600, 300)"}]}],scales:[{name:"color",type:"ordinal",domain:{data:"table",field:"text"},range:["#d5a928","#652c90","#939597","#2563eb","#dc2626","#059669"]}],marks:[{type:"text",from:{data:"table"},encode:{enter:{text:{field:"text"},align:{value:"center"},baseline:{value:"alphabetic"},fill:{scale:"color",field:"text"}},update:{fillOpacity:{value:1}},hover:{fillOpacity:{value:.5}}},transform:[{type:"wordcloud",size:[800,400],text:{field:"text"},rotate:{field:"datum.angle"},font:"Helvetica Neue, Arial",fontSize:{field:"datum.count"},fontWeight:{field:"datum.weight"},fontSizeRange:[12,56],padding:2}]}]}:{$schema:"https://vega.github.io/schema/vega-lite/v6.json",description:"Chart from Excel selection",data:{values:u},mark:s,encoding:{x:{field:i[0],type:"quantitative"},y:{field:i[1],type:"quantitative"}}},(h=document.createElement("div")).style.display="none",document.body.appendChild(h),t.n=3,vegaEmbed(h,d,{actions:!1});case 3:return m=t.v,p=m.view,t.n=4,p.toImageURL("png");case 4:return y=t.v,t.n=5,fetch(y);case 5:return v=t.v,t.n=6,v.blob();case 6:g=t.v,(b=new FileReader).onloadend=l(e().m(function t(){var a,i;return e().w(function(t){for(;;)switch(t.n){case 0:return a=b.result.split(",")[1],(i=r.shapes.addImage(a)).left=o.left,i.top=o.top,i.lockAspectRatio=!0,t.n=1,n.sync();case 1:return t.a(2)}},t)})),b.readAsDataURL(g),document.body.removeChild(h);case 7:return t.a(2)}},t)}));return function(e){return t.apply(this,arguments)}}());case 1:t.n=3;break;case 2:t.p=2,n=t.v,console.error(n);case 3:return t.a(2)}},t,null,[[0,2]])})),d.apply(this,arguments)}function f(t,e){var n=e[0],r=e[1],c=t.length,u=Math.max(400,Math.min(1200,70*c)),l=Math.max.apply(Math,i(t.map(function(t){return Math.abs(t[r])}))),s=Math.max(300,Math.min(600,l/100+200)),d=function(t,e,n){var r=i(t);return r.length>0&&(r[r.length-1]=o(o({},r[r.length-1]),{},a({},n,0))),r}(t,0,r);return{$schema:"https://vega.github.io/schema/vega-lite/v6.json",description:"Waterfall chart from Excel selection",data:{values:d},width:u,height:s,transform:[{window:[{op:"sum",field:r,as:"sum"}]},{window:[{op:"lead",field:n,as:"lead"}]},{calculate:"datum.lead === null ? datum.".concat(n," : datum.lead"),as:"lead"},{calculate:"datum.".concat(n," === '").concat(t[t.length-1][n],"' ? 0 : datum.sum - datum.").concat(r),as:"previous_sum"},{calculate:"datum.".concat(n," === '").concat(t[t.length-1][n],"' ? datum.sum : datum.").concat(r),as:"amount"},{calculate:"datum.".concat(n," === '").concat(t[0][n],"' ? datum.").concat(r," / 2 : datum.").concat(n," === '").concat(t[t.length-1][n],"' ? datum.").concat(r," / 2 : (datum.sum + datum.previous_sum) / 2"),as:"center"},{calculate:"datum.".concat(n," === '").concat(t[t.length-1][n],"' ? datum.sum : (datum.").concat(n," !== '").concat(t[0][n],"' && datum.").concat(n," !== '").concat(t[t.length-1][n],"' && datum.").concat(r," > 0 ? '+' : '') + datum.").concat(r),as:"text_amount"},{calculate:"(datum.sum + datum.previous_sum) / 2",as:"center"}],encoding:{x:{field:n,type:"ordinal",sort:null,axis:{labelAngle:0,title:e[0]},scale:{paddingInner:.1,paddingOuter:.05}}},layer:[{mark:{type:"bar",size:60},encoding:{y:{field:"previous_sum",type:"quantitative",title:e[1]},y2:{field:"sum"},color:{condition:[{test:"datum.".concat(n," === '").concat(t[0][n],"' || datum.").concat(n," === '").concat(t[t.length-1][n],"'"),value:"#f7e0b6"},{test:"datum.sum < datum.previous_sum",value:"#f78a64"}],value:"#93c4aa"}}},{mark:{type:"rule",color:"#404040",opacity:1,strokeWidth:2,xOffset:-30,x2Offset:30},encoding:{x2:{field:"lead"},y:{field:"sum",type:"quantitative"}}},{mark:{type:"text",dy:{expr:"datum.amount >= 0 ? -4 : 4"},baseline:{expr:"datum.amount >= 0 ? 'bottom' : 'top'"}},encoding:{y:{field:"sum",type:"quantitative"},text:{field:"sum",type:"nominal"},opacity:{condition:{test:"datum.".concat(n," === '").concat(t[0][n],"' || datum.").concat(n," === '").concat(t[t.length-1][n],"'"),value:0},value:1}}},{mark:{type:"text",fontWeight:"bold",baseline:"middle"},encoding:{y:{field:"center",type:"quantitative"},text:{field:"text_amount",type:"nominal"},color:{condition:[{test:"datum.".concat(n," === '").concat(t[0][n],"' || datum.").concat(n," === '").concat(t[t.length-1][n],"'"),value:"#725a30"}],value:"white"}}}],config:{text:{fontWeight:"bold",color:"#404040"}}}}Office.onReady(function(){document.getElementById("drawChart").onclick=s})}(),new URL(n(60947),n.b)}();
//# sourceMappingURL=taskpane.js.map