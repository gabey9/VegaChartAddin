/*! For license information please see taskpane.js.LICENSE.txt */
!function(){"use strict";var e={60947:function(e,t,a){e.exports=a.p+"d4b56ed3953b80b47ed0.js"}},t={};function a(n){var o=t[n];if(void 0!==o)return o.exports;var i=t[n]={exports:{}};return e[n](i,i.exports,a),i.exports}a.m=e,a.d=function(e,t){for(var n in t)a.o(t,n)&&!a.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},a.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){var e;a.g.importScripts&&(e=a.g.location+"");var t=a.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var n=t.getElementsByTagName("script");if(n.length)for(var o=n.length-1;o>-1&&(!e||!/^http(s?):/.test(e));)e=n[o--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),a.p=e}(),a.b=document.baseURI||self.location.href,function(){function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(){var e,n,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",r=o.toStringTag||"@@toStringTag";function l(t,o,i,r){var l=o&&o.prototype instanceof s?o:s,d=Object.create(l.prototype);return a(d,"_invoke",function(t,a,o){var i,r,l,s=0,d=o||[],u=!1,f={p:0,n:0,v:e,a:g,f:g.bind(e,4),d:function(t,a){return i=t,r=0,l=e,f.n=a,c}};function g(t,a){for(r=t,l=a,n=0;!u&&s&&!o&&n<d.length;n++){var o,i=d[n],g=f.p,m=i[2];t>3?(o=m===a)&&(l=i[(r=i[4])?5:(r=3,3)],i[4]=i[5]=e):i[0]<=g&&((o=t<2&&g<i[1])?(r=0,f.v=a,f.n=i[1]):g<m&&(o=t<3||i[0]>a||a>m)&&(i[4]=t,i[5]=a,f.n=m,r=0))}if(o||t>1)return c;throw u=!0,a}return function(o,d,m){if(s>1)throw TypeError("Generator is already running");for(u&&1===d&&g(d,m),r=d,l=m;(n=r<2?e:l)||!u;){i||(r?r<3?(r>1&&(f.n=-1),g(r,l)):f.n=l:f.v=l);try{if(s=2,i){if(r||(o="next"),n=i[o]){if(!(n=n.call(i,l)))throw TypeError("iterator result is not an object");if(!n.done)return n;l=n.value,r<2&&(r=0)}else 1===r&&(n=i.return)&&n.call(i),r<2&&(l=TypeError("The iterator does not provide a '"+o+"' method"),r=1);i=e}else if((n=(u=f.n<0)?l:t.call(a,f))!==c)break}catch(t){i=e,r=1,l=t}finally{s=1}}return{value:n,done:u}}}(t,i,r),!0),d}var c={};function s(){}function d(){}function u(){}n=Object.getPrototypeOf;var f=[][i]?n(n([][i]())):(a(n={},i,function(){return this}),n),g=u.prototype=s.prototype=Object.create(f);function m(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,u):(e.__proto__=u,a(e,r,"GeneratorFunction")),e.prototype=Object.create(g),e}return d.prototype=u,a(g,"constructor",u),a(u,"constructor",d),d.displayName="GeneratorFunction",a(u,r,"GeneratorFunction"),a(g),a(g,r,"Generator"),a(g,i,function(){return this}),a(g,"toString",function(){return"[object Generator]"}),(t=function(){return{w:l,m:m}})()}function a(e,t,n,o){var i=Object.defineProperty;try{i({},"",{})}catch(e){i=0}a=function(e,t,n,o){function r(t,n){a(e,t,function(e){return this._invoke(t,n,e)})}t?i?i(e,t,{value:n,enumerable:!o,configurable:!o,writable:!o}):e[t]=n:(r("next",0),r("throw",1),r("return",2))},a(e,t,n,o)}function n(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,n)}return a}function o(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?n(Object(a),!0).forEach(function(t){i(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):n(Object(a)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}function i(t,a,n){return(a=function(t){var a=function(t){if("object"!=e(t)||!t)return t;var a=t[Symbol.toPrimitive];if(void 0!==a){var n=a.call(t,"string");if("object"!=e(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==e(a)?a:a+""}(a))in t?Object.defineProperty(t,a,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[a]=n,t}function r(e){return function(e){if(Array.isArray(e))return l(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return l(e,t);var a={}.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?l(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=Array(t);a<t;a++)n[a]=e[a];return n}function c(e,t,a,n,o,i,r){try{var l=e[i](r),c=l.value}catch(e){return void a(e)}l.done?t(c):Promise.resolve(c).then(n,o)}function s(e){return function(){var t=this,a=arguments;return new Promise(function(n,o){var i=e.apply(t,a);function r(e){c(i,n,o,r,l,"next",e)}function l(e){c(i,n,o,r,l,"throw",e)}r(void 0)})}}function d(){return{width:parseInt(document.getElementById("chartWidth").value),height:parseInt(document.getElementById("chartHeight").value),waterfall:{positive:document.getElementById("waterfallPositive").value,negative:document.getElementById("waterfallNegative").value,total:document.getElementById("waterfallTotal").value,connector:document.getElementById("waterfallConnector").value},bar:{color:document.getElementById("barColor").value},line:{color:document.getElementById("lineColor").value,width:parseInt(document.getElementById("lineWidth").value)},point:{color:document.getElementById("pointColor").value,size:parseInt(document.getElementById("pointSize").value)},pie:{radius:parseInt(document.getElementById("pieRadius").value)}}}function u(){return f.apply(this,arguments)}function f(){return f=s(t().m(function e(){var a;return t().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,Excel.run(function(){var e=s(t().m(function e(a){var n,l,c,u,f,g,m,p,y,h,v,b,x,k,w,S,z,E,I,C,O,j,F,P,_;return t().w(function(e){for(;;)switch(e.n){case 0:return n=a.workbook.worksheets.getActiveWorksheet(),(l=a.workbook.getSelectedRange()).load("values, left, top"),e.n=1,a.sync();case 1:if(!((c=l.values).length<2)){e.n=2;break}return console.warn("Need at least header row + one data row"),e.a(2);case 2:return u=c[0],f=c.slice(1),g=f.map(function(e){var t={};return u.forEach(function(a,n){t[a]=e[n]}),t}),m=document.getElementById("chartType").value,p=d(),"waterfall"===m?((h=r(g)).length>0&&(h[h.length-1]=o(o({},h[h.length-1]),{},i({},u[1],0))),v=g.length,Math.max(400,Math.min(1200,70*v)),y=i({$schema:"https://vega.github.io/schema/vega-lite/v6.json",description:"Waterfall chart from Excel selection",background:"transparent",data:{values:h},config:{view:{stroke:"transparent"}},width:p.width,height:p.height,transform:[{window:[{op:"sum",field:u[1],as:"sum"}]},{window:[{op:"lead",field:u[0],as:"lead"}]},{calculate:"datum.lead === null ? datum.".concat(u[0]," : datum.lead"),as:"lead"},{calculate:"datum.".concat(u[0]," === '").concat(g[g.length-1][u[0]],"' ? 0 : datum.sum - datum.").concat(u[1]),as:"previous_sum"},{calculate:"datum.".concat(u[0]," === '").concat(g[g.length-1][u[0]],"' ? datum.sum : datum.").concat(u[1]),as:"amount"},{calculate:"datum.".concat(u[0]," === '").concat(g[0][u[0]],"' ? datum.").concat(u[1]," / 2 : datum.").concat(u[0]," === '").concat(g[g.length-1][u[0]],"' ? datum.").concat(u[1]," / 2 : (datum.sum + datum.previous_sum) / 2"),as:"center"},{calculate:"datum.".concat(u[0]," === '").concat(g[g.length-1][u[0]],"' ? datum.sum : (datum.").concat(u[0]," !== '").concat(g[0][u[0]],"' && datum.").concat(u[0]," !== '").concat(g[g.length-1][u[0]],"' && datum.").concat(u[1]," > 0 ? '+' : '') + datum.").concat(u[1]),as:"text_amount"},{calculate:"(datum.sum + datum.previous_sum) / 2",as:"center"}],encoding:{x:{field:u[0],type:"ordinal",sort:null,axis:{labelAngle:0,title:u[0]},scale:{paddingInner:.1,paddingOuter:.05}}},layer:[{mark:{type:"bar",size:60},encoding:{y:{field:"previous_sum",type:"quantitative",title:u[1]},y2:{field:"sum"},color:{condition:[{test:"datum.".concat(u[0]," === '").concat(g[0][u[0]],"' || datum.").concat(u[0]," === '").concat(g[g.length-1][u[0]],"'"),value:p.waterfall.total},{test:"datum.sum < datum.previous_sum",value:p.waterfall.negative}],value:p.waterfall.positive}}},{mark:{type:"rule",color:p.waterfall.connector,opacity:1,strokeWidth:2,xOffset:-30,x2Offset:30},encoding:{x2:{field:"lead"},y:{field:"sum",type:"quantitative"}}},{mark:{type:"text",dy:{expr:"datum.amount >= 0 ? -4 : 4"},baseline:{expr:"datum.amount >= 0 ? 'bottom' : 'top'"}},encoding:{y:{field:"sum",type:"quantitative"},text:{field:"sum",type:"nominal"},opacity:{condition:{test:"datum.".concat(u[0]," === '").concat(g[0][u[0]],"' || datum.").concat(u[0]," === '").concat(g[g.length-1][u[0]],"'"),value:0},value:1}}},{mark:{type:"text",fontWeight:"bold",baseline:"middle"},encoding:{y:{field:"center",type:"quantitative"},text:{field:"text_amount",type:"nominal"},color:{condition:[{test:"datum.".concat(u[0]," === '").concat(g[0][u[0]],"' || datum.").concat(u[0]," === '").concat(g[g.length-1][u[0]],"'"),value:"#725a30"}],value:"white"}}}]},"config",{text:{fontWeight:"bold",color:"#404040"}})):"bullet"===m?(b=f.map(function(e){return{title:e[0],ranges:[+e[1],+e[2],+e[3]],measures:[+e[4],+e[5]],markers:[+e[6]]}}),y=i({$schema:"https://vega.github.io/schema/vega-lite/v6.json",background:"transparent",config:{view:{stroke:"transparent"}},width:p.width,height:p.height,data:{values:b},facet:{row:{field:"title",type:"ordinal",header:{labelAngle:0,title:"",labelAlign:"left"}}},spacing:10,spec:{encoding:{x:{type:"quantitative",scale:{nice:!1},title:null}},layer:[{mark:{type:"bar",color:"#eee"},encoding:{x:{field:"ranges[2]"}}},{mark:{type:"bar",color:"#ddd"},encoding:{x:{field:"ranges[1]"}}},{mark:{type:"bar",color:"#ccc"},encoding:{x:{field:"ranges[0]"}}},{mark:{type:"bar",color:"lightsteelblue",size:10},encoding:{x:{field:"measures[1]"}}},{mark:{type:"bar",color:"steelblue",size:10},encoding:{x:{field:"measures[0]"}}},{mark:{type:"tick",color:"black"},encoding:{x:{field:"markers[0]"}}}]},resolve:{scale:{x:"independent"}}},"config",{tick:{thickness:2},scale:{barBandPaddingInner:0}})):"pie"===m?y={$schema:"https://vega.github.io/schema/vega-lite/v6.json",background:"transparent",config:{view:{stroke:"transparent"}},description:"Pie chart from Excel selection",data:{values:g},mark:{type:"arc",outerRadius:120},encoding:{theta:{field:u[1],type:"quantitative"},color:{field:u[0],type:"nominal"}}}:"mekko"===m?y={$schema:"https://vega.github.io/schema/vega/v5.json",description:"Marimekko chart from Excel selection",width:800,height:500,background:"transparent",config:{view:{stroke:"transparent"}},view:{stroke:null},padding:{top:60,bottom:80,left:60,right:60},data:[{name:"table",values:g},{name:"categories",source:"table",transform:[{type:"aggregate",fields:[u[2]],ops:["sum"],as:["categoryTotal"],groupby:[u[0]]},{type:"stack",offset:"normalize",sort:{field:"categoryTotal",order:"descending"},field:"categoryTotal",as:["x0","x1"]},{type:"formula",as:"Percent",expr:"datum.x1-datum.x0"},{type:"formula",as:"Label",expr:"datum.".concat(u[0]," + ' (' + format(datum.Percent,'.1%') + ')'")}]},{name:"finalTable",source:"table",transform:[{type:"stack",offset:"normalize",groupby:[u[0]],sort:{field:u[2],order:"descending"},field:u[2],as:["y0","y1"]},{type:"stack",groupby:[u[0]],sort:{field:u[2],order:"descending"},field:u[2],as:["z0","z1"]},{type:"lookup",from:"categories",key:u[0],values:["x0","x1"],fields:[u[0]]},{type:"formula",as:"Percent",expr:"datum.y1-datum.y0"},{type:"formula",as:"Label",expr:"[datum.".concat(u[1],", format(datum.").concat(u[2],", '.0f') + ' (' + format(datum.Percent, '.1%') + ')']")},{type:"window",sort:{field:"y0",order:"ascending"},ops:["row_number"],fields:[null],as:["rank"],groupby:[u[0]]}]}],scales:[{name:"x",type:"linear",range:"width",domain:{data:"finalTable",field:"x1"}},{name:"y",type:"linear",range:"height",nice:!1,zero:!0,domain:{data:"finalTable",field:"z1"}},{name:"opacity",type:"linear",range:[1,.6],domain:{data:"finalTable",field:"rank"}},{name:"color",type:"ordinal",range:{scheme:"category20"},domain:{data:"categories",field:u[0],sort:{field:"x0",order:"ascending",op:"sum"}}}],axes:[{orient:"left",scale:"y",zindex:1,format:"",tickCount:5,tickSize:15,labelColor:{value:"#333740"},labelFontWeight:{value:"normal"},labelFontSize:{value:12},labelFont:{value:"Segoe UI"},offset:5,domain:!1,encode:{labels:{update:{text:{signal:"format(datum.value, '.0f')"}}}}}],marks:[{type:"rect",name:"bars",from:{data:"finalTable"},encode:{update:{x:{scale:"x",field:"x0"},x2:{scale:"x",field:"x1"},y:{scale:"y",field:"z0"},y2:{scale:"y",field:"z1"},fill:{scale:"color",field:u[0]},stroke:{value:"white"},strokeWidth:{value:1},fillOpacity:{scale:"opacity",field:"rank"},tooltip:{signal:"datum"}}}},{type:"text",name:"labels",interactive:!1,from:{data:"bars"},encode:{update:{x:{signal:"(datum.x2 - datum.x)*0.5 + datum.x"},align:{value:"center"},text:{field:"datum.Label"},y:{signal:"(datum.y2 - datum.y)*0.5 + datum.y"},fill:{value:"white"},font:{value:"Segoe UI"},lineHeight:{value:12},fontSize:{value:10},opacity:{signal:"(datum.x2 - datum.x) > 0.05 && (datum.y2 - datum.y) > 20 ? 1 : 0"}}}},{type:"text",name:"categoryLabels",from:{data:"categories"},encode:{update:{x:{scale:"x",signal:"(datum.x1-datum.x0)/2 + datum.x0"},y:{signal:"-15"},text:{field:u[0]},align:{value:"center"},baseline:{value:"bottom"},fill:{value:"#333740"},fontWeight:{value:"bold"},fontSize:{value:12},font:{value:"Segoe UI"}}}},{type:"text",name:"categoryPercentages",from:{data:"categories"},encode:{update:{x:{scale:"x",signal:"(datum.x1-datum.x0)/2 + datum.x0"},y:{signal:"height + 30"},text:{field:"Label"},align:{value:"center"},baseline:{value:"top"},fill:{value:"#666666"},fontWeight:{value:"normal"},fontSize:{value:10},font:{value:"Segoe UI"}}}}]}:"arc"===m?(x=g.map(function(e,t){return{source:e[u[0]],target:e[u[1]],value:u.length>=3&&e[u[2]]?e[u[2]]:1,group:u.length>=4&&e[u[3]]?e[u[3]]:"default"}}),k=new Map,x.forEach(function(e){k.has(e.source)||k.set(e.source,{name:e.source,group:e.group,index:k.size}),k.has(e.target)||k.set(e.target,{name:e.target,group:e.group,index:k.size})}),w=Array.from(k.values()),S=x.map(function(e){return{source:k.get(e.source).index,target:k.get(e.target).index,value:e.value}}),y={$schema:"https://vega.github.io/schema/vega/v5.json",description:"Arc diagram from Excel selection",width:Math.max(600,40*w.length),height:300,padding:{top:20,bottom:80,left:20,right:20},data:[{name:"edges",values:S},{name:"sourceDegree",source:"edges",transform:[{type:"aggregate",groupby:["source"],as:["count"]}]},{name:"targetDegree",source:"edges",transform:[{type:"aggregate",groupby:["target"],as:["count"]}]},{name:"nodes",values:w,transform:[{type:"window",ops:["rank"],as:["order"]},{type:"lookup",from:"sourceDegree",key:"source",fields:["index"],as:["sourceDegree"],default:{count:0}},{type:"lookup",from:"targetDegree",key:"target",fields:["index"],as:["targetDegree"],default:{count:0}},{type:"formula",as:"degree",expr:"(datum.sourceDegree.count || 0) + (datum.targetDegree.count || 0)"}]}],scales:[{name:"position",type:"band",domain:{data:"nodes",field:"order",sort:!0},range:"width"},{name:"color",type:"ordinal",range:{scheme:"category20"},domain:{data:"nodes",field:"group"}}],marks:[{type:"symbol",name:"layout",interactive:!1,from:{data:"nodes"},encode:{enter:{opacity:{value:0}},update:{x:{scale:"position",field:"order"},y:{value:0},size:{field:"degree",mult:8,offset:50},fill:{scale:"color",field:"group"}}}},{type:"path",from:{data:"edges"},encode:{update:{stroke:{value:"#0078d4"},strokeOpacity:{value:.4},strokeWidth:{field:"value",mult:2,offset:1}}},transform:[{type:"lookup",from:"layout",key:"datum.index",fields:["datum.source","datum.target"],as:["sourceNode","targetNode"]},{type:"linkpath",sourceX:{expr:"min(datum.sourceNode.x, datum.targetNode.x)"},targetX:{expr:"max(datum.sourceNode.x, datum.targetNode.x)"},sourceY:{expr:"0"},targetY:{expr:"0"},shape:"arc"}]},{type:"symbol",from:{data:"layout"},encode:{update:{x:{field:"x"},y:{field:"y"},fill:{field:"fill"},size:{field:"size"},stroke:{value:"white"},strokeWidth:{value:1},tooltip:{signal:"{'Node': datum.datum.name, 'Group': datum.datum.group, 'Connections': datum.datum.degree}"}}}},{type:"text",from:{data:"nodes"},encode:{update:{x:{scale:"position",field:"order"},y:{value:25},fontSize:{value:10},align:{value:"center"},baseline:{value:"top"},angle:{value:-45},text:{field:"name"},fill:{value:"#323130"},font:{value:"Segoe UI"}}}}],config:{view:{stroke:"transparent"},font:"Segoe UI",text:{font:"Segoe UI",fontSize:10,fill:"#605e5c"}}}):"lollipop"===m?y=i({$schema:"https://vega.github.io/schema/vega-lite/v5.json",description:"Lollipop chart from Excel selection",background:"transparent",config:{view:{stroke:"transparent"}},data:{values:g},encoding:{y:{field:u[0],type:"nominal",sort:"-x",axis:{domain:!1,title:null,ticks:!1,labelFont:"Segoe UI",labelFontSize:14,labelPadding:10,labelColor:"#605e5c"}},x:{field:u[1],type:"quantitative",axis:{domain:!1,ticks:!1,grid:!0,gridColor:"#e0e0e0",labelFont:"Segoe UI",labelFontSize:12,labelColor:"#605e5c",title:u[1],titleFont:"Segoe UI",titleFontSize:14,titleColor:"#323130"}},color:{value:"#0078d4"}},layer:[{mark:{type:"rule",tooltip:!0,strokeWidth:3,opacity:.7}},{mark:{type:"circle",tooltip:!0,size:300,opacity:.9},encoding:{size:{field:u[1],type:"quantitative",scale:{range:[200,800]},legend:null}}}]},"config",{autosize:{type:"fit",contains:"padding"},view:{stroke:"transparent"},font:"Segoe UI",text:{font:"Segoe UI",fontSize:12,fill:"#605E5C"}}):"waffle"===m?y=i({$schema:"https://vega.github.io/schema/vega-lite/v5.json",description:"Waffle chart from Excel selection",background:"transparent",config:{view:{stroke:"transparent"}},data:{values:g},transform:[{joinaggregate:[{op:"sum",field:u[1],as:"TotalValue"}]},{calculate:"round(datum.".concat(u[1],"/datum.TotalValue * 100)"),as:"PercentOfTotal"},{aggregate:[{op:"min",field:"PercentOfTotal",as:"Percent"}],groupby:[u[0]]},{calculate:"sequence(1,101)",as:"Sequence"},{flatten:["Sequence"]},{calculate:"if(datum.Sequence <= datum.Percent, datum.".concat(u[0],",'_blank')"),as:"Plot"},{calculate:"ceil (datum.Sequence / 10)",as:"row"},{calculate:"datum.Sequence - datum.row * 10",as:"col"}],facet:{column:{field:u[0],header:{labelOrient:"bottom"}}},spec:{layer:[{mark:{type:"circle",filled:!0,tooltip:!0,stroke:"#9e9b9b",strokeWidth:.7},encoding:{x:{field:"col",type:"ordinal",axis:null},y:{field:"row",type:"ordinal",axis:null,sort:"-y"},color:{condition:{test:"datum.Plot == '_blank'",value:"#e6e3e3"},scale:{scheme:"set1"},field:"Plot",type:"nominal",legend:null},size:{value:241},tooltip:[{field:u[0],type:"nominal"}]}},{mark:{type:"text",fontSize:30,fontWeight:"bold"},encoding:{y:{value:30},text:{condition:{test:"datum.Sequence == 1",value:{expr:"datum.Percent + '%'"}}},color:{scale:{scheme:"set1"},field:"Plot"}}}]}},"config",{view:{stroke:"transparent"},font:"Segoe UI",text:{font:"Segoe UI",fontSize:12,fill:"#605E5C"},axis:{ticks:!1,grid:!1,domain:!1,labelColor:"#605E5C",labelFontSize:12},header:{titleFont:"Segoe UI",titleFontSize:16,titleColor:"#757575",labelFont:"Segoe UI",labelFontSize:13,labelColor:"#605E5C"},legend:{titleFont:"Segoe UI",titleFontWeight:"bold",titleColor:"#605E5C",labelFont:"Segoe UI",labelFontSize:13,labelColor:"#605E5C",symbolType:"circle",symbolSize:75}}):"violin"===m?y=i({$schema:"https://vega.github.io/schema/vega-lite/v5.json",description:"Violin chart from Excel selection",background:"transparent",config:{view:{stroke:"transparent"}},data:{values:g},spacing:0,facet:{column:{field:u[0],header:{orient:"bottom",title:null,labelFontSize:14}}},spec:{width:180,height:400,encoding:{y:{field:u[1],type:"quantitative",title:u[1],axis:{tickCount:10,titleFontSize:16,labelFontSize:12}},x:{type:"quantitative",axis:{labels:!1,title:null,grid:!1,ticks:!1}},color:{field:u[0],type:"nominal",legend:null,scale:{scheme:"category10"}}},layer:[{name:"KDE_PLOT",transform:[{density:u[1],groupby:[u[0]],as:["_kde_value","_kde_density"]},{calculate:"datum['_kde_density'] * -1",as:"_negative_kde_density"}],layer:[{name:"KDE_POSITIVE",mark:{type:"area",orient:"vertical",opacity:.6},encoding:{y:{field:"_kde_value"},x:{field:"_kde_density"}}},{name:"KDE_NEGATIVE",mark:{type:"area",orient:"vertical",opacity:.6},encoding:{y:{field:"_kde_value"},x:{field:"_negative_kde_density"}}}],encoding:{x2:{datum:0}}},{name:"BOX_PLOT",mark:{type:"boxplot",extent:"min-max",median:{color:"black",strokeWidth:2},size:20},encoding:{y:{field:u[1]},fill:{value:"#969696"},stroke:{value:"black"}}}]}},"config",{view:{stroke:"transparent"},font:"Segoe UI",text:{font:"Segoe UI",fontSize:12,fill:"#605E5C"},axis:{ticks:!1,grid:!0,gridColor:"#e0e0e0",domain:!1,labelColor:"#605E5C",labelFontSize:12},header:{titleFont:"Segoe UI",titleFontSize:16,titleColor:"#757575",labelFont:"Segoe UI",labelFontSize:13,labelColor:"#605E5C"}}):"heatmap"===m?y=i({$schema:"https://vega.github.io/schema/vega-lite/v5.json",description:"Heatmap with marginal bars from Excel selection",background:"transparent",config:{view:{stroke:"transparent"}},data:{values:g},spacing:15,bounds:"flush",vconcat:[{height:60,mark:{type:"bar",stroke:null,cornerRadiusEnd:2,tooltip:!0,color:"lightgrey"},encoding:{x:{field:u[1],type:"ordinal",axis:null},y:{field:u[2],aggregate:"mean",type:"quantitative",axis:null}}},{spacing:15,bounds:"flush",hconcat:[{mark:{type:"rect",stroke:"white",tooltip:!0},encoding:{y:{field:u[0],type:"ordinal",title:u[0],axis:{domain:!1,ticks:!1,labels:!0,labelAngle:0,labelPadding:5}},x:{field:u[1],type:"ordinal",title:u[1],axis:{domain:!1,ticks:!1,labels:!0,labelAngle:0}},color:{aggregate:"mean",field:u[2],type:"quantitative",title:u[2],scale:{scheme:"blues"},legend:{direction:"vertical",gradientLength:120}}}},{mark:{type:"bar",stroke:null,cornerRadiusEnd:2,tooltip:!0,color:"lightgrey"},width:60,encoding:{y:{field:u[0],type:"ordinal",axis:null},x:{field:u[2],type:"quantitative",aggregate:"mean",axis:null}}}]}]},"config",{autosize:{type:"fit",contains:"padding"},view:{stroke:"transparent"},font:"Segoe UI",text:{font:"Segoe UI",fontSize:12,fill:"#605E5C"},axis:{ticks:!1,grid:!1,domain:!1,labelColor:"#605E5C",labelFontSize:12,titleFontSize:14,titleColor:"#323130"},legend:{titleFont:"Segoe UI",titleFontWeight:"bold",titleColor:"#605E5C",labelFont:"Segoe UI",labelFontSize:12,labelColor:"#605E5C"}}):"deviation"===m?y=i({$schema:"https://vega.github.io/schema/vega-lite/v6.json",description:"Deviation chart from Excel selection",background:"transparent",config:{view:{stroke:"transparent"}},data:{values:g},layer:[{mark:{type:"line",tooltip:!0,color:"grey"},encoding:{x:{field:u[0],type:"ordinal"},y:{field:u[1],type:"quantitative"}}},{mark:{type:"circle",size:80,color:"grey",tooltip:!0},encoding:{x:{field:u[0],type:"ordinal"},y:{field:u[1],type:"quantitative"}}},{mark:{type:"rule",strokeWidth:2,tooltip:!0},encoding:{x:{field:u[0],type:"ordinal"},y:{field:u[1],type:"quantitative"},y2:{field:u[2]},color:{condition:{test:'datum["'.concat(u[1],'"] < datum["').concat(u[2],'"]'),value:"red"},value:"green"}}},{mark:{type:"circle",size:60,tooltip:!0},encoding:{x:{field:u[0],type:"ordinal"},y:{field:u[2],type:"quantitative"},color:{condition:{test:'datum["'.concat(u[1],'"] < datum["').concat(u[2],'"]'),value:"red"},value:"green"}}}],encoding:{x:{field:u[0],type:"ordinal",axis:null},y:{type:"quantitative",axis:{title:""}}}},"config",{view:{stroke:"transparent"},line:{strokeWidth:3,strokeCap:"round",strokeJoin:"round"},axis:{ticks:!1,grid:!1,domain:!1,labelColor:"#605E5C",labelFontSize:12}}):"radial"===m?y={$schema:"https://vega.github.io/schema/vega-lite/v6.json",description:"Radial chart from Excel selection",background:"transparent",config:{view:{stroke:"transparent"}},data:{values:g},layer:[{mark:{type:"arc",innerRadius:20,stroke:"#fff"}},{mark:{type:"text",radiusOffset:10},encoding:{text:{field:u[1],type:"quantitative"}}}],encoding:{theta:{field:u[1],type:"quantitative",stack:!0},radius:{field:u[1],scale:{type:"sqrt",zero:!0,rangeMin:20}},color:{field:u[0],type:"nominal",legend:null}}}:"bump"===m?(z=r(new Set(g.map(function(e){return e[u[0]]}))),E=Math.max(400,80*z.length),y=i({$schema:"https://vega.github.io/schema/vega-lite/v6.json",description:"Bump chart from Excel selection",background:"transparent",config:{view:{stroke:"transparent"}},data:{values:g},width:E,height:200,encoding:{x:{field:u[0],type:"nominal",axis:{title:""},scale:{type:"point",padding:1}},y:{field:u[2],type:"ordinal",axis:!1}},layer:[{mark:{type:"line",interpolate:"monotone"},encoding:{color:{field:u[1],type:"nominal",legend:!1}}},{mark:{type:"circle",size:400,tooltip:!0},encoding:{color:{field:u[1],type:"nominal",legend:!1}}},{mark:{type:"text",color:"white"},encoding:{text:{field:u[2]}}},{transform:[{window:[{op:"rank",as:"rank"}],sort:[{field:u[0],order:"descending"}]},{filter:"datum.rank === 1"}],mark:{type:"text",align:"left",baseline:"middle",dx:15,fontWeight:"bold",fontSize:12},encoding:{text:{field:u[1],type:"nominal"},color:{field:u[1],type:"nominal",legend:!1}}},{transform:[{window:[{op:"rank",as:"rank"}],sort:[{field:u[0],order:"ascending"}]},{filter:"datum.rank === 1"}],mark:{type:"text",align:"right",baseline:"middle",dx:-15,fontWeight:"bold",fontSize:12},encoding:{text:{field:u[1],type:"nominal"},color:{field:u[1],type:"nominal",legend:!1}}}]},"config",{view:{stroke:"transparent"},line:{strokeWidth:3,strokeCap:"round",strokeJoin:"round"},axis:{ticks:!1,grid:!1,domain:!1,labelColor:"#666666",labelFontSize:12}})):y="ribbon"===m?i({$schema:"https://vega.github.io/schema/vega-lite/v6.json",description:"Ribbon chart from Excel selection",background:"transparent",config:{view:{stroke:"transparent"}},data:{values:g},layer:[{mark:{type:"area",interpolate:"monotone",tooltip:!0},encoding:{x:{field:u[0],type:"ordinal"},y:{aggregate:"sum",field:u[2],type:"quantitative",axis:null,stack:"center"},color:{field:u[1],type:"nominal"},order:{aggregate:"sum",field:u[2],type:"quantitative"}}}]},"config",{view:{stroke:"transparent"},axis:{ticks:!1,grid:!0,gridColor:"white",gridWidth:3,domain:!1,labelColor:"#666666"},legend:{titleFont:"Segoe UI",titleFontWeight:"bold",titleColor:"#666666",labelFont:"Segoe UI",labelColor:"#666666",symbolType:"circle",symbolSize:75}}):"ridgeline"===m?i({$schema:"https://vega.github.io/schema/vega-lite/v6.json",description:"Ridgeline (Joyplot) chart from Excel selection",background:"transparent",config:{view:{stroke:"transparent"}},data:{values:g},mark:{type:"area",fillOpacity:.7,strokeOpacity:1,strokeWidth:1,interpolate:"monotone"},width:400,height:20,encoding:{x:{field:u[0],type:"ordinal",title:u[0]},y:{aggregate:"sum",field:u[2],type:"quantitative",scale:{range:[20,-40]},axis:{title:null,values:[0],domain:!1,labels:!1,ticks:!1}},row:{field:u[1],type:"nominal",title:u[1],header:{title:null,labelAngle:0,labelOrient:"left",labelAlign:"left",labelPadding:0},sort:{field:u[0],op:"max",order:"ascending"}},fill:{field:u[1],type:"nominal",legend:null,scale:{scheme:"plasma"}}},resolve:{scale:{y:"independent"}}},"config",{view:{stroke:"transparent"},facet:{spacing:20},header:{labelFontSize:12,labelFontWeight:500,labelAngle:0,labelAnchor:"end",labelOrient:"top",labelPadding:-19},axis:{domain:!1,grid:!1,ticks:!1,tickCount:5,labelFontSize:12,titleFontSize:12,titleFontWeight:400,titleColor:"#605E5C"}}):"wordcloud"===m?{$schema:"https://vega.github.io/schema/vega/v5.json",description:"Word cloud from Excel selection",width:800,height:400,padding:0,data:[{name:"table",values:g,transform:[{type:"countpattern",field:u[0],case:"upper",pattern:"[\\w']{3,}",stopwords:"(i|me|my|myself|we|us|our|ours|ourselves|you|your|yours|yourself|yourselves|he|him|his|himself|she|her|hers|herself|it|its|itself|they|them|their|theirs|themselves|what|which|who|whom|whose|this|that|these|those|am|is|are|was|were|be|been|being|have|has|had|having|do|does|did|doing|will|would|should|can|could|ought|i'm|you're|he's|she's|it's|we're|they're|i've|you've|we've|they've|i'd|you'd|he'd|she'd|we'd|they'd|i'll|you'll|he'll|she'll|we'll|they'll|isn't|aren't|wasn't|weren't|hasn't|haven't|hadn't|doesn't|don't|didn't|won't|wouldn't|shan't|shouldn't|can't|cannot|couldn't|mustn't|let's|that's|who's|what's|here's|there's|when's|where's|why's|how's|a|an|the|and|but|if|or|because|as|until|while|of|at|by|for|with|about|against|between|into|through|during|before|after|above|below|to|from|up|upon|down|in|out|on|off|over|under|again|further|then|once|here|there|when|where|why|how|all|any|both|each|few|more|most|other|some|such|no|nor|not|only|own|same|so|than|too|very|say|says|said|shall)"},{type:"formula",as:"angle",expr:"[-45, 0, 45][~~(random() * 3)]"},{type:"formula",as:"weight",expr:"if(datum.count > 10, 600, 300)"}]}],scales:[{name:"color",type:"ordinal",domain:{data:"table",field:"text"},range:["#d5a928","#652c90","#939597","#2563eb","#dc2626","#059669"]}],marks:[{type:"text",from:{data:"table"},encode:{enter:{text:{field:"text"},align:{value:"center"},baseline:{value:"alphabetic"},fill:{scale:"color",field:"text"}},update:{fillOpacity:{value:1}},hover:{fillOpacity:{value:.5}}},transform:[{type:"wordcloud",size:[800,400],text:{field:"text"},rotate:{field:"datum.angle"},font:"Helvetica Neue, Arial",fontSize:{field:"datum.count"},fontWeight:{field:"datum.weight"},fontSizeRange:[12,56],padding:2}]}]}:{$schema:"https://vega.github.io/schema/vega-lite/v6.json",description:"Chart from Excel selection",background:"transparent",config:{view:{stroke:"transparent"}},data:{values:g},mark:m,encoding:{x:{field:u[0],type:"quantitative"},y:{field:u[1],type:"quantitative"}}},(I=document.createElement("div")).style.display="none",document.body.appendChild(I),e.n=3,vegaEmbed(I,y,{actions:!1});case 3:return C=e.v,O=C.view,e.n=4,O.toImageURL("png");case 4:return j=e.v,e.n=5,fetch(j);case 5:return F=e.v,e.n=6,F.blob();case 6:P=e.v,(_=new FileReader).onloadend=s(t().m(function e(){var o,i;return t().w(function(e){for(;;)switch(e.n){case 0:return o=_.result.split(",")[1],(i=n.shapes.addImage(o)).left=l.left,i.top=l.top,i.lockAspectRatio=!0,e.n=1,a.sync();case 1:return e.a(2)}},e)})),_.readAsDataURL(P),document.body.removeChild(I);case 7:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}());case 1:e.n=3;break;case 2:e.p=2,a=e.v,console.error(a);case 3:return e.a(2)}},e,null,[[0,2]])})),f.apply(this,arguments)}Office.onReady(function(){document.getElementById("drawChart").onclick=u})}(),new URL(a(60947),a.b)}();
//# sourceMappingURL=taskpane.js.map