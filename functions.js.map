{"version":3,"file":"functions.js","mappings":"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CP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,GACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IA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","sources":["webpack://excel-custom-functions-js/./src/functions/functions.js"],"sourcesContent":["/**\n * LINE custom function\n * Creates a multi-series line chart from Excel data range\n * \n * @customfunction\n * @requiresAddress\n * @param {any[][]} data The data range including headers\n * @param {CustomFunctions.Invocation} invocation Invocation object\n * @returns {string} Status message\n */\nfunction LINE(data, invocation) {\n  return new Promise((resolve) => {\n    try {\n      if (!data || data.length < 2) {\n        resolve(\"Error: Need at least header row + one data row\");\n        return;\n      }\n\n      const headers = data[0];\n      const rows = data.slice(1);\n\n      // Convert rows -> objects (same as taskpane.js)\n      const processedData = rows.map(row => {\n        let obj = {};\n        headers.forEach((h, i) => {\n          obj[h] = row[i];\n        });\n        return obj;\n      });\n\n      // Transform data for multi-series line chart (exact copy from taskpane.js)\n      const transformedData = [];\n      const valueColumns = headers.slice(1);\n      processedData.forEach(row => {\n        valueColumns.forEach(colName => {\n          if (row[colName] !== null && row[colName] !== undefined && row[colName] !== \"\") {\n            transformedData.push({\n              [headers[0]]: row[headers[0]], // x-axis value (first column)\n              series: colName,               // series name (column header)\n              value: parseFloat(row[colName]) || 0  // y-axis value\n            });\n          }\n        });\n      });\n\n      // Use EXACT specification from taskpane.js line chart\n      const spec = {\n        $schema: \"https://vega.github.io/schema/vega-lite/v6.json\",\n        description: \"Multi-series line chart from Excel selection\",\n        background: \"white\",\n        config: { view: { stroke: \"transparent\" }},\n        data: { values: transformedData },\n        mark: { \n          type: \"line\", \n          point: false,\n          tooltip: true,\n          strokeWidth: 2\n        },\n        encoding: {\n          x: { \n            field: headers[0], \n            type: \"ordinal\",\n            axis: {\n              title: headers[0],\n              labelFontSize: 12,\n              titleFontSize: 14,\n              labelAngle: 0\n            }\n          },\n          y: { \n            field: \"value\", \n            type: \"quantitative\",\n            axis: {\n              title: \"Value\",\n              labelFontSize: 12,\n              titleFontSize: 14\n            }\n          },\n          color: { \n            field: \"series\", \n            type: \"nominal\",\n            scale: {\n              scheme: \"category10\"\n            },\n            legend: {\n              title: \"Series\",\n              titleFontSize: 12,\n              labelFontSize: 11\n            }\n          }\n        },\n        config: {\n          font: \"Segoe UI\",\n          axis: {\n            labelColor: \"#605e5c\",\n            titleColor: \"#323130\",\n            gridColor: \"#f3f2f1\"\n          },\n          legend: {\n            titleColor: \"#323130\",\n            labelColor: \"#605e5c\"\n          },\n          point: {\n            size: 60,\n            filled: true\n          }\n        }\n      };\n      const chartId = `line_${invocation.address.replace(/[^A-Za-z0-9]/g, \"_\")}`;\n      createChart(spec, \"line\", chartId)\n        .then(() => resolve(\"Line\"))\n        .catch((error) => resolve(`Error: ${error.message}`));\n\n    } catch (error) {\n      resolve(`Error: ${error.message}`);\n    }\n  });\n}\n\n/**\n * STEP custom function\n * Creates a step chart from Excel data range\n * \n * @customfunction\n * @requiresAddress\n * @param {any[][]} data The data range including headers\n * @param {CustomFunctions.Invocation} invocation Invocation object\n * @returns {string} Status message\n */\nfunction STEP(data, invocation) {\n  return new Promise((resolve) => {\n    try {\n      if (!data || data.length < 2) {\n        resolve(\"Error: Need at least header row + one data row\");\n        return;\n      }\n\n      const headers = data[0];\n      const rows = data.slice(1);\n\n      if (headers.length < 2) {\n        resolve(\"Error: Step chart requires at least 2 columns (Date, Price)\");\n        return;\n      }\n\n      // Helper function to convert Excel dates to JS dates (same as candlestick)\n      function excelDateToJSDate(serial) {\n        if (typeof serial === 'number') {\n          return new Date(Math.round((serial - 25569) * 86400 * 1000));\n        }\n        return new Date(serial);\n      }\n\n      // Process and validate data (same method as candlestick)\n      const stepData = rows.map((row, index) => {\n        // Skip if any required value is missing/null/empty\n        if (!row[0] || row[1] == null || row[1] === \"\") {\n          return null;\n        }\n\n        const date = excelDateToJSDate(row[0]);\n        const price = parseFloat(row[1]);\n        \n        if (isNaN(date.getTime()) || isNaN(price)) {\n          return null;\n        }\n        \n        return {\n          date: date.toISOString(),\n          price: price\n        };\n      }).filter(Boolean); // Remove null entries\n\n      if (stepData.length === 0) {\n        resolve(\"Error: No valid step chart data found\");\n        return;\n      }\n\n      // Use EXACT specification structure from candlestick chart\n      const spec = {\n        \"$schema\": \"https://vega.github.io/schema/vega-lite/v6.json\",\n        \"width\": 600,\n        \"description\": \"Step chart from Excel selection\",\n        \"background\": \"white\",\n        \"config\": { \"view\": { \"stroke\": \"transparent\" }},\n        \"data\": { \"values\": stepData },\n        \"mark\": { \n          \"type\": \"line\", \n          \"interpolate\": \"step-after\",\n          \"strokeWidth\": 2\n        },\n        \"encoding\": {\n          \"x\": {\n            \"field\": \"date\",\n            \"type\": \"temporal\",\n            \"axis\": {\n              \"title\": null,\n              \"format\": \"%m/%d\",\n              \"labelAngle\": -45,\n              \"labelFontSize\": 11,\n              \"labelColor\": \"#605e5c\",\n              \"font\": \"Segoe UI\"\n            }\n          },\n          \"y\": {\n            \"field\": \"price\",\n            \"type\": \"quantitative\",\n            \"scale\": { \"zero\": false },\n            \"axis\": {\n              \"title\": null,\n              \"labelFontSize\": 11,\n              \"labelColor\": \"#605e5c\",\n              \"font\": \"Segoe UI\",\n              \"grid\": true,\n              \"gridColor\": \"#f3f2f1\"\n            }\n          },\n          \"tooltip\": [\n            { \"field\": \"date\", \"type\": \"temporal\", \"title\": \"Date\", \"format\": \"%Y-%m-%d\" },\n            { \"field\": \"price\", \"type\": \"quantitative\", \"title\": \"Price\", \"format\": \".2f\" }\n          ]\n        },\n        \"config\": {\n          \"font\": \"Segoe UI\",\n          \"axis\": {\n            \"labelColor\": \"#605e5c\",\n            \"titleColor\": \"#323130\",\n            \"gridColor\": \"#f3f2f1\"\n          }\n        }\n      };\n\n      const chartId = `step_${invocation.address.replace(/[^A-Za-z0-9]/g, \"_\")}`;\n      createChart(spec, \"step\", chartId)\n        .then(() => resolve(\"Step\"))\n        .catch((error) => resolve(`Error: ${error.message}`));\n\n    } catch (error) {\n      resolve(`Error: ${error.message}`);\n    }\n  });\n}\n\n/**\n * FAN custom function\n * Creates a fan chart from Excel data range\n * \n * @customfunction\n * @requiresAddress\n * @param {any[][]} data The data range including headers\n * @param {CustomFunctions.Invocation} invocation Invocation object\n * @returns {string} Status message\n */\nfunction FAN(data, invocation) {\n  return new Promise((resolve) => {\n    try {\n      if (!data || data.length < 2) {\n        resolve(\"Error: Need at least one header row and one data row.\");\n        return;\n      }\n\n      const headers = data[0];\n      const rows = data.slice(1);\n\n      if (headers.length !== 5 && headers.length !== 7) {\n        resolve(\"Error: Fan chart requires exactly 5 or 7 columns.\");\n        return;\n      }\n\n      const fanData = rows\n        .map(row => {\n          const obj = { [headers[0]]: row[0] };\n\n          // Columns common to both layouts\n          obj.actual   = row[1] != null && row[1] !== \"\" ? parseFloat(row[1]) : null;\n          obj.p50      = row[2] != null && row[2] !== \"\" ? parseFloat(row[2]) : null;\n          obj.p75_low  = row[3] != null && row[3] !== \"\" ? parseFloat(row[3]) : null;\n          obj.p75_high = row[4] != null && row[4] !== \"\" ? parseFloat(row[4]) : null;\n\n          if (headers.length === 7) {\n            obj.p95_low  = row[5] != null && row[5] !== \"\" ? parseFloat(row[5]) : null;\n            obj.p95_high = row[6] != null && row[6] !== \"\" ? parseFloat(row[6]) : null;\n          } else {\n            obj.p95_low  = null;\n            obj.p95_high = null;\n          }\n          return obj;\n        })\n        .filter(d => d[headers[0]] !== null && d[headers[0]] !== undefined);\n\n      if (fanData.length === 0) {\n        resolve(\"Error: No valid data rows found.\");\n        return;\n      }\n\n      // Sort data by the first column to ensure correct line drawing\n      fanData.sort((a, b) => a[headers[0]] - b[headers[0]]);\n\n      let splitYear = null;\n      for (const d of fanData) {\n        if (d.p75_low !== null) {\n          splitYear = d[headers[0]];\n          break;\n        }\n      }\n\n      const isTemporalX = headers[0].toLowerCase().includes('date') || headers[0].toLowerCase().includes('time');\n      const xValues = fanData.map(d => d[headers[0]]);\n\n      const xEncoding = {\n        field: headers[0],\n        type: isTemporalX ? \"temporal\" : \"ordinal\",\n        title: headers[0],\n        sort: xValues,\n        axis: {\n          labelAngle: -45,\n          labelFontSize: 11,\n          titleFontSize: 12,\n          values: xValues,\n          format: \"d\"\n        }\n      };\n\n      const yAxisConfig = {\n        title: \"Value\",\n        labelFontSize: 11,\n        titleFontSize: 12,\n        grid: true,\n        gridColor: \"#f3f2f1\"\n      };\n\n      const spec = {\n        $schema: \"https://vega.github.io/schema/vega-lite/v6.json\",\n        description: \"Fan chart with actual and forecast data\",\n        width: 700,\n        height: 400,\n        background: \"white\",\n        data: { values: fanData },\n        encoding: { x: xEncoding },\n        layer: [\n          ...(fanData.some(d => d.p95_low !== null) ? [{\n            transform: [{ filter: `datum['${headers[0]}'] >= ${splitYear}` }],\n            mark: { type: \"area\", opacity: 0.2, color: \"steelblue\" },\n            encoding: {\n              y: { field: \"p95_high\", type: \"quantitative\", axis: yAxisConfig },\n              y2: { field: \"p95_low\" }\n            }\n          }] : []),\n          {\n            transform: [{ filter: `datum['${headers[0]}'] >= ${splitYear}` }],\n            mark: { type: \"area\", opacity: 0.35, color: \"steelblue\" },\n            encoding: {\n              y: { field: \"p75_high\", type: \"quantitative\", axis: yAxisConfig },\n              y2: { field: \"p75_low\" }\n            }\n          },\n          {\n            transform: [{ filter: `datum['${headers[0]}'] >= ${splitYear}` }],\n            mark: { type: \"line\", color: \"steelblue\", strokeDash: [4, 2], strokeWidth: 2 },\n            encoding: {\n              y: { field: \"p50\", type: \"quantitative\" },\n              tooltip: [\n                { field: headers[0], title: headers[0] },\n                { field: \"p50\", title: \"Forecast\", format: \".1f\" }\n              ]\n            }\n          },\n          {\n            transform: [{ filter: `datum['${headers[0]}'] <= ${splitYear}` }],\n            mark: { type: \"line\", color: \"steelblue\", strokeWidth: 2 },\n            encoding: {\n              y: { field: \"actual\", type: \"quantitative\", axis: yAxisConfig }\n            }\n          },\n          {\n            transform: [{ filter: `datum['${headers[0]}'] <= ${splitYear}` }],\n            mark: { type: \"circle\", color: \"steelblue\", size: 50 },\n            encoding: {\n              y: { field: \"actual\", type: \"quantitative\" },\n              tooltip: [\n                { field: headers[0], title: headers[0] },\n                { field: \"actual\", title: \"Actual\", format: \".1f\" }\n              ]\n            }\n          }\n        ],\n        config: {\n          font: \"Segoe UI\",\n          axis: { labelColor: \"#605e5c\", titleColor: \"#323130\" },\n          view: { stroke: \"transparent\" }\n        }\n      };\n      const chartId = `fan_${invocation.address.replace(/[^A-Za-z0-9]/g, \"_\")}`;\n      createChart(spec, \"fan\", chartId)\n        .then(() => resolve(\"Fan\"))\n        .catch((error) => resolve(`Error: ${error.message}`));\n    } catch (error) {\n      resolve(`Error: ${error.message}`);\n    }\n  });\n}\n\n/**\n * COLUMN custom function\n * Creates a column chart from Excel data range\n * \n * @customfunction\n * @requiresAddress\n * @param {any[][]} data The data range including headers\n * @param {CustomFunctions.Invocation} invocation Invocation object\n * @returns {string} Status message\n */\nfunction COLUMN(data, invocation) {\n  return new Promise((resolve) => {\n    try {\n      if (!data || data.length < 2) {\n        resolve(\"Error: Need at least header row + one data row\");\n        return;\n      }\n\n      const headers = data[0];\n      const rows = data.slice(1);\n\n      // Convert rows -> objects\n      const processedData = rows.map(row => {\n        let obj = {};\n        headers.forEach((h, i) => {\n          obj[h] = row[i];\n        });\n        return obj;\n      });\n\n      const categoryField = headers[0];\n      const valueField = headers[1];\n      const groupField = headers.length >= 3 ? headers[2] : null;\n\n      // Determine if we need grouping by checking if any category has multiple groups\n      let categoryGroups = {};\n      if (groupField) {\n        processedData.forEach(d => {\n          const cat = d[categoryField];\n          const grp = d[groupField];\n          if (!categoryGroups[cat]) categoryGroups[cat] = new Set();\n          categoryGroups[cat].add(grp);\n        });\n      }\n      const needsGrouping = groupField && Object.values(categoryGroups).some(groups => groups.size > 1);\n\n      // Add shadeLevel to data (counts how many duplicates per category/group)\n      let shadeCounter = {};\n      const shadedData = processedData.map(d => {\n        const key = `${d[categoryField]}|${groupField ? d[groupField] : \"none\"}`;\n        const level = (shadeCounter[key] || 0);\n        shadeCounter[key] = level + 1;\n        return { ...d, shadeLevel: level };\n      });\n\n      const spec = {\n        $schema: \"https://vega.github.io/schema/vega-lite/v6.json\",\n        description: \"Column chart from Excel selection\",\n        background: \"white\",\n        config: { view: { stroke: \"transparent\" } },\n        data: { values: shadedData },\n        mark: { type: \"bar\", tooltip: true },\n        encoding: {\n          x: { \n            field: categoryField, \n            type: \"nominal\",\n            axis: {\n              title: categoryField,\n              labelFontSize: 12,\n              titleFontSize: 14\n            }\n          },\n          y: { \n            field: valueField, \n            type: \"quantitative\",\n            axis: {\n              title: valueField,\n              labelFontSize: 12,\n              titleFontSize: 14\n            },\n            stack: \"zero\"\n          },\n          ...(needsGrouping && { xOffset: { field: groupField } }),\n          ...(groupField && {\n            color: {\n              field: groupField,\n              type: \"nominal\",\n              legend: {\n                title: groupField,\n                titleFontSize: 12,\n                labelFontSize: 11\n              },\n              scale: { scheme: \"category10\" }\n            },\n            fillOpacity: {\n              field: \"shadeLevel\",\n              type: \"quantitative\",\n              scale: { domain: [0, 3], range: [1, 0.5] }\n            }\n          })\n        },\n        config: {\n          font: \"Segoe UI\",\n          axis: {\n            labelColor: \"#605e5c\",\n            titleColor: \"#323130\",\n            gridColor: \"#f3f2f1\"\n          },\n          legend: {\n            titleColor: \"#323130\",\n            labelColor: \"#605e5c\"\n          }\n        }\n      };\n\n      const chartId = `column_${invocation.address.replace(/[^A-Za-z0-9]/g, \"_\")}`;\n      createChart(spec, \"column\", chartId)\n        .then(() => resolve(\"Column\"))\n        .catch((error) => resolve(`Error: ${error.message}`));\n\n    } catch (error) {\n      resolve(`Error: ${error.message}`);\n    }\n  });\n}\n\n/**\n * BAR custom function\n * Creates a bar chart from Excel data range\n * \n * @customfunction\n * @requiresAddress\n * @param {any[][]} data The data range including headers\n * @param {CustomFunctions.Invocation} invocation Invocation object\n * @returns {string} Status message\n */\nfunction BAR(data, invocation) {\n  return new Promise((resolve) => {\n    try {\n      if (!data || data.length < 2) {\n        resolve(\"Error: Need at least header row + one data row\");\n        return;\n      }\n\n      const headers = data[0];\n      const rows = data.slice(1);\n\n      // Convert rows -> objects\n      const processedData = rows.map(row => {\n        let obj = {};\n        headers.forEach((h, i) => {\n          obj[h] = row[i];\n        });\n        return obj;\n      });\n\n      const categoryField = headers[0];\n      const valueField = headers[1];\n      const groupField = headers.length >= 3 ? headers[2] : null;\n\n      // Determine if we need grouping by checking if any category has multiple groups\n      let categoryGroups = {};\n      if (groupField) {\n        processedData.forEach(d => {\n          const cat = d[categoryField];\n          const grp = d[groupField];\n          if (!categoryGroups[cat]) categoryGroups[cat] = new Set();\n          categoryGroups[cat].add(grp);\n        });\n      }\n      const needsGrouping = groupField && Object.values(categoryGroups).some(groups => groups.size > 1);\n\n      // Add shadeLevel to data (counts how many duplicates per category/group)\n      let shadeCounter = {};\n      const shadedData = processedData.map(d => {\n        const key = `${d[categoryField]}|${groupField ? d[groupField] : \"none\"}`;\n        const level = (shadeCounter[key] || 0);\n        shadeCounter[key] = level + 1;\n        return { ...d, shadeLevel: level };\n      });\n\n      const spec = {\n        $schema: \"https://vega.github.io/schema/vega-lite/v6.json\",\n        description: \"Bar chart from Excel selection\",\n        background: \"white\",\n        config: { view: { stroke: \"transparent\" } },\n        data: { values: shadedData },\n        mark: { type: \"bar\", tooltip: true },\n        encoding: {\n          y: { \n            field: categoryField, \n            type: \"nominal\",\n            axis: {\n              title: categoryField,\n              labelFontSize: 12,\n              titleFontSize: 14\n            }\n          },\n          x: { \n            field: valueField, \n            type: \"quantitative\",\n            axis: {\n              title: valueField,\n              labelFontSize: 12,\n              titleFontSize: 14\n            },\n            stack: \"zero\"\n          },\n          ...(needsGrouping && { yOffset: { field: groupField } }),\n          ...(groupField && {\n            color: {\n              field: groupField,\n              type: \"nominal\",\n              legend: {\n                title: groupField,\n                titleFontSize: 12,\n                labelFontSize: 11\n              },\n              scale: { scheme: \"category10\" }\n            },\n            fillOpacity: {\n              field: \"shadeLevel\",\n              type: \"quantitative\",\n              scale: { domain: [0, 3], range: [1, 0.5] }\n            }\n          })\n        },\n        config: {\n          font: \"Segoe UI\",\n          axis: {\n            labelColor: \"#605e5c\",\n            titleColor: \"#323130\",\n            gridColor: \"#f3f2f1\"\n          },\n          legend: {\n            titleColor: \"#323130\",\n            labelColor: \"#605e5c\"\n          }\n        }\n      };\n\n      const chartId = `bar_${invocation.address.replace(/[^A-Za-z0-9]/g, \"_\")}`;\n      createChart(spec, \"bar\", chartId)\n        .then(() => resolve(\"Bar\"))\n        .catch((error) => resolve(`Error: ${error.message}`));\n\n    } catch (error) {\n      resolve(`Error: ${error.message}`);\n    }\n  });\n}\n\n/**\n * BUTTERFLY custom function\n * Creates a butterfly chart from Excel data range\n * \n * @customfunction\n * @requiresAddress\n * @param {any[][]} data The data range including headers\n * @param {CustomFunctions.Invocation} invocation Invocation object\n * @returns {string} Status message\n */\nfunction BUTTERFLY(data, invocation) {\n  return new Promise((resolve) => {\n    try {\n      if (!data || data.length < 2) {\n        resolve(\"Error: Need at least header row + one data row\");\n        return;\n      }\n\n      const headers = data[0];\n      const rows = data.slice(1);\n\n      if (headers.length < 3) {\n        resolve(\"Error: Butterfly chart requires 3 columns (Category, Left Values, Right Values)\");\n        return;\n      }\n\n      // Convert rows -> objects (same as taskpane.js)\n      const processedData = rows.map(row => {\n        let obj = {};\n        headers.forEach((h, i) => {\n          obj[h] = row[i];\n        });\n        return obj;\n      });\n\n      // Calculate max value for shared scale\n      const maxLeft = Math.max(...processedData.map(d => Math.abs(d[headers[1]] || 0)));\n      const maxRight = Math.max(...processedData.map(d => Math.abs(d[headers[2]] || 0)));\n      const maxValue = Math.max(maxLeft, maxRight);\n\n      // Use EXACT specification from taskpane.js butterfly chart\n      const spec = {\n        $schema: \"https://vega.github.io/schema/vega-lite/v6.json\",\n        description: \"Butterfly chart from Excel selection\",\n        background: \"white\",\n        config: { \n          view: { stroke: null },\n          axis: { grid: false }\n        },\n        data: { values: processedData },\n        spacing: 0,\n        hconcat: [\n          {\n            transform: [{ filter: { field: headers[1], valid: true } }],\n            title: headers[1],\n            mark: \"bar\",\n            encoding: {\n              y: {\n                field: headers[0],\n                axis: null,\n                sort: \"descending\"\n              },\n              x: {\n                aggregate: \"sum\",\n                field: headers[1],\n                title: null,\n                axis: { format: \"s\" },\n                scale: { domain: [0, maxValue] },\n                sort: \"descending\"\n              },\n              color: {\n                value: \"#675193\"\n              }\n            }\n          },\n          {\n            width: 20,\n            view: { stroke: null },\n            mark: {\n              type: \"text\",\n              align: \"center\"\n            },\n            encoding: {\n              y: { \n                field: headers[0], \n                type: \"ordinal\", \n                axis: null, \n                sort: \"descending\" \n              },\n              text: { field: headers[0], type: \"nominal\" }\n            }\n          },\n          {\n            transform: [{ filter: { field: headers[2], valid: true } }],\n            title: headers[2],\n            mark: \"bar\",\n            encoding: {\n              y: {\n                field: headers[0],\n                title: null,\n                axis: null,\n                sort: \"descending\"\n              },\n              x: {\n                aggregate: \"sum\",\n                field: headers[2],\n                title: null,\n                axis: { format: \"s\" },\n                scale: { domain: [0, maxValue] }\n              },\n              color: {\n                value: \"#ca8861\"\n              }\n            }\n          }\n        ]\n      };\n\n      const chartId = `butterfly_${invocation.address.replace(/[^A-Za-z0-9]/g, \"_\")}`;\n      createChart(spec, \"butterfly\", chartId)\n        .then(() => resolve(\"Butterfly\"))\n        .catch((error) => resolve(`Error: ${error.message}`));\n\n    } catch (error) {\n      resolve(`Error: ${error.message}`);\n    }\n  });\n}\n\n/**\n * BEESWARM custom function\n * Creates a beeswarm chart from Excel data range\n * \n * @customfunction\n * @requiresAddress\n * @param {any[][]} data The data range including headers\n * @param {CustomFunctions.Invocation} invocation Invocation object\n * @returns {string} Status message\n */\nfunction BEESWARM(data, invocation) {\n  return new Promise((resolve) => {\n    try {\n      if (!data || data.length < 2) {\n        resolve(\"Error: Need at least header row + one data row\");\n        return;\n      }\n\n      const headers = data[0];\n      const rows = data.slice(1);\n\n      if (headers.length < 2) {\n        resolve(\"Error: Beeswarm chart requires at least 2 columns (Category, Value)\");\n        return;\n      }\n\n      // Convert rows to objects with proper structure\n      const processedData = rows.map((row, index) => ({\n        group: row[0],\n        value: parseFloat(row[1]) || 0,\n        id: index,\n        name: headers.length >= 3 && row[2] ? row[2] : `Item ${index + 1}`\n      }));\n\n      // Calculate dynamic dimensions\n      const uniqueGroups = [...new Set(processedData.map(d => d.group))];\n      const dynamicWidth = Math.max(600, uniqueGroups.length * 150);\n      const dynamicHeight = 300;\n\n      // Full Vega specification with force simulation\n      const spec = {\n        $schema: \"https://vega.github.io/schema/vega/v5.json\",\n        description: \"Beeswarm chart using force-directed layout from Excel selection\",\n        width: dynamicWidth,\n        height: dynamicHeight,\n        padding: { left: 5, right: 5, top: 20, bottom: 40 },\n        autosize: \"none\",\n        background: \"white\",\n        \n        signals: [\n          { name: \"cx\", update: \"width / 2\" },\n          { name: \"cy\", update: \"height / 2\" },\n          { name: \"radius\", value: 6 },\n          { name: \"collide\", value: 1 },\n          { name: \"gravityX\", value: 0.3 },\n          { name: \"gravityY\", value: 0.2 },\n          { name: \"static\", value: true }\n        ],\n\n        data: [\n          {\n            name: \"people\",\n            values: processedData\n          }\n        ],\n\n        scales: [\n          {\n            name: \"xscale\",\n            type: \"band\",\n            domain: {\n              data: \"people\",\n              field: \"group\",\n              sort: true\n            },\n            range: \"width\"\n          },\n          {\n            name: \"color\",\n            type: \"ordinal\",\n            domain: { data: \"people\", field: \"group\" },\n            range: { scheme: \"tableau10\" }\n          }\n        ],\n\n        axes: [\n          { \n            orient: \"bottom\", \n            scale: \"xscale\",\n            labelAngle: -45,\n            labelAlign: \"right\",\n            labelBaseline: \"middle\",\n            labelFont: \"Segoe UI\",\n            labelFontSize: 11,\n            labelColor: \"#605e5c\",\n            titleFont: \"Segoe UI\",\n            titleFontSize: 12,\n            titleColor: \"#323130\",\n            domain: true,\n            domainColor: \"#8a8886\",\n            ticks: true,\n            tickColor: \"#8a8886\"\n          }\n        ],\n\n        marks: [\n          {\n            name: \"nodes\",\n            type: \"symbol\",\n            from: { data: \"people\" },\n            encode: {\n              enter: {\n                fill: { scale: \"color\", field: \"group\" },\n                xfocus: { scale: \"xscale\", field: \"group\", band: 0.5 },\n                yfocus: { signal: \"cy\" }\n              },\n              update: {\n                size: { signal: \"pow(2 * radius, 2)\" },\n                stroke: { value: \"white\" },\n                strokeWidth: { value: 1.5 },\n                zindex: { value: 0 },\n                tooltip: { \n                  signal: \"{'Name': datum.name, 'Group': datum.group, 'Value': datum.value}\" \n                }\n              },\n              hover: {\n                stroke: { value: \"#323130\" },\n                strokeWidth: { value: 3 },\n                zindex: { value: 1 }\n              }\n            },\n            transform: [\n              {\n                type: \"force\",\n                iterations: 300,\n                static: { signal: \"static\" },\n                forces: [\n                  { \n                    force: \"collide\", \n                    iterations: { signal: \"collide\" }, \n                    radius: { signal: \"radius + 1\" } \n                  },\n                  { \n                    force: \"x\", \n                    x: \"xfocus\", \n                    strength: { signal: \"gravityX\" } \n                  },\n                  { \n                    force: \"y\", \n                    y: \"yfocus\", \n                    strength: { signal: \"gravityY\" } \n                  }\n                ]\n              }\n            ]\n          }\n        ],\n        \n        config: {\n          view: { stroke: \"transparent\" },\n          font: \"Segoe UI\"\n        }\n      };\n\n      const chartId = `beeswarm_${invocation.address.replace(/[^A-Za-z0-9]/g, \"_\")}`;\n      createChart(spec, \"beeswarm\", chartId)\n        .then(() => resolve(\"Beeswarm\"))\n        .catch((error) => resolve(`Error: ${error.message}`));\n\n    } catch (error) {\n      resolve(`Error: ${error.message}`);\n    }\n  });\n}\n\n/**\n * FUNNEL custom function\n * Creates a funnel chart from Excel data range\n * \n * @customfunction\n * @requiresAddress\n * @param {any[][]} data The data range including headers\n * @param {CustomFunctions.Invocation} invocation Invocation object\n * @returns {string} Status message\n */\nfunction FUNNEL(data, invocation) {\n  return new Promise((resolve) => {\n    try {\n      if (!data || data.length < 2) {\n        resolve(\"Error: Need at least header row + one data row\");\n        return;\n      }\n\n      const headers = data[0];\n      const rows = data.slice(1);\n\n      if (headers.length < 2) {\n        resolve(\"Error: Funnel chart requires 2 columns (Stage, Value)\");\n        return;\n      }\n\n      // Validate that all values are positive numbers\n      const hasInvalidValues = rows.some(row => isNaN(row[1]) || row[1] <= 0);\n      if (hasInvalidValues) {\n        resolve(\"Error: Funnel chart values must be positive numbers\");\n        return;\n      }\n\n      // Convert rows -> objects\n      const processedData = rows.map(row => {\n        let obj = {};\n        headers.forEach((h, i) => {\n          obj[h] = row[i];\n        });\n        return obj;\n      });\n\n      processedData.sort((a, b) => b[headers[1]] - a[headers[1]]);\n\n      // Calculate percentages\n      const total = processedData.reduce((sum, d) => sum + d[headers[1]], 0);\n\n      // Detect if input values are already percentages\n      const isPercentage = processedData.every(d => {\n        const val = d[headers[1]];\n        return (val >= 0 && val <= 1) || (val > 1 && val <= 100 && Number.isInteger(val));\n      });\n\n      const dataWithPercentages = processedData.map(d => {\n        const value = d[headers[1]];\n        const label = isPercentage\n          ? (value <= 1 ? (value * 100).toFixed(1) : value.toFixed(1)) + '%'\n          : value.toLocaleString();\n\n        return {\n          [headers[0]]: d[headers[0]],\n          [headers[1]]: value,\n          percentage: ((value / total) * 100).toFixed(1) + '%',\n          label: label\n        };\n      });\n\n      const numBars = processedData.length;\n      const colorRange = [];\n      for (let i = 0; i < numBars; i++) {\n        const lighten = 1 - (i / (numBars - 1)) * 0.6; // lighten up to 60%\n        const baseR = 0, baseG = 120, baseB = 212;\n        const r = Math.round(baseR + (255 - baseR) * (1 - lighten));\n        const g = Math.round(baseG + (255 - baseG) * (1 - lighten));\n        const b = Math.round(baseB + (255 - baseB) * (1 - lighten));\n        colorRange.push(`rgb(${r}, ${g}, ${b})`);\n      }\n      const spec = {\n        $schema: \"https://vega.github.io/schema/vega-lite/v5.json\",\n        description: \"Centered funnel chart showing conversion stages\",\n        background: \"white\",\n        width: 400,\n        height: 250,\n        config: { \n          view: { stroke: \"transparent\" },\n          font: \"Segoe UI\"\n        },\n\n        data: { values: dataWithPercentages },\n\n        encoding: {\n          y: { \n            type: \"nominal\", \n            field: headers[0], \n            sort: \"-x\",\n            axis: {\n              labelFontSize: 11,\n              labelColor: \"#323130\",\n              title: null,\n              labelPadding: 5\n            }\n          }\n        },\n\n        layer: [\n          {\n            mark: { type: \"bar\", tooltip: true, orient: \"horizontal\" },\n            encoding: {\n              color: { \n                type: \"nominal\", \n                field: headers[0], \n                legend: null,\n                scale: { range: colorRange }\n              },\n              x: { \n                type: \"quantitative\", \n                field: headers[1], \n                stack: \"center\",\n                axis: null\n              },\n              tooltip: [\n                { field: headers[0], type: \"nominal\", title: \"Stage\" },\n                { field: headers[1], type: \"quantitative\", title: \"Count\", format: \",.0f\" },\n                { field: \"percentage\", type: \"nominal\", title: \"Percentage\" }\n              ]\n            }\n          },\n          {\n            mark: { \n              type: \"text\", \n              align: \"left\",\n              dx: 5,\n              fontSize: 12,\n              fontWeight: \"nominal\",\n              color: \"#FF6347\"\n            },\n            encoding: {\n              text: { field: \"label\", type: \"nominal\" },\n              x: { \n                type: \"quantitative\", \n                field: headers[1],\n                stack: \"center\"\n              },\n              y: { field: headers[0], type: \"nominal\" }\n            }\n          }\n        ]\n      };\n      const chartId = `funnel_${invocation.address.replace(/[^A-Za-z0-9]/g, \"_\")}`;\n      createChart(spec, \"funnel\", chartId)\n        .then(() => resolve(\"Funnel\"))\n        .catch((error) => resolve(`Error: ${error.message}`));\n    } catch (error) {\n      resolve(`Error: ${error.message}`);\n    }\n  });\n}\n\n/**\n * GAUGE custom function \n * Creates a gauge chart from Excel data range\n * \n * @customfunction\n * @requiresAddress\n * @param {any[][]} data The data range including headers\n * @param {CustomFunctions.Invocation} invocation Invocation object\n * @returns {string} Status message\n */\nfunction GAUGE(data, invocation) {\n  return new Promise((resolve) => {\n    try {\n      if (!data || data.length < 2) {\n        resolve(\"Error: Need at least header row + one data row\");\n        return;\n      }\n\n      const headers = data[0];\n      const rows = data.slice(1);\n\n      if (headers.length < 2) {\n        resolve(\"Error: Gauge chart requires 2 columns (Current Value, Max Value)\");\n        return;\n      }\n\n      // Process gauge data - expect one row with current value and max value\n      const gaugeRow = rows[0]; // Use first data row\n      const mainValue = parseFloat(gaugeRow[0]) || 0;\n      const maxValue = parseFloat(gaugeRow[1]) || 100;\n      const minValue = 0; // Always start from 0\n\n      const spec = {\n        \"$schema\": \"https://vega.github.io/schema/vega/v5.json\",\n        \"description\": \"Gauge chart from Excel selection\",\n        \"width\": 400,\n        \"height\": 220,\n        \"background\": \"white\",\n        \"config\": { \"view\": { \"stroke\": \"transparent\" }},\n        \n        \"signals\": [\n          {\"name\": \"centerX\", \"update\": \"width / 2\"},\n          {\"name\": \"centerY\", \"update\": \"height - 20\"},\n          {\"name\": \"outerRadius\", \"update\": \"min(width / 2, height) - 20\"},\n          {\"name\": \"innerRadius\", \"update\": \"outerRadius - outerRadius * 0.25\"},\n          {\"name\": \"mainValue\", \"value\": mainValue},\n          {\"name\": \"minValue\", \"value\": minValue},\n          {\"name\": \"maxValue\", \"value\": maxValue},\n          {\"name\": \"usedValue\", \"update\": \"min(max(minValue, mainValue), maxValue)\"},\n          {\"name\": \"fontFactor\", \"update\": \"(min(width, height)/5)/25\"},\n          {\"name\": \"backgroundColor\", \"value\": \"#e1e4e8\"},\n          {\"name\": \"fillColor\", \"value\": \"#0078d4\"},\n          {\"name\": \"needleColor\", \"value\": \"#323130\"},\n          {\"name\": \"needleSize\", \"update\": \"innerRadius\"}\n        ],\n        \n        \"scales\": [\n          {\n            \"name\": \"gaugeScale\",\n            \"type\": \"linear\",\n            \"domain\": [{\"signal\": \"minValue\"}, {\"signal\": \"maxValue\"}],\n            \"range\": [{\"signal\": \"-PI/2\"}, {\"signal\": \"PI/2\"}]\n          },\n          {\n            \"name\": \"needleScale\",\n            \"type\": \"linear\",\n            \"domain\": [{\"signal\": \"minValue\"}, {\"signal\": \"maxValue\"}],\n            \"range\": [-90, 90]\n          }\n        ],\n        \n        \"marks\": [\n          {\n            \"type\": \"arc\",\n            \"name\": \"gauge\",\n            \"encode\": {\n              \"enter\": {\n                \"x\": {\"signal\": \"centerX\"},\n                \"y\": {\"signal\": \"centerY\"},\n                \"startAngle\": {\"signal\": \"-PI/2\"},\n                \"endAngle\": {\"signal\": \"PI/2\"},\n                \"outerRadius\": {\"signal\": \"outerRadius\"},\n                \"innerRadius\": {\"signal\": \"innerRadius\"},\n                \"fill\": {\"signal\": \"backgroundColor\"}\n              }\n            }\n          },\n          {\n            \"type\": \"arc\",\n            \"encode\": {\n              \"enter\": {\"startAngle\": {\"signal\": \"-PI/2\"}},\n              \"update\": {\n                \"x\": {\"signal\": \"centerX\"},\n                \"y\": {\"signal\": \"centerY\"},\n                \"innerRadius\": {\"signal\": \"innerRadius\"},\n                \"outerRadius\": {\"signal\": \"outerRadius\"},\n                \"endAngle\": {\"scale\": \"gaugeScale\", \"signal\": \"usedValue\"},\n                \"fill\": {\"signal\": \"fillColor\"}\n              }\n            }\n          },\n          {\n            \"type\": \"text\",\n            \"description\": \"displayed main value at the center\",\n            \"encode\": {\n              \"enter\": {\n                \"x\": {\"signal\": \"centerX\"},\n                \"y\": {\"signal\": \"centerY + fontFactor * 15\"},\n                \"baseline\": {\"value\": \"middle\"},\n                \"align\": {\"value\": \"center\"},\n                \"fontSize\": {\"signal\": \"fontFactor * 7\"},\n                \"font\": {\"value\": \"Segoe UI\"},\n                \"fontWeight\": {\"value\": \"bold\"}\n              },\n              \"update\": {\n                \"text\": {\"signal\": \"mainValue < 1 ? format(mainValue, '.0%') : format(mainValue, ',.0f')\"},\n                \"fill\": {\"signal\": \"fillColor\"}\n              }\n            }\n          },\n          {\n            \"type\": \"symbol\",\n            \"name\": \"needle\",\n            \"encode\": {\n              \"enter\": {\"x\": {\"signal\": \"centerX\"}, \"y\": {\"signal\": \"centerY\"}},\n              \"update\": {\n                \"shape\": {\n                  \"signal\": \"'M-2.5 -2.5 Q 0 0 2.5 -2.5 L 0 -' + toString(needleSize) + ' Z '\"\n                },\n                \"angle\": {\"signal\": \"usedValue\", \"scale\": \"needleScale\"},\n                \"size\": {\"signal\": \"4\"},\n                \"stroke\": {\"signal\": \"needleColor\"},\n                \"fill\": {\"signal\": \"needleColor\"}\n              }\n            }\n          },\n          {\n            \"type\": \"symbol\",\n            \"description\": \"center circle\",\n            \"encode\": {\n              \"enter\": {\n                \"x\": {\"signal\": \"centerX\"},\n                \"y\": {\"signal\": \"centerY\"},\n                \"shape\": {\"value\": \"circle\"},\n                \"size\": {\"signal\": \"pow(fontFactor * 8, 2)\"},\n                \"fill\": {\"signal\": \"needleColor\"},\n                \"stroke\": {\"value\": \"white\"},\n                \"strokeWidth\": {\"value\": 2}\n              }\n            }\n          }\n        ]\n      };\n      const chartId = `gauge_${invocation.address.replace(/[^A-Za-z0-9]/g, \"_\")}`;\n      createChart(spec, \"gauge\", chartId)\n        .then(() => resolve(\"Gauge\"))\n        .catch((error) => resolve(`Error: ${error.message}`));\n\n    } catch (error) {\n      resolve(`Error: ${error.message}`);\n    }\n  });\n}\n\n/**\n * PIE custom function\n * Creates a pie chart from Excel data range\n * \n * @customfunction\n * @requiresAddress\n * @param {any[][]} data The data range including headers\n * @param {CustomFunctions.Invocation} invocation Invocation object\n * @returns {string} Status message\n */\nfunction PIE(data, invocation) {\n  return new Promise((resolve) => {\n    try {\n      if (!data || data.length < 2) {\n        resolve(\"Error: Need at least header row + one data row\");\n        return;\n      }\n\n      const headers = data[0];\n      const rows = data.slice(1);\n\n      if (headers.length < 2) {\n        resolve(\"Error: Pie chart requires 2 columns (Category, Value)\");\n        return;\n      }\n\n      // Validate that all values are positive numbers\n      const hasInvalidValues = rows.some(row => isNaN(row[1]) || row[1] <= 0);\n      if (hasInvalidValues) {\n        resolve(\"Error: Pie chart values must be positive numbers\");\n        return;\n      }\n\n      // Convert rows -> objects (same as taskpane.js)\n      const processedData = rows.map(row => {\n        let obj = {};\n        headers.forEach((h, i) => {\n          obj[h] = row[i];\n        });\n        return obj;\n      });\n\n      // Use EXACT specification from taskpane.js pie chart\n      const spec = {\n        $schema: \"https://vega.github.io/schema/vega-lite/v6.json\",\n        background: \"white\",\n        config: { view: { stroke: \"transparent\" }},\n        description: \"Pie chart from Excel selection\",\n        data: { values: processedData },\n        mark: { type: \"arc\", outerRadius: 120 },\n        encoding: {\n          theta: { field: headers[1], type: \"quantitative\" },\n          color: { field: headers[0], type: \"nominal\" }\n        }\n      };\n      const chartId = `pie_${invocation.address.replace(/[^A-Za-z0-9]/g, \"_\")}`;\n      createChart(spec, \"pie\", chartId)\n        .then(() => resolve(\"Pie\"))\n        .catch((error) => resolve(`Error: ${error.message}`));\n\n    } catch (error) {\n      resolve(`Error: ${error.message}`);\n    }\n  });\n}\n\n/**\n * DONUT custom function\n * Creates a donut chart from Excel data range\n * \n * @customfunction\n * @requiresAddress\n * @param {any[][]} data The data range including headers\n * @param {CustomFunctions.Invocation} invocation Invocation object\n * @returns {string} Status message\n */\nfunction DONUT(data, invocation) {\n  return new Promise((resolve) => {\n    try {\n      if (!data || data.length < 2) {\n        resolve(\"Error: Need at least header row + one data row\");\n        return;\n      }\n\n      const headers = data[0];\n      const rows = data.slice(1);\n\n      if (headers.length < 2) {\n        resolve(\"Error: Donut chart requires 2 columns (Category, Value)\");\n        return;\n      }\n\n      // Validate that all values are positive numbers\n      const hasInvalidValues = rows.some(row => isNaN(row[1]) || row[1] <= 0);\n      if (hasInvalidValues) {\n        resolve(\"Error: Donut chart values must be positive numbers\");\n        return;\n      }\n\n      // Convert rows -> objects (same as taskpane.js)\n      const processedData = rows.map(row => {\n        let obj = {};\n        headers.forEach((h, i) => {\n          obj[h] = row[i];\n        });\n        return obj;\n      });\n\n      // Use Vega-Lite specification for donut chart (based on the reference provided)\n      const spec = {\n        $schema: \"https://vega.github.io/schema/vega-lite/v6.json\",\n        background: \"white\",\n        config: { view: { stroke: \"transparent\" }},\n        description: \"Donut chart from Excel selection\",\n        data: { values: processedData },\n        mark: { \n          type: \"arc\", \n          innerRadius: 50,  // This creates the donut hole\n          outerRadius: 120,\n          tooltip: true,\n          stroke: \"white\",\n          strokeWidth: 2\n        },\n        encoding: {\n          theta: { \n            field: headers[1], \n            type: \"quantitative\",\n            scale: { type: \"linear\", range: [0, 6.28] }\n          },\n          color: { \n            field: headers[0], \n            type: \"nominal\",\n            scale: { scheme: \"category10\" },\n            legend: {\n              title: headers[0],\n              titleFontSize: 12,\n              labelFontSize: 11,\n              orient: \"right\"\n            }\n          },\n          tooltip: [\n            { field: headers[0], type: \"nominal\", title: \"Category\" },\n            { field: headers[1], type: \"quantitative\", title: \"Value\", format: \",.0f\" }\n          ]\n        },\n        config: {\n          font: \"Segoe UI\",\n          legend: {\n            titleColor: \"#323130\",\n            labelColor: \"#605e5c\"\n          }\n        }\n      };\n\n      const chartId = `donut_${invocation.address.replace(/[^A-Za-z0-9]/g, \"_\")}`;\n      createChart(spec, \"donut\", chartId)\n        .then(() => resolve(\"Donut\"))\n        .catch((error) => resolve(`Error: ${error.message}`));\n\n    } catch (error) {\n      resolve(`Error: ${error.message}`);\n    }\n  });\n}\n\n/**\n * CHORD custom function\n * Creates a chord diagram from Excel data range\n * \n * @customfunction\n * @requiresAddress\n * @param {any[][]} data The data range including headers\n * @param {CustomFunctions.Invocation} invocation Invocation object\n * @returns {string} Status message\n */\nfunction CHORD(data, invocation) {\n  return new Promise((resolve) => {\n    try {\n      if (!data || data.length < 2) {\n        resolve(\"Error: Need at least header row + one data row\");\n        return;\n      }\n\n      const headers = data[0];\n      const rows = data.slice(1);\n\n      if (headers.length !== 3) {\n        resolve(\"Error: Chord chart requires exactly 3 columns: Source, Destination, Value\");\n        return;\n      }\n\n      // Get unique nodes from both source and destination columns\n      const nodeSet = new Set();\n      rows.forEach(row => {\n        nodeSet.add(row[0]); // source\n        nodeSet.add(row[1]); // destination\n      });\n      const nodeLabels = Array.from(nodeSet);\n      const n = nodeLabels.length;\n      \n      // Create index mapping\n      const nodeIndex = {};\n      nodeLabels.forEach((label, i) => {\n        nodeIndex[label] = i;\n      });\n      \n      // Build matrix from edge list\n      const matrix = Array(n).fill(0).map(() => Array(n).fill(0));\n      rows.forEach(row => {\n        const source = row[0];\n        const dest = row[1];\n        const value = parseFloat(row[2]) || 0;\n        \n        const sourceIdx = nodeIndex[source];\n        const destIdx = nodeIndex[dest];\n        \n        if (sourceIdx !== undefined && destIdx !== undefined) {\n          matrix[sourceIdx][destIdx] = value;\n        }\n      });\n\n      // Calculate totals for each node (sum of incoming + outgoing)\n      const nodeTotals = new Array(n).fill(0);\n      for (let i = 0; i < n; i++) {\n        for (let j = 0; j < n; j++) {\n          nodeTotals[i] += matrix[i][j]; // outgoing\n          nodeTotals[i] += matrix[j][i]; // incoming\n        }\n      }\n      \n      // Total sum should also be the sum of all node totals (incoming + outgoing for all nodes)\n      // This ensures the proportions add up correctly\n      const totalSum = nodeTotals.reduce((sum, val) => sum + val, 0);\n\n      if (totalSum === 0) {\n        resolve(\"Error: All values are zero\");\n        return;\n      }\n\n      // Generate chord arcs with angles\n      const chords = [];\n      let currentAngle = 0;\n      const padding = 0.02; // Gap between arc segments\n      const totalPadding = padding * n; // Total space used by all gaps\n      const availableAngle = (2 * Math.PI) - totalPadding; // Remaining angle for arcs\n\n      for (let i = 0; i < n; i++) {\n        const angleSize = (nodeTotals[i] / totalSum) * availableAngle; // Use available angle, not full 2\n        chords.push({\n          index: i,\n          label: nodeLabels[i],\n          startAngle: currentAngle,\n          endAngle: currentAngle + angleSize,\n          value: nodeTotals[i]\n        });\n        currentAngle += angleSize + padding;\n      }\n\n      // Track used portions of each chord for proper ribbon positioning\n      const usedAngles = chords.map(c => ({ \n        start: c.startAngle, \n        end: c.startAngle \n      }));\n\n      // Generate ribbon paths for connections\n      const ribbonsPaths = [];\n      const innerRadius = 270;\n\n      // Process matrix to create ribbons\n      for (let i = 0; i < n; i++) {\n        for (let j = 0; j < n; j++) {\n          const value = matrix[i][j];\n          if (value > 0) {\n            const sourceChord = chords[i];\n            const targetChord = chords[j];\n            \n            // Calculate angle span for this ribbon on source\n            const sourceAngleSpan = (value / nodeTotals[i]) * (sourceChord.endAngle - sourceChord.startAngle);\n            const sourceStart = usedAngles[i].end;\n            const sourceEnd = sourceStart + sourceAngleSpan;\n            usedAngles[i].end = sourceEnd;\n            \n            // Calculate angle span for this ribbon on target\n            const targetAngleSpan = (value / nodeTotals[j]) * (targetChord.endAngle - targetChord.startAngle);\n            const targetStart = usedAngles[j].end;\n            const targetEnd = targetStart + targetAngleSpan;\n            usedAngles[j].end = targetEnd;\n\n            // Generate SVG path using inline polar to cartesian conversion\n            const s0x = innerRadius * Math.cos(sourceStart - Math.PI / 2);\n            const s0y = innerRadius * Math.sin(sourceStart - Math.PI / 2);\n            const s1x = innerRadius * Math.cos(sourceEnd - Math.PI / 2);\n            const s1y = innerRadius * Math.sin(sourceEnd - Math.PI / 2);\n            const t0x = innerRadius * Math.cos(targetStart - Math.PI / 2);\n            const t0y = innerRadius * Math.sin(targetStart - Math.PI / 2);\n            const t1x = innerRadius * Math.cos(targetEnd - Math.PI / 2);\n            const t1y = innerRadius * Math.sin(targetEnd - Math.PI / 2);\n            \n            const sourceLargeArc = (sourceEnd - sourceStart) > Math.PI ? 1 : 0;\n            const targetLargeArc = (targetEnd - targetStart) > Math.PI ? 1 : 0;\n            \n            const path = `M${s0x},${s0y}A${innerRadius},${innerRadius},0,${sourceLargeArc},1,${s1x},${s1y}Q0,0,${t0x},${t0y}A${innerRadius},${innerRadius},0,${targetLargeArc},1,${t1x},${t1y}Q0,0,${s0x},${s0y}Z`;\n            \n            ribbonsPaths.push({\n              path: path,\n              source: i,\n              target: j,\n              sourceLabel: nodeLabels[i],\n              targetLabel: nodeLabels[j],\n              value: value\n            });\n          }\n        }\n      }\n\n      // Create Vega specification\n      const spec = {\n        \"$schema\": \"https://vega.github.io/schema/vega/v5.json\",\n        \"description\": \"Chord diagram from Excel data\",\n        \"width\": 700,\n        \"height\": 700,\n        \"padding\": 5,\n        \"background\": \"white\",\n        \"signals\": [\n          { \"name\": \"originX\", \"value\": 0 },\n          { \"name\": \"originY\", \"value\": 0 },\n          { \"name\": \"inner_radius\", \"value\": 270 },\n          { \"name\": \"outer_radius\", \"value\": 290 }\n        ],\n        \"scales\": [\n          {\n            \"name\": \"color\",\n            \"type\": \"ordinal\",\n            \"domain\": { \"data\": \"chords\", \"field\": \"index\" },\n            \"range\": { \"scheme\": \"category10\" }\n          }\n        ],\n        \"data\": [\n          {\n            \"name\": \"chords\",\n            \"values\": chords,\n            \"transform\": [\n              {\n                \"type\": \"formula\",\n                \"expr\": \"(((datum.startAngle + datum.endAngle) / 2) * 180 / PI) - 90\",\n                \"as\": \"angle_degrees\"\n              },\n              {\n                \"type\": \"formula\",\n                \"expr\": \"PI * datum.angle_degrees / 180\",\n                \"as\": \"radians\"\n              },\n              {\n                \"type\": \"formula\",\n                \"expr\": \"inrange(datum.angle_degrees, [90, 270])\",\n                \"as\": \"leftside\"\n              },\n              {\n                \"type\": \"formula\",\n                \"expr\": \"originX + outer_radius * cos(datum.radians)\",\n                \"as\": \"x\"\n              },\n              {\n                \"type\": \"formula\",\n                \"expr\": \"originY + outer_radius * sin(datum.radians)\",\n                \"as\": \"y\"\n              }\n            ]\n          },\n          {\n            \"name\": \"ribbonsPaths\",\n            \"values\": ribbonsPaths\n          }\n        ],\n        \"marks\": [\n          {\n            \"type\": \"arc\",\n            \"from\": { \"data\": \"chords\" },\n            \"encode\": {\n              \"enter\": {\n                \"fill\": { \"scale\": \"color\", \"field\": \"index\" },\n                \"x\": { \"signal\": \"width / 2\" },\n                \"y\": { \"signal\": \"height / 2\" }\n              },\n              \"update\": {\n                \"startAngle\": { \"field\": \"startAngle\" },\n                \"endAngle\": { \"field\": \"endAngle\" },\n                \"padAngle\": { \"value\": 0 },\n                \"innerRadius\": { \"signal\": \"inner_radius\" },\n                \"outerRadius\": { \"signal\": \"outer_radius\" },\n                \"opacity\": { \"value\": 0.9 },\n                \"tooltip\": {\n                  \"signal\": \"{'Label': datum.label, 'Value': datum.value}\"\n                }\n              },\n              \"hover\": {\n                \"opacity\": { \"value\": 1 }\n              }\n            }\n          },\n          {\n            \"type\": \"text\",\n            \"from\": { \"data\": \"chords\" },\n            \"encode\": {\n              \"enter\": {\n                \"text\": { \"field\": \"label\" },\n                \"fontSize\": { \"value\": 11 },\n                \"font\": { \"value\": \"Segoe UI\" },\n                \"fill\": { \"value\": \"#323130\" }\n              },\n              \"update\": {\n                \"x\": { \"signal\": \"width / 2 + datum.x\" },\n                \"y\": { \"signal\": \"width / 2 + datum.y\" },\n                \"dx\": { \"signal\": \"(datum.leftside ? -1 : 1) * 6\" },\n                \"angle\": { \"signal\": \"datum.leftside ? datum.angle_degrees - 180 : datum.angle_degrees\" },\n                \"align\": { \"signal\": \"datum.leftside ? 'right' : 'left'\" },\n                \"baseline\": { \"value\": \"middle\" }\n              }\n            }\n          },\n          {\n            \"type\": \"path\",\n            \"from\": { \"data\": \"ribbonsPaths\" },\n            \"encode\": {\n              \"enter\": {\n                \"x\": { \"signal\": \"width / 2\" },\n                \"y\": { \"signal\": \"height / 2\" }\n              },\n              \"update\": {\n                \"path\": { \"field\": \"path\" },\n                \"fill\": { \"scale\": \"color\", \"field\": \"source\" },\n                \"opacity\": { \"value\": 0.6 },\n                \"stroke\": { \"value\": \"white\" },\n                \"strokeWidth\": { \"value\": 0.5 },\n                \"tooltip\": {\n                  \"signal\": \"{'From': datum.sourceLabel, 'To': datum.targetLabel, 'Value': format(datum.value, ',.0f')}\"\n                }\n              },\n              \"hover\": {\n                \"opacity\": { \"value\": 0.8 }\n              }\n            }\n          }\n        ]\n      };\n      const chartId = `chord_${invocation.address.replace(/[^A-Za-z0-9]/g, \"_\")}`;\n      createChart(spec, \"chord\", chartId)\n        .then(() => resolve(\"Chord\"))\n        .catch((error) => resolve(`Error: ${error.message}`));\n\n    } catch (error) {\n      resolve(`Error: ${error.message}`);\n    }\n  });\n}\n\n/**\n * CIRCLEPACKING custom function\n * Creates a circle packing chart from Excel data range\n * \n * @customfunction\n * @requiresAddress\n * @param {any[][]} data The data range including headers\n * @param {CustomFunctions.Invocation} invocation Invocation object\n * @returns {string} Status message\n */\nfunction CIRCLEPACKING(data, invocation) {\n  return new Promise((resolve) => {\n    try {\n      if (!data || data.length < 2) {\n        resolve(\"Error: Need at least header row + one data row\");\n        return;\n      }\n\n      const headers = data[0];\n      const rows = data.slice(1);\n\n      if (headers.length < 2) {\n        resolve(\"Error: Circlepacking requires at least 2 columns (Parent, Child, Size optional)\");\n        return;\n      }\n\n      // Process data same as other hierarchical charts\n      const nodes = new Map();\n\n      rows.forEach((row, i) => {\n        const parent = row[0] || \"\";\n        const child = row[1] || `node_${i}`;\n        const size = headers.length >= 3 ? (parseFloat(row[2]) || 1) : 1;\n        \n        // Add parent node if it doesn't exist and is not empty\n        if (parent && !nodes.has(parent)) {\n          nodes.set(parent, {\n            id: parent,\n            parent: \"\",\n            name: parent,\n            size: 0\n          });\n        }\n        \n        // Add child node\n        if (!nodes.has(child)) {\n          nodes.set(child, {\n            id: child,\n            parent: parent,\n            name: child,\n            size: size\n          });\n        } else {\n          const existingNode = nodes.get(child);\n          existingNode.parent = parent;\n          existingNode.size = size;\n        }\n      });\n      \n      // Convert Map to array\n      const hierarchicalData = Array.from(nodes.values());\n      \n      // Find root nodes (nodes with no parent or parent not in dataset)\n      const allIds = new Set(hierarchicalData.map(d => d.id));\n      hierarchicalData.forEach(node => {\n        if (node.parent && !allIds.has(node.parent)) {\n          node.parent = \"\";\n        }\n      });\n\n      // Calculate chart size based on data complexity\n      const nodeCount = hierarchicalData.length;\n      const chartSize = Math.max(500, Math.min(700, nodeCount * 20 + 300));\n\n      // Circle packing specification based on Vega reference\n      const spec = {\n        \"$schema\": \"https://vega.github.io/schema/vega/v6.json\",\n        \"description\": \"Circle packing chart from Excel selection\",\n        \"width\": chartSize,\n        \"height\": chartSize,\n        \"padding\": 5,\n        \"autosize\": \"none\",\n        \"background\": \"white\",\n        \n        \"data\": [\n          {\n            \"name\": \"tree\",\n            \"values\": hierarchicalData,\n            \"transform\": [\n              {\n                \"type\": \"stratify\",\n                \"key\": \"id\",\n                \"parentKey\": \"parent\"\n              },\n              {\n                \"type\": \"pack\",\n                \"field\": \"size\",\n                \"sort\": {\"field\": \"value\"},\n                \"size\": [{\"signal\": \"width\"}, {\"signal\": \"height\"}]\n              }\n            ]\n          }\n        ],\n\n        \"scales\": [\n          {\n            \"name\": \"color\",\n            \"type\": \"ordinal\",\n            \"domain\": {\"data\": \"tree\", \"field\": \"depth\"},\n            \"range\": {\"scheme\": \"category20\"}\n          }\n        ],\n\n        \"marks\": [\n          {\n            \"type\": \"symbol\",\n            \"from\": {\"data\": \"tree\"},\n            \"encode\": {\n              \"enter\": {\n                \"shape\": {\"value\": \"circle\"},\n                \"fill\": {\"scale\": \"color\", \"field\": \"depth\"},\n                \"tooltip\": {\n                  \"signal\": \"datum.name + (datum.size ? ', ' + format(datum.size, ',.0f') : '')\"\n                }\n              },\n              \"update\": {\n                \"x\": {\"field\": \"x\"},\n                \"y\": {\"field\": \"y\"},\n                \"size\": {\"signal\": \"4 * datum.r * datum.r\"},\n                \"stroke\": {\"value\": \"white\"},\n                \"strokeWidth\": {\"value\": 0.5},\n                \"opacity\": {\"value\": 0.8}\n              },\n              \"hover\": {\n                \"stroke\": {\"value\": \"#0078d4\"},\n                \"strokeWidth\": {\"value\": 2},\n                \"opacity\": {\"value\": 1}\n              }\n            }\n          },\n          {\n            \"type\": \"text\",\n            \"from\": {\"data\": \"tree\"},\n            \"encode\": {\n              \"enter\": {\n                \"align\": {\"value\": \"center\"},\n                \"baseline\": {\"value\": \"middle\"},\n                \"fill\": {\"value\": \"#323130\"},\n                \"font\": {\"value\": \"Segoe UI\"},\n                \"fontWeight\": {\"value\": \"500\"}\n              },\n              \"update\": {\n                \"x\": {\"field\": \"x\"},\n                \"y\": {\"field\": \"y\"},\n                \"text\": {\"signal\": \"datum.r > 15 ? datum.name : ''\"},\n                \"fontSize\": {\"signal\": \"datum.r > 30 ? 12 : datum.r > 20 ? 10 : 8\"},\n                \"opacity\": {\"signal\": \"datum.r > 15 ? 1 : 0\"}\n              }\n            }\n          }\n        ]\n      };\n\n      const chartId = `circlepacking_${invocation.address.replace(/[^A-Za-z0-9]/g, \"_\")}`;\n      createChart(spec, \"circlepacking\", chartId)\n        .then(() => resolve(\"Circle Packing\"))\n        .catch((error) => resolve(`Error: ${error.message}`));\n\n    } catch (error) {\n      resolve(`Error: ${error.message}`);\n    }\n  });\n}\n\n/**\n * CIRCULARBAR custom function\n * Creates a circular bar chart from Excel data range\n * \n * @customfunction\n * @requiresAddress\n * @param {any[][]} data The data range including headers\n * @param {CustomFunctions.Invocation} invocation Invocation object\n * @returns {string} Status message\n */\nfunction CIRCULARBAR(data, invocation) {\n  return new Promise((resolve) => {\n    try {\n      if (!data || data.length < 2) {\n        resolve(\"Error: Need at least header row + one data row\");\n        return;\n      }\n      const headers = data[0];\n      const rows = data.slice(1);\n      if (headers.length < 2) {\n        resolve(\"Error: Polar bar chart requires 2 columns (Category, Value)\");\n        return;\n      }\n      \n      // Convert rows -> objects with polar coordinates\n      const processedData = rows.map((row, i) => {\n        let obj = {};\n        headers.forEach((h, idx) => {\n          obj[h] = row[idx];\n        });\n        \n        // Calculate circular bar positions\n        const n = rows.length;\n        const anglePerBar = 360 / n;\n        const theta = i * anglePerBar;\n        const barWidth = anglePerBar * 0.7; // 70% width with gaps\n        \n        obj.theta = theta;\n        obj.thetaStart = theta - barWidth / 2;\n        obj.thetaEnd = theta + barWidth / 2;\n        \n        return obj;\n      });\n      \n      // Circular bar chart specification\n      const spec = {\n        $schema: \"https://vega.github.io/schema/vega-lite/v6.json\",\n        description: \"Circular bar chart from Excel selection\",\n        background: \"white\",\n        config: { \n          view: { stroke: \"transparent\" },\n          font: \"Segoe UI\"\n        },\n        data: { values: processedData },\n        layer: [{\n          mark: { \n            type: \"arc\", \n            stroke: \"#fff\",\n            strokeWidth: 2,\n            opacity: 0.7\n          },\n          encoding: {\n            theta: { \n              field: \"thetaStart\", \n              type: \"quantitative\",\n              scale: { domain: [0, 360], type: \"linear\" },\n              stack: null\n            },\n            theta2: { \n              field: \"thetaEnd\",\n              type: \"quantitative\"\n            },\n            radius: { \n              field: headers[1], \n              type: \"quantitative\",\n              scale: { type: \"linear\", zero: true, rangeMin: 20 }\n            },\n            radius2: { value: 20 },\n            color: { \n              field: headers[0], \n              type: \"nominal\",\n              scale: { scheme: \"tableau20\" },\n              legend: { \n                title: headers[0], \n                titleFontSize: 12, \n                labelFontSize: 11, \n                orient: \"right\" \n              }\n            },\n            tooltip: [\n              { field: headers[0], type: \"nominal\" },\n              { field: headers[1], type: \"quantitative\" }\n            ]\n          }\n        }, {\n          mark: { \n            type: \"text\", \n            radiusOffset: 15,\n            fontSize: 10\n          },\n          encoding: {\n            theta: { \n              field: \"theta\", \n              type: \"quantitative\",\n              scale: { domain: [0, 360], type: \"linear\" }\n            },\n            radius: { \n              field: headers[1], \n              type: \"quantitative\",\n              scale: { type: \"linear\", zero: true, rangeMin: 20 }\n            },\n            text: { field: headers[1], type: \"quantitative\" },\n            color: { value: \"#323130\" }\n          }\n        }]\n      };\n      \n      const chartId = `circularbar_${invocation.address.replace(/[^A-Za-z0-9]/g, \"_\")}`;\n      createChart(spec, \"circularbar\", chartId)\n        .then(() => resolve(\"Circular Bar\"))\n        .catch((error) => resolve(`Error: ${error.message}`));\n    } catch (error) {\n      resolve(`Error: ${error.message}`);\n    }\n  });\n}\n\n/**\n * AREA custom function\n * Creates an area chart from Excel data range\n * \n * @customfunction\n * @requiresAddress\n * @param {any[][]} data The data range including headers\n * @param {CustomFunctions.Invocation} invocation Invocation object\n * @returns {string} Status message\n */\nfunction AREA(data, invocation) {\n  return new Promise((resolve) => {\n    try {\n      if (!data || data.length < 2) {\n        resolve(\"Error: Need at least header row + one data row\");\n        return;\n      }\n      const headers = data[0];\n      const rows = data.slice(1);\n      // Convert rows -> objects (same as taskpane.js)\n      const processedData = rows.map(row => {\n        let obj = {};\n        headers.forEach((h, i) => {\n          obj[h] = row[i];\n        });\n        return obj;\n      });\n      // Use EXACT specification from taskpane.js area chart with gradient\n      const spec = {\n        $schema: \"https://vega.github.io/schema/vega-lite/v6.json\",\n        description: \"Area chart from Excel selection\",\n        background: \"white\",\n        data: { values: processedData },\n        mark: { \n          type: \"area\", \n          tooltip: true,\n          line: {\n            color: \"#0078d4\"\n          },\n          color: {\n            x1: 1,\n            y1: 1,\n            x2: 1,\n            y2: 0,\n            gradient: \"linear\",\n            stops: [\n              {\n                offset: 0,\n                color: \"white\"\n              },\n              {\n                offset: 1,\n                color: \"#0078d4\"\n              }\n            ]\n          }\n        },\n        encoding: {\n          x: { \n            field: headers[0], \n            type: \"ordinal\",\n            axis: {\n              title: headers[0],\n              labelFontSize: 12,\n              titleFontSize: 14\n            }\n          },\n          y: { \n            field: headers[1], \n            type: \"quantitative\",\n            axis: {\n              title: headers[1],\n              labelFontSize: 12,\n              titleFontSize: 14\n            }\n          },\n          // Add color encoding for multiple areas if 3rd column exists\n          ...(headers.length >= 3 && {\n            color: { \n              field: headers[2], \n              type: \"nominal\",\n              legend: {\n                title: headers[2],\n                titleFontSize: 12,\n                labelFontSize: 11\n              }\n            }\n          })\n        },\n        config: {\n          view: { stroke: \"transparent\" },\n          font: \"Segoe UI\",\n          axis: {\n            labelColor: \"#605e5c\",\n            titleColor: \"#323130\",\n            gridColor: \"#f3f2f1\"\n          },\n          legend: {\n            titleColor: \"#323130\",\n            labelColor: \"#605e5c\"\n          }\n        }\n      };\n      const chartId = `area_${invocation.address.replace(/[^A-Za-z0-9]/g, \"_\")}`;\n      createChart(spec, \"area\", chartId)\n        .then(() => resolve(\"Area\"))\n        .catch((error) => resolve(`Error: ${error.message}`));\n    } catch (error) {\n      resolve(`Error: ${error.message}`);\n    }\n  });\n}\n\n/**\n * STREAMGRAPH custom function\n * Creates a streamgraph chart from Excel data range\n * \n * @customfunction\n * @requiresAddress\n * @param {any[][]} data The data range including headers\n * @param {CustomFunctions.Invocation} invocation Invocation object\n * @returns {string} Status message\n */\nfunction STREAMGRAPH(data, invocation) {\n  return new Promise((resolve) => {\n    try {\n      if (!data || data.length < 2) {\n        resolve(\"Error: Need at least header row + one data row\");\n        return;\n      }\n\n      const headers = data[0];\n      const rows = data.slice(1);\n\n      if (headers.length < 3) {\n        resolve(\"Error: Streamgraph requires 3 columns (Time/Date, Series/Category, Values)\");\n        return;\n      }\n\n      // Convert rows -> objects and detect data type for X-axis\n      let xAxisType = \"ordinal\"; // Default to ordinal for simple values like years\n      const processedData = rows.map(row => {\n        let obj = {};\n        headers.forEach((h, i) => {\n          obj[h] = row[i];\n        });\n        \n        // Check if first column looks like dates that need conversion\n        const firstColValue = obj[headers[0]];\n        if (typeof firstColValue === 'number' && firstColValue > 25569) {\n          // Handle Excel date serial numbers\n          obj[headers[0]] = new Date((firstColValue - 25569) * 86400 * 1000);\n          xAxisType = \"temporal\";\n        } else if (typeof firstColValue === 'string' && firstColValue.includes('-')) {\n          // Try to parse string dates (e.g., \"2020-01-01\")\n          const parsedDate = new Date(firstColValue);\n          if (!isNaN(parsedDate.getTime())) {\n            obj[headers[0]] = parsedDate;\n            xAxisType = \"temporal\";\n          }\n        }\n        // For simple values like 2020, 2021, keep as-is and use ordinal\n        \n        return obj;\n      });\n\n      // Create axis configuration based on detected type\n      const xAxisConfig = xAxisType === \"temporal\" ? {\n        field: headers[0],\n        type: \"temporal\",\n        axis: {\n          domain: false,\n          format: \"%Y-%m\",\n          tickSize: 0,\n          title: headers[0],\n          labelFontSize: 11,\n          titleFontSize: 12,\n          labelColor: \"#605e5c\",\n          titleColor: \"#323130\",\n          labelAngle: -45\n        }\n      } : {\n        field: headers[0],\n        type: \"ordinal\",\n        axis: {\n          domain: false,\n          tickSize: 0,\n          title: headers[0],\n          labelFontSize: 11,\n          titleFontSize: 12,\n          labelColor: \"#605e5c\",\n          titleColor: \"#323130\"\n        }\n      };\n\n      // Use Vega-Lite specification for streamgraph\n      const spec = {\n        $schema: \"https://vega.github.io/schema/vega-lite/v6.json\",\n        width: 600,\n        height: 400,\n        background: \"white\",\n        config: { view: { stroke: \"transparent\" }},\n        description: \"Streamgraph from Excel selection\",\n        data: { values: processedData },\n        mark: {\n          type: \"area\",\n          tooltip: true,\n          interpolate: \"basis\",\n          opacity: 0.8\n        },\n        encoding: {\n          x: xAxisConfig,\n          y: {\n            aggregate: \"sum\",\n            field: headers[2],\n            type: \"quantitative\",\n            axis: null,\n            stack: \"center\"\n          },\n          color: {\n            field: headers[1],\n            type: \"nominal\",\n            scale: { scheme: \"category20b\" },\n            legend: {\n              title: headers[1],\n              titleFontSize: 12,\n              labelFontSize: 11,\n              orient: \"right\"\n            }\n          },\n          tooltip: [\n            { \n              field: headers[0], \n              type: xAxisType === \"temporal\" ? \"temporal\" : \"ordinal\", \n              title: \"Period\",\n              format: xAxisType === \"temporal\" ? \"%Y-%m-%d\" : undefined\n            },\n            { field: headers[1], type: \"nominal\", title: \"Series\" },\n            { field: headers[2], type: \"quantitative\", title: \"Value\", format: \",.0f\" }\n          ]\n        },\n        config: {\n          font: \"Segoe UI\",\n          legend: {\n            titleColor: \"#323130\",\n            labelColor: \"#605e5c\"\n          }\n        }\n      };\n\n      const chartId = `streamgraph_${invocation.address.replace(/[^A-Za-z0-9]/g, \"_\")}`;\n      createChart(spec, \"streamgraph\", chartId)\n        .then(() => resolve(\"Streamgraph\"))\n        .catch((error) => resolve(`Error: ${error.message}`));\n\n    } catch (error) {\n      resolve(`Error: ${error.message}`);\n    }\n  });\n}\n\n/**\n * SCATTER custom function\n * Creates a scatter plot from Excel data range\n * \n * @customfunction\n * @requiresAddress\n * @param {any[][]} data The data range including headers\n * @param {CustomFunctions.Invocation} invocation Invocation object\n * @returns {string} Status message\n */\nfunction SCATTER(data, invocation) {\n  return new Promise((resolve) => {\n    try {\n      if (!data || data.length < 2) {\n        resolve(\"Error: Need at least header row + one data row\");\n        return;\n      }\n\n      const headers = data[0];\n      const rows = data.slice(1);\n\n      if (headers.length < 2) {\n        resolve(\"Error: Scatter plot requires at least 2 columns (X, Y values)\");\n        return;\n      }\n\n      // Convert rows -> objects (same as taskpane.js)\n      const processedData = rows.map(row => {\n        let obj = {};\n        headers.forEach((h, i) => {\n          obj[h] = row[i];\n        });\n        return obj;\n      });\n\n      // Use EXACT specification from taskpane.js point chart\n      const spec = {\n        $schema: \"https://vega.github.io/schema/vega-lite/v6.json\",\n        description: \"Scatter plot from Excel selection\",\n        background: \"white\",\n        config: { view: { stroke: \"transparent\" }},\n        data: { values: processedData },\n        mark: { type: \"point\", size: 100, tooltip: true },\n        encoding: {\n          x: { \n            field: headers[0], \n            type: \"quantitative\",\n            scale: { zero: false },\n            axis: {\n              title: headers[0],\n              labelFontSize: 12,\n              titleFontSize: 14\n            }\n          },\n          y: { \n            field: headers[1], \n            type: \"quantitative\",\n            scale: { zero: false },\n            axis: {\n              title: headers[1],\n              labelFontSize: 12,\n              titleFontSize: 14\n            }\n          },\n          // Add color encoding if 3rd column exists\n          ...(headers.length >= 3 && {\n            color: { \n              field: headers[2], \n              type: \"nominal\",\n              legend: {\n                title: headers[2],\n                titleFontSize: 12,\n                labelFontSize: 11\n              }\n            }\n          }),\n          // Add shape encoding if 4th column exists\n          ...(headers.length >= 4 && {\n            shape: { \n              field: headers[3], \n              type: \"nominal\",\n              legend: {\n                title: headers[3],\n                titleFontSize: 12,\n                labelFontSize: 11\n              }\n            }\n          })\n        },\n        config: {\n          font: \"Segoe UI\",\n          axis: {\n            labelColor: \"#605e5c\",\n            titleColor: \"#323130\",\n            gridColor: \"#f3f2f1\"\n          },\n          legend: {\n            titleColor: \"#323130\",\n            labelColor: \"#605e5c\"\n          }\n        }\n      };\n      const chartId = `scatter_${invocation.address.replace(/[^A-Za-z0-9]/g, \"_\")}`;\n      createChart(spec, \"scatter\", chartId)\n        .then(() => resolve(\"Scatter\"))\n        .catch((error) => resolve(`Error: ${error.message}`));\n\n    } catch (error) {\n      resolve(`Error: ${error.message}`);\n    }\n  });\n}\n\n/**\n * BUBBLE custom function\n * Creates a bubble chart from Excel data range\n * \n * @customfunction\n * @requiresAddress\n * @param {any[][]} data The data range including headers\n * @param {CustomFunctions.Invocation} invocation Invocation object\n * @returns {string} Status message\n */\nfunction BUBBLE(data, invocation) {\n  return new Promise((resolve) => {\n    try {\n      if (!data || data.length < 2) {\n        resolve(\"Error: Need at least header row + one data row\");\n        return;\n      }\n\n      const headers = data[0];\n      const rows = data.slice(1);\n\n      if (headers.length < 3) {\n        resolve(\"Error: Bubble chart requires at least 3 columns (X values, Y values, Size values)\");\n        return;\n      }\n\n      // Convert rows -> objects (same as taskpane.js)\n      const processedData = rows.map(row => {\n        let obj = {};\n        headers.forEach((h, i) => {\n          obj[h] = row[i];\n        });\n        return obj;\n      });\n\n      // Use EXACT specification from taskpane.js bubble chart\n      const spec = {\n        $schema: \"https://vega.github.io/schema/vega-lite/v6.json\",\n        description: \"Bubble chart from Excel selection\",\n        background: \"white\",\n        config: { view: { stroke: \"transparent\" }},\n        data: { values: processedData },\n        mark: { type: \"circle\", tooltip: true, opacity: 0.7 },\n        encoding: {\n          x: { \n            field: headers[0], \n            type: \"quantitative\",\n            scale: { zero: false },\n            axis: {\n              title: headers[0],\n              labelFontSize: 12,\n              titleFontSize: 14\n            }\n          },\n          y: { \n            field: headers[1], \n            type: \"quantitative\",\n            scale: { zero: false },\n            axis: {\n              title: headers[1],\n              labelFontSize: 12,\n              titleFontSize: 14\n            }\n          },\n          size: {\n            field: headers[2],\n            type: \"quantitative\",\n            scale: {\n              type: \"linear\",\n              range: [100, 1000]\n            },\n            legend: {\n              title: headers[2],\n              titleFontSize: 12,\n              labelFontSize: 11\n            }\n          },\n          // Add color encoding if 4th column exists\n          ...(headers.length >= 4 && {\n            color: { \n              field: headers[3], \n              type: \"nominal\",\n              legend: {\n                title: headers[3],\n                titleFontSize: 12,\n                labelFontSize: 11\n              }\n            }\n          })\n        },\n        config: {\n          font: \"Segoe UI\",\n          axis: {\n            labelColor: \"#605e5c\",\n            titleColor: \"#323130\",\n            gridColor: \"#f3f2f1\"\n          },\n          legend: {\n            titleColor: \"#323130\",\n            labelColor: \"#605e5c\"\n          }\n        }\n      };\n      const chartId = `bubble_${invocation.address.replace(/[^A-Za-z0-9]/g, \"_\")}`;\n      createChart(spec, \"bubble\", chartId)\n        .then(() => resolve(\"Bubble\"))\n        .catch((error) => resolve(`Error: ${error.message}`));\n\n    } catch (error) {\n      resolve(`Error: ${error.message}`);\n    }\n  });\n}\n\n/**\n * RING custom function\n * Creates a ring chart from Excel data range\n * \n * @customfunction\n * @requiresAddress\n * @param {any[][]} data The data range including headers\n * @param {CustomFunctions.Invocation} invocation Invocation object\n * @returns {string} Status message\n */\nfunction RING(data, invocation) {\n  return new Promise((resolve) => {\n    try {\n      if (!data || data.length < 2) {\n        resolve(\"Error: Need at least header row + one data row\");\n        return;\n      }\n\n      const headers = data[0];\n      const rows = data.slice(1);\n\n      if (headers.length < 2) {\n        resolve(\"Error: Ring chart requires 2 columns: Category, Value\");\n        return;\n      }\n\n      // Convert rows -> objects (same as taskpane.js)\n      const processedData = rows.map(row => {\n        let obj = {};\n        headers.forEach((h, i) => {\n          obj[h] = row[i];\n        });\n        return obj;\n      });\n\n      const numRings = processedData.length;\n      if (numRings === 0) {\n        resolve(\"Error: Ring chart requires at least one data row\");\n        return;\n      }\n\n      // Dynamic ring parameters based on number of rings\n      const ringWidth = Math.max(15, Math.min(25, 120 / numRings));\n      const ringGap = Math.max(3, Math.min(8, 40 / numRings));\n      const maxRadius = 150 + (numRings * 5);\n\n      // Generate colors dynamically\n      const generateRingColor = (index, total) => {\n        const baseHue = 210; // Blue base\n        const saturation = Math.max(50, 80 - (index * 5));\n        const lightness = Math.max(25, 60 - (index * 8));\n        return `hsl(${baseHue}, ${saturation}%, ${lightness}%)`;\n      };\n\n      // Transform data for the chart\n      const transformedData = processedData.map((d, index) => ({\n        [`__${index}__`]: d[headers[0]], // Category\n        [`__${index + 100}__`]: d[headers[1]], // Value\n        [`Ring${index + 1}_Theta2`]: 2 * Math.PI * d[headers[1]] / 100,\n        [`Ring${index + 1}_Percent_Label`]: d[headers[1]] + '%'\n      }));\n\n      // Flatten into single object\n      const chartData = [Object.assign({}, ...transformedData)];\n\n      // Calculate ring positions\n      const ringPositions = [];\n      let currentOuter = maxRadius;\n      for (let i = 0; i < numRings; i++) {\n        const outer = currentOuter;\n        const inner = outer - ringWidth;\n        const middle = (outer + inner) / 2;\n        ringPositions.push({ outer, inner, middle });\n        currentOuter = inner - ringGap;\n      }\n\n      // Calculate legend dimensions and positioning\n      const legendWidth = 100; // Fixed width for legend area\n      const legendItemHeight = 25; // Height per legend item\n      const totalLegendHeight = numRings * legendItemHeight;\n      const chartCenterY = maxRadius + 50; // Y center of the chart\n      const legendStartY = chartCenterY - (totalLegendHeight / 2); // Center legend relative to chart center\n\n      // Use EXACT specification from taskpane.js ring chart with right-side legend\n      const spec = {\n        \"$schema\": \"https://vega.github.io/schema/vega-lite/v5.json\",\n        \"config\": {\n          \"autosize\": {\n            \"type\": \"pad\",\n            \"resize\": true\n          },\n          \"concat\": {\"spacing\": 20} // Spacing between chart and legend\n        },\n        \"description\": `Dynamic ring chart with ${numRings} concentric rings`,\n        \"background\": \"white\",\n        \"data\": {\"values\": chartData},\n        \"hconcat\": [\n          {\n            \"description\": \"RINGS - Main Chart\",\n            \"width\": (maxRadius + 50) * 2,\n            \"height\": (maxRadius + 50) * 2,\n            \"view\": {\"stroke\": null},\n            \"layer\": [\n              // Background rings (full circles) - centered\n              ...processedData.map((d, index) => ({\n                \"description\": `RING ${index + 1} BACKGROUND`,\n                \"mark\": {\n                  \"type\": \"arc\",\n                  \"radius\": ringPositions[index].outer,\n                  \"radius2\": ringPositions[index].inner,\n                  \"theta\": 0,\n                  \"theta2\": 6.283185307179586, // 2\n                  \"opacity\": 0.25,\n                  \"x\": maxRadius + 50,\n                  \"y\": maxRadius + 50\n                },\n                \"encoding\": {\n                  \"color\": {\"value\": generateRingColor(index, numRings)}\n                }\n              })),\n              // Progress rings - centered\n              ...processedData.map((d, index) => ({\n                \"description\": `RING ${index + 1} PROGRESS`,\n                \"mark\": {\n                  \"type\": \"arc\",\n                  \"radius\": ringPositions[index].outer,\n                  \"radius2\": ringPositions[index].inner,\n                  \"theta\": 0,\n                  \"theta2\": {\"expr\": `datum['Ring${index + 1}_Theta2']`},\n                  \"cornerRadius\": Math.min(8, ringWidth / 2),\n                  \"tooltip\": true,\n                  \"x\": maxRadius + 50,\n                  \"y\": maxRadius + 50\n                },\n                \"encoding\": {\n                  \"color\": {\"value\": generateRingColor(index, numRings)},\n                  \"tooltip\": [\n                    {\"value\": d[headers[0]], \"title\": \"Category\"},\n                    {\"value\": d[headers[1]] + \"%\", \"title\": \"Progress\"}\n                  ]\n                }\n              })),\n              // White percentage labels slightly to the right - centered\n              ...processedData.map((d, index) => ({\n                \"description\": `RING ${index + 1} LABEL`,\n                \"mark\": {\n                  \"type\": \"text\",\n                  \"align\": \"center\",\n                  \"baseline\": \"middle\",\n                  \"x\": maxRadius + 50 + 15, // Center + offset to right\n                  \"y\": maxRadius + 50 - ringPositions[index].middle, // Center + offset up\n                  \"fontSize\": Math.max(10, Math.min(14, 180 / numRings)),\n                  \"font\": \"Segoe UI\",\n                  \"fontWeight\": \"bold\",\n                  \"color\": \"white\"\n                },\n                \"encoding\": {\n                  \"text\": {\"value\": d[headers[1]] + \"%\"},\n                  \"opacity\": {\n                    \"condition\": {\n                      \"test\": `datum['Ring${index + 1}_Theta2'] > 0`,\n                      \"value\": 1\n                    },\n                    \"value\": 0\n                  }\n                }\n              }))\n            ]\n          },\n          {\n            \"description\": \"LEGEND - Right Side\",\n            \"width\": legendWidth,\n            \"height\": (maxRadius + 50) * 2, // Match chart height exactly\n            \"view\": {\"stroke\": null},\n            \"layer\": processedData.map((d, index) => [\n              {\n                \"description\": `LEGEND CIRCLE ${index + 1}`,\n                \"mark\": {\n                  \"type\": \"circle\",\n                  \"size\": 150,\n                  \"x\": 15, // Fixed position from left edge\n                  \"y\": legendStartY + (index * legendItemHeight),\n                  \"color\": generateRingColor(index, numRings)\n                }\n              },\n              {\n                \"description\": `LEGEND LABEL ${index + 1}`,\n                \"mark\": {\n                  \"type\": \"text\",\n                  \"x\": 35, // Positioned to the right of the circle\n                  \"y\": legendStartY + (index * legendItemHeight),\n                  \"align\": \"left\",\n                  \"baseline\": \"middle\",\n                  \"fontSize\": 11,\n                  \"font\": \"Segoe UI\"\n                },\n                \"encoding\": {\n                  \"text\": {\"value\": d[headers[0]]}\n                }\n              }\n            ]).flat()\n          }\n        ],\n        \"view\": {\"stroke\": null}\n      };\n      const chartId = `ring_${invocation.address.replace(/[^A-Za-z0-9]/g, \"_\")}`;\n      createChart(spec, \"ring\", chartId)\n        .then(() => resolve(\"Ring\"))\n        .catch((error) => resolve(`Error: ${error.message}`));\n\n    } catch (error) {\n      resolve(`Error: ${error.message}`);\n    }\n  });\n}\n\n/**\n * RADIAL custom function\n * Creates a radial chart from Excel data range\n * \n * @customfunction\n * @requiresAddress\n * @param {any[][]} data The data range including headers\n * @param {CustomFunctions.Invocation} invocation Invocation object\n * @returns {string} Status message\n */\nfunction RADIAL(data, invocation) {\n  return new Promise((resolve) => {\n    try {\n      if (!data || data.length < 2) {\n        resolve(\"Error: Need at least header row + one data row\");\n        return;\n      }\n\n      const headers = data[0];\n      const rows = data.slice(1);\n\n      if (headers.length < 2) {\n        resolve(\"Error: Radial chart requires 2 columns (Category, Value)\");\n        return;\n      }\n\n      // Convert rows -> objects (same as taskpane.js)\n      const processedData = rows.map(row => {\n        let obj = {};\n        headers.forEach((h, i) => {\n          obj[h] = row[i];\n        });\n        return obj;\n      });\n\n      // Use EXACT specification from taskpane.js radial chart\n      const spec = {\n        $schema: \"https://vega.github.io/schema/vega-lite/v6.json\",\n        description: \"Radial chart from Excel selection\",\n        background: \"white\",\n        config: { view: { stroke: \"transparent\" }},\n        data: { values: processedData },\n        transform: [\n            { \n                window: [{ op: \"rank\", as: \"sortOrder\" }],\n                sort: [{ field: headers[1], order: \"descending\" }]\n            }\n  \t    ],\n        layer: [{\n          mark: { type: \"arc\", innerRadius: 20, stroke: \"#fff\" }\n        }, {\n          mark: { type: \"text\", radiusOffset: 10 },\n          encoding: {\n            text: { field: headers[1], type: \"quantitative\" }\n          }\n        }],\n        encoding: {\n          theta: { field: headers[1], type: \"quantitative\", stack: true },\n          radius: { \n            field: headers[1], \n            scale: { type: \"sqrt\", zero: true, rangeMin: 20 }\n          },\n          color: { field: headers[0], type: \"nominal\", legend: { title: headers[0], titleFontSize: 12, labelFontSize: 11, orient: \"right\" } },\n\t      order: { field: \"sortOrder\", type: \"quantitative\" }\n        }\n      };\n      const chartId = `radial_${invocation.address.replace(/[^A-Za-z0-9]/g, \"_\")}`;\n      createChart(spec, \"radial\", chartId)\n        .then(() => resolve(\"Radial\"))\n        .catch((error) => resolve(`Error: ${error.message}`));\n\n    } catch (error) {\n      resolve(`Error: ${error.message}`);\n    }\n  });\n}\n\n/**\n * BOX custom function\n * Creates a box plot from Excel data range\n * \n * @customfunction\n * @requiresAddress\n * @param {any[][]} data The data range including headers\n * @param {CustomFunctions.Invocation} invocation Invocation object\n * @returns {string} Status message\n */\nfunction BOX(data, invocation) {\n  return new Promise((resolve) => {\n    try {\n      if (!data || data.length < 2) {\n        resolve(\"Error: Need at least header row + one data row\");\n        return;\n      }\n\n      const headers = data[0];\n      const rows = data.slice(1);\n\n      if (headers.length < 2) {\n        resolve(\"Error: Box plot requires 2 columns (Category, Values)\");\n        return;\n      }\n\n      // Expect headers: Category | Value (same as taskpane.js)\n      const processedData = rows\n        .filter(r => r[0] && !isNaN(+r[1]))\n        .map(r => ({\n          category: r[0],\n          value: +r[1]\n        }));\n\n      if (processedData.length === 0) {\n        resolve(\"Error: No valid numeric data found for box plot\");\n        return;\n      }\n\n      // Use EXACT specification from taskpane.js box chart\n      const spec = {\n        $schema: \"https://vega.github.io/schema/vega-lite/v6.json\",\n        description: \"Box plot from Excel selection\",\n        data: { values: processedData },\n        mark: {\n          type: \"boxplot\",\n          extent: \"min-max\"   // show whiskers from min to max\n        },\n        encoding: {\n          x: { field: \"category\", type: \"nominal\" },\n          y: {\n            field: \"value\",\n            type: \"quantitative\",\n            scale: { zero: false }\n          },\n          color: {\n            field: \"category\",\n            type: \"nominal\",\n            legend: null\n          }\n        }\n      };\n      const chartId = `box_${invocation.address.replace(/[^A-Za-z0-9]/g, \"_\")}`;\n      createChart(spec, \"box\", chartId)\n        .then(() => resolve(\"Box\"))\n        .catch((error) => resolve(`Error: ${error.message}`));\n\n    } catch (error) {\n      resolve(`Error: ${error.message}`);\n    }\n  });\n}\n\n/**\n * RADAR custom function\n * Creates a radar chart from Excel data range\n * \n * @customfunction\n * @requiresAddress\n * @param {any[][]} data The data range including headers\n * @param {CustomFunctions.Invocation} invocation Invocation object\n * @returns {string} Status message\n */\nfunction RADAR(data, invocation) {\n  return new Promise((resolve) => {\n    try {\n      if (!data || data.length < 2) {\n        resolve(\"Error: Need at least header row + one data row\");\n        return;\n      }\n\n      const headers = data[0];\n      const rows = data.slice(1);\n\n      if (headers.length < 3) {\n        resolve(\"Error: Radar chart requires at least 3 columns (Series, Dimension1, Dimension2, ...)\");\n        return;\n      }\n\n      const radarData = [];\n      const dimensions = headers.slice(1); // All columns except first are dimensions\n      \n      rows.forEach((row, seriesIndex) => {\n        const seriesName = row[headers[0]] || `Series ${seriesIndex + 1}`;\n        \n        dimensions.forEach(dimension => {\n          const value = parseFloat(row[headers.indexOf(dimension)]) || 0;\n          radarData.push({\n            series: seriesName,\n            dimension: dimension,\n            value: value,\n            category: seriesIndex\n          });\n        });\n      });\n\n      // Get unique dimensions for grid\n      const uniqueDimensions = [...new Set(radarData.map(d => d.dimension))];\n\n      // Use EXACT specification from taskpane.js radar chart\n      const spec = {\n        $schema: \"https://vega.github.io/schema/vega/v6.json\",\n        description: \"Radar chart from Excel selection\",\n        width: 400,\n        height: 400,\n        padding: 60,\n        autosize: {\"type\": \"none\", \"contains\": \"padding\"},\n        background: \"white\",\n        config: { view: { stroke: \"transparent\" }},\n\n        signals: [\n          {\"name\": \"radius\", \"update\": \"width / 2\"}\n        ],\n\n        data: [\n          {\n            name: \"table\",\n            values: radarData\n          },\n          {\n            name: \"dimensions\",\n            values: uniqueDimensions.map(d => ({dimension: d}))\n          }\n        ],\n\n        scales: [\n          {\n            name: \"angular\",\n            type: \"point\",\n            range: {\"signal\": \"[-PI, PI]\"},\n            padding: 0.5,\n            domain: uniqueDimensions\n          },\n          {\n            name: \"radial\",\n            type: \"linear\",\n            range: {\"signal\": \"[0, radius]\"},\n            zero: true,\n            nice: true,\n            domain: {\"data\": \"table\", \"field\": \"value\"},\n            domainMin: 0\n          },\n          {\n            name: \"color\",\n            type: \"ordinal\",\n            domain: {\"data\": \"table\", \"field\": \"category\"},\n            range: [\n              \"#0078d4\", \"#00bcf2\", \"#40e0d0\", \"#00cc6a\", \"#10893e\",\n              \"#107c10\", \"#bad80a\", \"#ffb900\", \"#ff8c00\", \"#d13438\"\n            ]\n          }\n        ],\n\n        encode: {\n          enter: {\n            x: {\"signal\": \"radius\"},\n            y: {\"signal\": \"radius\"}\n          }\n        },\n\n        marks: [\n          {\n            type: \"group\",\n            name: \"categories\",\n            zindex: 1,\n            from: {\n              facet: {\"data\": \"table\", \"name\": \"facet\", \"groupby\": [\"category\", \"series\"]}\n            },\n            marks: [\n              {\n                type: \"line\",\n                name: \"category-line\",\n                from: {\"data\": \"facet\"},\n                encode: {\n                  enter: {\n                    interpolate: {\"value\": \"linear-closed\"},\n                    x: {\"signal\": \"scale('radial', datum.value) * cos(scale('angular', datum.dimension))\"},\n                    y: {\"signal\": \"scale('radial', datum.value) * sin(scale('angular', datum.dimension))\"},\n                    stroke: {\"scale\": \"color\", \"field\": \"category\"},\n                    strokeWidth: {\"value\": 2},\n                    fill: {\"scale\": \"color\", \"field\": \"category\"},\n                    fillOpacity: {\"value\": 0.1},\n                    strokeOpacity: {\"value\": 0.8}\n                  }\n                }\n              },\n              {\n                type: \"symbol\",\n                name: \"category-points\",\n                from: {\"data\": \"facet\"},\n                encode: {\n                  enter: {\n                    x: {\"signal\": \"scale('radial', datum.value) * cos(scale('angular', datum.dimension))\"},\n                    y: {\"signal\": \"scale('radial', datum.value) * sin(scale('angular', datum.dimension))\"},\n                    size: {\"value\": 50},\n                    fill: {\"scale\": \"color\", \"field\": \"category\"},\n                    stroke: {\"value\": \"white\"},\n                    strokeWidth: {\"value\": 1}\n                  }\n                }\n              }\n            ]\n          },\n          {\n            type: \"rule\",\n            name: \"radial-grid\",\n            from: {\"data\": \"dimensions\"},\n            zindex: 0,\n            encode: {\n              enter: {\n                x: {\"value\": 0},\n                y: {\"value\": 0},\n                x2: {\"signal\": \"radius * cos(scale('angular', datum.dimension))\"},\n                y2: {\"signal\": \"radius * sin(scale('angular', datum.dimension))\"},\n                stroke: {\"value\": \"#e1e4e8\"},\n                strokeWidth: {\"value\": 1}\n              }\n            }\n          },\n          {\n            type: \"text\",\n            name: \"dimension-label\",\n            from: {\"data\": \"dimensions\"},\n            zindex: 1,\n            encode: {\n              enter: {\n                x: {\"signal\": \"(radius + 20) * cos(scale('angular', datum.dimension))\"},\n                y: {\"signal\": \"(radius + 20) * sin(scale('angular', datum.dimension))\"},\n                text: {\"field\": \"dimension\"},\n                align: [\n                  {\n                    test: \"abs(scale('angular', datum.dimension)) > PI / 2\",\n                    value: \"right\"\n                  },\n                  {\n                    value: \"left\"\n                  }\n                ],\n                baseline: [\n                  {\n                    test: \"scale('angular', datum.dimension) > 0\", \n                    value: \"top\"\n                  },\n                  {\n                    test: \"scale('angular', datum.dimension) == 0\", \n                    value: \"middle\"\n                  },\n                  {\n                    value: \"bottom\"\n                  }\n                ],\n                fill: {\"value\": \"#323130\"},\n                fontWeight: {\"value\": \"bold\"},\n                font: {\"value\": \"Segoe UI\"},\n                fontSize: {\"value\": 12}\n              }\n            }\n          },\n          {\n            type: \"line\",\n            name: \"outer-line\",\n            from: {\"data\": \"radial-grid\"},\n            encode: {\n              enter: {\n                interpolate: {\"value\": \"linear-closed\"},\n                x: {\"field\": \"x2\"},\n                y: {\"field\": \"y2\"},\n                stroke: {\"value\": \"#8a8886\"},\n                strokeWidth: {\"value\": 2},\n                strokeOpacity: {\"value\": 0.6}\n              }\n            }\n          }\n        ]\n      };\n      const chartId = `radar_${invocation.address.replace(/[^A-Za-z0-9]/g, \"_\")}`;\n      createChart(spec, \"radar\", chartId)\n        .then(() => resolve(\"Radar\"))\n        .catch((error) => resolve(`Error: ${error.message}`));\n\n    } catch (error) {\n      resolve(`Error: ${error.message}`);\n    }\n  });\n}\n\n/**\n * WATERFALL custom function\n * Creates a waterfall chart from Excel data range\n * \n * @customfunction\n * @requiresAddress\n * @param {any[][]} data The data range including headers\n * @param {CustomFunctions.Invocation} invocation Invocation object\n * @returns {string} Status message\n */\nfunction WATERFALL(data, invocation) {\n  return new Promise((resolve) => {\n    try {\n      if (!data || data.length < 2) {\n        resolve(\"Error: Need at least header row + one data row\");\n        return;\n      }\n\n      const headers = data[0];\n      const rows = data.slice(1);\n\n      if (headers.length < 3) {\n        resolve(\"Error: Waterfall chart requires 3 columns (Category, Amount, Type)\");\n        return;\n      }\n\n      // Convert rows -> objects (same as taskpane.js)\n      const processedDataRaw = rows.map(row => {\n        let obj = {};\n        headers.forEach((h, i) => {\n          obj[h] = row[i];\n        });\n        return obj;\n      });\n\n      // Process waterfall data inline - set last entry's amount to 0 (same as taskpane.js)\n      const processedData = [...processedDataRaw];\n      if (processedData.length > 0) {\n        processedData[processedData.length - 1] = {\n          ...processedData[processedData.length - 1],\n          [headers[1]]: 0\n        };\n      }\n\n      // Calculate dynamic dimensions\n      const numDataPoints = processedDataRaw.length;\n      const dynamicWidth = Math.max(400, Math.min(1600, numDataPoints * 50));\n      const maxAmount = Math.max(...processedDataRaw.map(d => Math.abs(d[headers[1]])));\n      const dynamicHeight = Math.max(300, Math.min(600, maxAmount / 100 + 200));\n\n      // Use EXACT specification from taskpane.js waterfall chart\n      const spec = {\n        $schema: \"https://vega.github.io/schema/vega-lite/v6.json\",\n        description: \"Waterfall chart with multiple subtotals\",\n        background: \"white\",\n        data: { values: processedData },\n        config: { view: { stroke: \"transparent\" }},\n        width: dynamicWidth,\n        height: dynamicHeight,\n        transform: [\n          { \"window\": [{ \"op\": \"sum\", \"field\": headers[1], \"as\": \"sum\" }] },\n          { \"window\": [{ \"op\": \"lead\", \"field\": headers[0], \"as\": \"lead\" }] },\n          {\n            \"calculate\": `datum.lead === null ? datum.${headers[0]} : datum.lead`,\n            \"as\": \"lead\"\n          },\n          {\n            // If total  reset, else  running sum step\n            \"calculate\": `datum.${headers[2]} == 'total' ? 0 : datum.sum - datum.${headers[1]}`,\n            \"as\": \"previous_sum\"\n          },\n          {\n            \"calculate\": `datum.${headers[2]} == 'total' ? datum.sum : datum.${headers[1]}`,\n            \"as\": \"amount\"\n          },\n          {\n            \"calculate\": `datum.${headers[2]} == 'total' ? datum.${headers[1]} / 2 : (datum.sum + datum.previous_sum) / 2`,\n            \"as\": \"center\"\n          },\n          {\n            \"calculate\": `datum.${headers[2]} == 'total' ? datum.sum : (datum.${headers[1]} > 0 ? '+' : '') + datum.${headers[1]}`,\n            \"as\": \"text_amount\"\n          },\n          { \"calculate\": \"(datum.sum + datum.previous_sum) / 2\", \"as\": \"center\" },\n\n          // Add group index for stacked handling\n          {\n            \"window\": [{ \"op\": \"rank\", \"as\": \"group_index\" }],\n            \"frame\": [null, null],\n            \"groupby\": [headers[0]]\n          },\n\n          // Precompute color shades\n          {\n            \"calculate\": `\n            datum.${headers[2]} == 'total'\n                ? '#00B0F0'\n                : datum.amount >= 0\n                ? (datum.group_index == 1 ? '#70AD47'\n                    : (datum.group_index == 2 ? '#8BC97A'\n                    : (datum.group_index == 3 ? '#A7DA9D'\n                    : '#C3EBC0')))\n                : (datum.group_index == 1 ? '#E15759'\n                    : (datum.group_index == 2 ? '#EC7A7C'\n                    : (datum.group_index == 3 ? '#F29C9D'\n                    : '#F8BEBF')))\n            `,\n            \"as\": \"bar_color\"\n          }\n        ],\n        encoding: {\n          x: {\n            field: headers[0],\n            type: \"ordinal\",\n            sort: null,\n            axis: { labelAngle: -45, title: null },\n            scale: { paddingInner: 0.05, paddingOuter: 0.025 }\n          }\n        },\n        layer: [\n          {\n            mark: { type: \"bar\", size: 60},\n            encoding: {\n              y: { field: \"previous_sum\", type: \"quantitative\", title: null },\n              y2: { field: \"sum\" },\n              color: { field: \"bar_color\", type: \"nominal\", scale: null }\n            }\n          },\n          {\n            mark: { type: \"text\", fontWeight: \"bold\", baseline: \"middle\" },\n            encoding: {\n              y: { field: \"center\", type: \"quantitative\" },\n              text: { field: \"text_amount\", type: \"nominal\" },\n              color: {\n                condition: [\n                  { test: `datum.${headers[2]} == 'total'`, value: \"#725a30\" }\n                ],\n                value: \"white\"\n              }\n            }\n          }\n        ],\n        config: { text: { fontWeight: \"bold\", color: \"#D9D9D9\" } }\n      };\n      const chartId = `waterfall_${invocation.address.replace(/[^A-Za-z0-9]/g, \"_\")}`;\n      createChart(spec, \"waterfall\", chartId)\n        .then(() => resolve(\"Waterfall\"))\n        .catch((error) => resolve(`Error: ${error.message}`));\n\n    } catch (error) {\n      resolve(`Error: ${error.message}`);\n    }\n  });\n}\n\n/**\n * SUNBURST custom function\n * Creates a sunburst chart from Excel data range\n * \n * @customfunction\n * @requiresAddress\n * @param {any[][]} data The data range including headers\n * @param {CustomFunctions.Invocation} invocation Invocation object\n * @returns {string} Status message\n */\nfunction SUNBURST(data, invocation) {\n  return new Promise((resolve) => {\n    try {\n      if (!data || data.length < 2) {\n        resolve(\"Error: Need at least header row + one data row\");\n        return;\n      }\n\n      const headers = data[0];\n      const rows = data.slice(1);\n\n      if (headers.length < 2) {\n        resolve(\"Error: Sunburst chart requires at least 2 columns (Parent, Child, optional Value)\");\n        return;\n      }\n\n      // Build hierarchical data (same as taskpane.js)\n      const nodes = new Map();\n      rows.forEach((row, i) => {\n        const parent = row[0] || \"\";\n        const child = row[1] || `node_${i}`;\n        const value = headers.length >= 3 ? (parseFloat(row[2]) || 1) : 1;\n        \n        // Add parent node if it doesn't exist and is not empty\n        if (parent && !nodes.has(parent)) {\n          nodes.set(parent, {\n            id: parent,\n            parent: \"\",\n            name: parent,\n            size: 0 // Will be calculated later\n          });\n        }\n        \n        // Add child node\n        if (!nodes.has(child)) {\n          nodes.set(child, {\n            id: child,\n            parent: parent,\n            name: child,\n            size: value\n          });\n        } else {\n          // Update parent and value if child already exists\n          const existingNode = nodes.get(child);\n          existingNode.parent = parent;\n          existingNode.size = value;\n        }\n      });\n      \n      // Convert Map to array\n      const hierarchicalData = Array.from(nodes.values());\n      \n      // Find root nodes (nodes with no parent or parent not in dataset)\n      const allIds = new Set(hierarchicalData.map(d => d.id));\n      hierarchicalData.forEach(node => {\n        if (node.parent && !allIds.has(node.parent)) {\n          node.parent = \"\"; // Make it a root node if parent doesn't exist\n        }\n      });\n\n      // Calculate chart size based on data complexity\n      const nodeCount = hierarchicalData.length;\n      const chartSize = Math.max(400, Math.min(600, nodeCount * 15 + 300));\n\n      // Use EXACT specification from taskpane.js sunburst chart\n      const spec = {\n        \"$schema\": \"https://vega.github.io/schema/vega/v6.json\",\n        \"description\": \"Sunburst chart from Excel selection\",\n        \"width\": chartSize,\n        \"height\": chartSize,\n        \"padding\": 10,\n        \"autosize\": \"none\",\n        \"background\": \"white\",\n        \"config\": { \"view\": { \"stroke\": \"transparent\" }},\n\n        \"signals\": [\n          {\n            \"name\": \"centerX\",\n            \"update\": \"width / 2\"\n          },\n          {\n            \"name\": \"centerY\", \n            \"update\": \"height / 2\"\n          },\n          {\n            \"name\": \"outerRadius\",\n            \"update\": \"min(width, height) / 2 - 10\"\n          }\n        ],\n\n        \"data\": [\n          {\n            \"name\": \"tree\",\n            \"values\": hierarchicalData,\n            \"transform\": [\n              {\n                \"type\": \"stratify\",\n                \"key\": \"id\",\n                \"parentKey\": \"parent\"\n              },\n              {\n                \"type\": \"partition\",\n                \"field\": \"size\",\n                \"sort\": {\"field\": \"size\", \"order\": \"descending\"},\n                \"size\": [{\"signal\": \"2 * PI\"}, {\"signal\": \"outerRadius\"}],\n                \"as\": [\"a0\", \"r0\", \"a1\", \"r1\", \"depth\", \"children\"]\n              }\n            ]\n          }\n        ],\n\n        \"scales\": [\n          {\n            \"name\": \"color\",\n            \"type\": \"ordinal\",\n            \"domain\": {\"data\": \"tree\", \"field\": \"depth\"},\n            \"range\": [\n              \"#0078d4\", \"#00bcf2\", \"#40e0d0\", \"#00cc6a\", \"#10893e\", \n              \"#107c10\", \"#bad80a\", \"#ffb900\", \"#ff8c00\", \"#d13438\",\n              \"#8764b8\", \"#e3008c\", \"#00b7c3\", \"#038387\", \"#486991\"\n            ]\n          },\n          {\n            \"name\": \"opacity\",\n            \"type\": \"linear\",\n            \"domain\": {\"data\": \"tree\", \"field\": \"depth\"},\n            \"range\": [0.8, 0.4]\n          }\n        ],\n\n        \"marks\": [\n          {\n            \"type\": \"arc\",\n            \"from\": {\"data\": \"tree\"},\n            \"encode\": {\n              \"enter\": {\n                \"x\": {\"signal\": \"centerX\"},\n                \"y\": {\"signal\": \"centerY\"},\n                \"stroke\": {\"value\": \"white\"},\n                \"strokeWidth\": {\"value\": 1}\n              },\n              \"update\": {\n                \"startAngle\": {\"field\": \"a0\"},\n                \"endAngle\": {\"field\": \"a1\"},\n                \"innerRadius\": {\"field\": \"r0\"},\n                \"outerRadius\": {\"field\": \"r1\"},\n                \"fill\": {\"scale\": \"color\", \"field\": \"depth\"},\n                \"fillOpacity\": {\"scale\": \"opacity\", \"field\": \"depth\"}\n              }\n            }\n          },\n          {\n            \"type\": \"text\",\n            \"from\": {\"data\": \"tree\"},\n            \"encode\": {\n              \"enter\": {\n                \"x\": {\"signal\": \"centerX\"},\n                \"y\": {\"signal\": \"centerY\"},\n                \"radius\": {\"signal\": \"(datum.r0 + datum.r1) / 2\"},\n                \"theta\": {\"signal\": \"(datum.a0 + datum.a1) / 2\"},\n                \"fill\": {\"value\": \"#323130\"},\n                \"font\": {\"value\": \"Segoe UI\"},\n                \"fontSize\": {\"value\": 10},\n                \"fontWeight\": {\"value\": \"bold\"},\n                \"align\": {\"value\": \"center\"},\n                \"baseline\": {\"value\": \"middle\"}\n              },\n              \"update\": {\n                \"text\": {\n                  \"signal\": \"(datum.r1 - datum.r0) > 20 && (datum.a1 - datum.a0) > 0.3 ? datum.name : ''\"\n                },\n                \"opacity\": {\n                  \"signal\": \"(datum.r1 - datum.r0) > 20 && (datum.a1 - datum.a0) > 0.3 ? 1 : 0\"\n                }\n              }\n            }\n          }\n        ]\n      };\n      const chartId = `sunburst_${invocation.address.replace(/[^A-Za-z0-9]/g, \"_\")}`;\n      createChart(spec, \"sunburst\", chartId)\n        .then(() => resolve(\"Sunburst\"))\n        .catch((error) => resolve(`Error: ${error.message}`));\n\n    } catch (error) {\n      resolve(`Error: ${error.message}`);\n    }\n  });\n}\n\n/**\n * TREEMAP custom function\n * Creates a treemap chart from Excel data range\n * \n * @customfunction\n * @requiresAddress\n * @param {any[][]} data The data range including headers\n * @param {CustomFunctions.Invocation} invocation Invocation object\n * @returns {string} Status message\n */\nfunction TREEMAP(data, invocation) {\n  return new Promise((resolve) => {\n    try {\n      if (!data || data.length < 2) {\n        resolve(\"Error: Need at least header row + one data row\");\n        return;\n      }\n\n      const headers = data[0];\n      const rows = data.slice(1);\n\n      if (headers.length < 3) {\n        resolve(\"Error: Treemap chart requires 3 columns (Parent, Category, Value)\");\n        return;\n      }\n\n      // Convert rows -> objects (same as taskpane.js)\n      const processedData = rows.map(row => {\n        let obj = {};\n        headers.forEach((h, i) => {\n          obj[h] = row[i];\n        });\n        return obj;\n      });\n\n      // Build treemap data structure (same as taskpane.js)\n      let treeData;\n      \n      if (headers.length >= 3) {\n        // Hierarchical data with parent column\n        treeData = processedData.map((d, i) => ({\n          id: `${d[headers[1]]}_${i}`,\n          name: d[headers[1]],\n          parent: d[headers[0]] || \"root\",\n          size: parseFloat(d[headers[2]]) || 0\n        }));\n        \n        // Add root and parent nodes\n        const parents = [...new Set(treeData.map(d => d.parent))];\n        parents.forEach(parent => {\n          if (parent !== \"root\" && !treeData.find(d => d.id === parent)) {\n            treeData.push({\n              id: parent,\n              name: parent,\n              parent: \"root\",\n              size: 0\n            });\n          }\n        });\n        \n        // Add root node\n        treeData.push({\n          id: \"root\",\n          name: \"Root\",\n          parent: \"\",\n          size: 0\n        });\n      } else {\n        // Simple flat data - create single level hierarchy\n        treeData = [\n          {\n            id: \"root\",\n            name: \"Root\", \n            parent: \"\",\n            size: 0\n          },\n          ...processedData.map((d, i) => ({\n            id: `item_${i}`,\n            name: d[headers[1]],\n            parent: \"root\",\n            size: parseFloat(d[headers[2]]) || 0\n          }))\n        ];\n      }\n\n      // Use EXACT specification from taskpane.js treemap chart\n      const spec = {\n        $schema: \"https://vega.github.io/schema/vega/v5.json\",\n        description: \"Treemap visualization from Excel data\",\n        background: \"white\",\n        width: 600,\n        height: 400,\n        padding: 5,\n        autosize: \"fit\",\n        \n        data: [\n          {\n            name: \"tree\",\n            values: treeData,\n            transform: [\n              {\n                type: \"stratify\",\n                key: \"id\",\n                parentKey: \"parent\"\n              },\n              {\n                type: \"treemap\",\n                field: \"size\",\n                sort: { field: \"value\" },\n                round: true,\n                method: \"squarify\",\n                ratio: 1.6,\n                size: [{ signal: \"width\" }, { signal: \"height\" }]\n              }\n            ]\n          },\n          {\n            name: \"nodes\",\n            source: \"tree\",\n            transform: [\n              { type: \"filter\", expr: \"datum.children\" }\n            ]\n          },\n          {\n            name: \"leaves\", \n            source: \"tree\",\n            transform: [\n              { type: \"filter\", expr: \"!datum.children\" }\n            ]\n          }\n        ],\n        \n        scales: [\n          {\n            name: \"color\",\n            type: \"ordinal\",\n            domain: { data: \"nodes\", field: \"name\" },\n            range: [\n              \"#0078d4\", \"#00bcf2\", \"#40e0d0\", \"#00cc6a\", \"#10893e\",\n              \"#107c10\", \"#bad80a\", \"#ffb900\", \"#ff8c00\", \"#d13438\"\n            ]\n          },\n          {\n            name: \"fontSize\",\n            type: \"ordinal\", \n            domain: [0, 1, 2, 3],\n            range: [20, 16, 12, 10]\n          },\n          {\n            name: \"opacity\",\n            type: \"ordinal\",\n            domain: [0, 1, 2, 3], \n            range: [0.3, 0.6, 0.8, 1.0]\n          }\n        ],\n        \n        marks: [\n          {\n            type: \"rect\",\n            from: { data: \"nodes\" },\n            interactive: false,\n            encode: {\n              enter: {\n                fill: { scale: \"color\", field: \"name\" },\n                fillOpacity: { scale: \"opacity\", field: \"depth\" }\n              },\n              update: {\n                x: { field: \"x0\" },\n                y: { field: \"y0\" },\n                x2: { field: \"x1\" },\n                y2: { field: \"y1\" },\n                stroke: { value: \"#ffffff\" },\n                strokeWidth: { value: 1 }\n              }\n            }\n          },\n          {\n            type: \"rect\",\n            from: { data: \"leaves\" },\n            encode: {\n              enter: {\n                stroke: { value: \"#ffffff\" },\n                strokeWidth: { value: 2 }\n              },\n              update: {\n                x: { field: \"x0\" },\n                y: { field: \"y0\" },\n                x2: { field: \"x1\" },\n                y2: { field: \"y1\" },\n                fill: { value: \"transparent\" },\n                tooltip: {\n                  signal: `{'Category': datum.name, 'Value': datum.size, 'Parent': datum.parent}`\n                }\n              },\n              hover: {\n                fill: { value: \"#323130\" },\n                fillOpacity: { value: 0.1 }\n              }\n            }\n          },\n          {\n            type: \"text\",\n            from: { data: \"leaves\" },\n            interactive: false,\n            encode: {\n              enter: {\n                font: { value: \"Segoe UI, Arial, sans-serif\" },\n                align: { value: \"center\" },\n                baseline: { value: \"middle\" },\n                fill: { value: \"#323130\" },\n                fontWeight: { value: \"bold\" },\n                text: { field: \"name\" },\n                fontSize: { scale: \"fontSize\", field: \"depth\" }\n              },\n              update: {\n                x: { signal: \"0.5 * (datum.x0 + datum.x1)\" },\n                y: { signal: \"0.5 * (datum.y0 + datum.y1)\" },\n                opacity: {\n                  signal: \"(datum.x1 - datum.x0) > 50 && (datum.y1 - datum.y0) > 20 ? 1 : 0\"\n                }\n              }\n            }\n          }\n        ]\n      };\n      const chartId = `treemap_${invocation.address.replace(/[^A-Za-z0-9]/g, \"_\")}`;\n      createChart(spec, \"treemap\", chartId)\n        .then(() => resolve(\"Treemap\"))\n        .catch((error) => resolve(`Error: ${error.message}`));\n\n    } catch (error) {\n      resolve(`Error: ${error.message}`);\n    }\n  });\n}\n\n/**\n * HISTOGRAM custom function\n * Creates a histogram from Excel data range\n * \n * @customfunction\n * @requiresAddress\n * @param {any[][]} data The data range including headers\n * @param {CustomFunctions.Invocation} invocation Invocation object\n * @returns {string} Status message\n */\nfunction HISTOGRAM(data, invocation) {\n  return new Promise((resolve) => {\n    try {\n      if (!data || data.length < 2) {\n        resolve(\"Error: Need at least header row + one data row\");\n        return;\n      }\n\n      const headers = data[0];\n      const rows = data.slice(1);\n\n      // Expect a single numeric column\n      const numericData = rows\n        .filter(r => !isNaN(+r[0]))\n        .map(r => ({ value: +r[0] }));\n\n      if (numericData.length === 0) {\n        resolve(\"Error: No valid numeric data found for histogram\");\n        return;\n      }\n\n      // Calculate data range for better binning control\n      const values = numericData.map(d => d.value);\n      const minVal = Math.min(...values);\n      const maxVal = Math.max(...values);\n      const range = maxVal - minVal;\n      \n      // Calculate nice bin boundaries\n      const binCount = 20;\n      const binWidth = range / binCount;\n      const niceMin = Math.floor(minVal / binWidth) * binWidth;\n      const niceMax = Math.ceil(maxVal / binWidth) * binWidth;\n\n      // Use EXACT specification from taskpane.js histogram\n      const spec = {\n        \"$schema\": \"https://vega.github.io/schema/vega-lite/v6.json\",\n        \"description\": \"Histogram from Excel selection\",\n        \"background\": \"white\",\n        \"config\": { \"view\": { \"stroke\": \"transparent\" }},\n        \"data\": { \"values\": numericData },\n        \"mark\": {\n          \"type\": \"bar\",\n          \"tooltip\": true,\n          \"stroke\": \"white\",\n          \"strokeWidth\": 1\n        },\n        \"encoding\": {\n          \"x\": {\n            \"field\": \"value\",\n            \"bin\": { \n              \"extent\": [niceMin, niceMax],\n              \"step\": binWidth,\n              \"nice\": false  // Prevent Vega from adjusting our nice boundaries\n            },\n            \"type\": \"quantitative\",\n            \"axis\": { \n              \"title\": \"Value\",\n              \"labelFontSize\": 12,\n              \"titleFontSize\": 14,\n              \"labelColor\": \"#605e5c\",\n              \"titleColor\": \"#323130\"\n            },\n            \"scale\": {\n              \"domain\": [niceMin, niceMax],\n              \"range\": \"width\",\n              \"paddingInner\": 0.05,\n              \"paddingOuter\": 0.02\n            }\n          },\n          \"y\": {\n            \"aggregate\": \"count\",\n            \"type\": \"quantitative\",\n            \"axis\": { \n              \"title\": \"Count\",\n              \"labelFontSize\": 12,\n              \"titleFontSize\": 14,\n              \"labelColor\": \"#605e5c\",\n              \"titleColor\": \"#323130\",\n              \"gridColor\": \"#f3f2f1\"\n            }\n          },\n          \"color\": {\n            \"value\": \"#0078d4\"\n          }\n        },\n        \"config\": {\n          \"font\": \"Segoe UI\",\n          \"axis\": {\n            \"labelColor\": \"#605e5c\",\n            \"titleColor\": \"#323130\",\n            \"gridColor\": \"#f3f2f1\"\n          }\n        }\n      };\n      const chartId = `histogram_${invocation.address.replace(/[^A-Za-z0-9]/g, \"_\")}`;\n      createChart(spec, \"histogram\", chartId)\n        .then(() => resolve(\"Histogram\"))\n        .catch((error) => resolve(`Error: ${error.message}`));\n\n    } catch (error) {\n      resolve(`Error: ${error.message}`);\n    }\n  });\n}\n\n/**\n * DENSITY custom function\n * Creates a density plot from Excel data range\n * \n * @customfunction\n * @requiresAddress\n * @param {any[][]} data The data range including headers\n * @param {CustomFunctions.Invocation} invocation Invocation object\n * @returns {string} Status message\n */\nfunction DENSITY(data, invocation) {\n  return new Promise((resolve) => {\n    try {\n      if (!data || data.length < 2) {\n        resolve(\"Error: Need at least header row + one data row\");\n        return;\n      }\n\n      const headers = data[0];\n      const rows = data.slice(1);\n\n      if (headers.length < 1) {\n        resolve(\"Error: Density plot requires at least 1 column (Values)\");\n        return;\n      }\n\n      // Convert rows -> objects (same as taskpane.js)\n      const processedData = rows.map(row => {\n        let obj = {};\n        headers.forEach((h, i) => {\n          obj[h] = row[i];\n        });\n        return obj;\n      });\n\n      // Use EXACT specification from Vega-Lite reference with bandwidth parameter\n      const spec = {\n        $schema: \"https://vega.github.io/schema/vega-lite/v6.json\",\n        description: \"Density plot from Excel selection\",\n        background: \"white\",\n        config: { view: { stroke: \"transparent\" }},\n        width: 400,\n        height: 100,\n        data: { values: processedData },\n        transform: [{\n          density: headers[0],\n          bandwidth: 0.3\n        }],\n        mark: \"area\",\n        encoding: {\n          x: {\n            field: \"value\",\n            title: headers[0],\n            type: \"quantitative\",\n            axis: {\n              labelFontSize: 12,\n              titleFontSize: 14,\n              labelColor: \"#605e5c\",\n              titleColor: \"#323130\",\n              gridColor: \"#f3f2f1\"\n            }\n          },\n          y: {\n            field: \"density\",\n            type: \"quantitative\",\n            title: \"Density\",\n            axis: {\n              labelFontSize: 12,\n              titleFontSize: 14,\n              labelColor: \"#605e5c\",\n              titleColor: \"#323130\",\n              gridColor: \"#f3f2f1\"\n            }\n          },\n          color: {\n            value: \"#0078d4\"\n          },\n          tooltip: [\n            { field: \"value\", type: \"quantitative\", title: headers[0], format: \".2f\" },\n            { field: \"density\", type: \"quantitative\", title: \"Density\", format: \".4f\" }\n          ]\n        },\n        config: {\n          font: \"Segoe UI\",\n          axis: {\n            labelColor: \"#605e5c\",\n            titleColor: \"#323130\",\n            gridColor: \"#f3f2f1\"\n          }\n        }\n      };\n      \n      const chartId = `density_${invocation.address.replace(/[^A-Za-z0-9]/g, \"_\")}`;\n      createChart(spec, \"density\", chartId)\n        .then(() => resolve(\"Density\"))\n        .catch((error) => resolve(`Error: ${error.message}`));\n\n    } catch (error) {\n      resolve(`Error: ${error.message}`);\n    }\n  });\n}\n\n/**\n * MAP custom function\n * Creates a world map chart from Excel data range\n * \n * @customfunction\n * @requiresAddress\n * @param {any[][]} data The data range including headers\n * @param {CustomFunctions.Invocation} invocation Invocation object\n * @returns {string} Status message\n */\nfunction MAP(data, invocation) {\n  return new Promise((resolve) => {\n    try {\n      if (!data || data.length < 2) {\n        resolve(\"Error: Need at least header row + one data row\");\n        return;\n      }\n\n      const headers = data[0];\n      const rows = data.slice(1);\n\n      if (headers.length < 2) {\n        resolve(\"Error: Map chart requires 2 columns (Country ISO3, Value)\");\n        return;\n      }\n\n      // ISO3 to numeric ID mapping (same as taskpane.js)\n      const isoToId = {\n        \"AFG\": 4,    // Afghanistan\n        \"AGO\": 24,   // Angola\n        \"ALB\": 8,    // Albania\n        \"AND\": 20,   // Andorra\n        \"ARE\": 784,  // United Arab Emirates\n        \"ARG\": 32,   // Argentina\n        \"ARM\": 51,   // Armenia\n        \"ATA\": 10,   // Antarctica\n        \"ATG\": 28,   // Antigua and Barbuda\n        \"AUS\": 36,   // Australia\n        \"AUT\": 40,   // Austria\n        \"AZE\": 31,   // Azerbaijan\n        \"BDI\": 108,  // Burundi\n        \"BEL\": 56,   // Belgium\n        \"BEN\": 204,  // Benin\n        \"BFA\": 854,  // Burkina Faso\n        \"BGD\": 50,   // Bangladesh\n        \"BGR\": 100,  // Bulgaria\n        \"BHR\": 48,   // Bahrain\n        \"BHS\": 44,   // Bahamas\n        \"BIH\": 70,   // Bosnia and Herzegovina\n        \"BLR\": 112,  // Belarus\n        \"BLZ\": 84,   // Belize\n        \"BOL\": 68,   // Bolivia\n        \"BRA\": 76,   // Brazil\n        \"BRB\": 52,   // Barbados\n        \"BRN\": 96,   // Brunei\n        \"BTN\": 64,   // Bhutan\n        \"BWA\": 72,   // Botswana\n        \"CAF\": 140,  // Central African Republic\n        \"CAN\": 124,  // Canada\n        \"CHE\": 756,  // Switzerland\n        \"CHL\": 152,  // Chile\n        \"CHN\": 156,  // China\n        \"CIV\": 384,  // Cte d'Ivoire\n        \"CMR\": 120,  // Cameroon\n        \"COD\": 180,  // Democratic Republic of Congo\n        \"COG\": 178,  // Congo\n        \"COL\": 170,  // Colombia\n        \"COM\": 174,  // Comoros\n        \"CPV\": 132,  // Cape Verde\n        \"CRI\": 188,  // Costa Rica\n        \"CUB\": 192,  // Cuba\n        \"CYP\": 196,  // Cyprus\n        \"CZE\": 203,  // Czechia\n        \"DEU\": 276,  // Germany\n        \"DJI\": 262,  // Djibouti\n        \"DMA\": 212,  // Dominica\n        \"DNK\": 208,  // Denmark\n        \"DOM\": 214,  // Dominican Republic\n        \"DZA\": 12,   // Algeria\n        \"ECU\": 218,  // Ecuador\n        \"EGY\": 818,  // Egypt\n        \"ERI\": 232,  // Eritrea\n        \"ESH\": 732,  // Western Sahara\n        \"ESP\": 724,  // Spain\n        \"EST\": 233,  // Estonia\n        \"ETH\": 231,  // Ethiopia\n        \"FIN\": 246,  // Finland\n        \"FJI\": 242,  // Fiji\n        \"FRA\": 250,  // France\n        \"FSM\": 583,  // Micronesia\n        \"GAB\": 266,  // Gabon\n        \"GBR\": 826,  // United Kingdom\n        \"GEO\": 268,  // Georgia\n        \"GHA\": 288,  // Ghana\n        \"GIN\": 324,  // Guinea\n        \"GMB\": 270,  // Gambia\n        \"GNB\": 624,  // Guinea-Bissau\n        \"GNQ\": 226,  // Equatorial Guinea\n        \"GRC\": 300,  // Greece\n        \"GRD\": 308,  // Grenada\n        \"GRL\": 304,  // Greenland\n        \"GTM\": 320,  // Guatemala\n        \"GUY\": 328,  // Guyana\n        \"HND\": 340,  // Honduras\n        \"HRV\": 191,  // Croatia\n        \"HTI\": 332,  // Haiti\n        \"HUN\": 348,  // Hungary\n        \"IDN\": 360,  // Indonesia\n        \"IND\": 356,  // India\n        \"IRL\": 372,  // Ireland\n        \"IRN\": 364,  // Iran\n        \"IRQ\": 368,  // Iraq\n        \"ISL\": 352,  // Iceland\n        \"ISR\": 376,  // Israel\n        \"ITA\": 380,  // Italy\n        \"JAM\": 388,  // Jamaica\n        \"JOR\": 400,  // Jordan\n        \"JPN\": 392,  // Japan\n        \"KAZ\": 398,  // Kazakhstan\n        \"KEN\": 404,  // Kenya\n        \"KGZ\": 417,  // Kyrgyzstan\n        \"KHM\": 116,  // Cambodia\n        \"KIR\": 296,  // Kiribati\n        \"KNA\": 659,  // Saint Kitts and Nevis\n        \"KOR\": 410,  // South Korea\n        \"KWT\": 414,  // Kuwait\n        \"LAO\": 418,  // Laos\n        \"LBN\": 422,  // Lebanon\n        \"LBR\": 430,  // Liberia\n        \"LBY\": 434,  // Libya\n        \"LCA\": 662,  // Saint Lucia\n        \"LIE\": 438,  // Liechtenstein\n        \"LKA\": 144,  // Sri Lanka\n        \"LSO\": 426,  // Lesotho\n        \"LTU\": 440,  // Lithuania\n        \"LUX\": 442,  // Luxembourg\n        \"LVA\": 428,  // Latvia\n        \"MAR\": 504,  // Morocco\n        \"MCO\": 492,  // Monaco\n        \"MDA\": 498,  // Moldova\n        \"MDG\": 450,  // Madagascar\n        \"MDV\": 462,  // Maldives\n        \"MEX\": 484,  // Mexico\n        \"MHL\": 584,  // Marshall Islands\n        \"MKD\": 807,  // North Macedonia\n        \"MLI\": 466,  // Mali\n        \"MLT\": 470,  // Malta\n        \"MMR\": 104,  // Myanmar\n        \"MNE\": 499,  // Montenegro\n        \"MNG\": 496,  // Mongolia\n        \"MOZ\": 508,  // Mozambique\n        \"MRT\": 478,  // Mauritania\n        \"MUS\": 480,  // Mauritius\n        \"MWI\": 454,  // Malawi\n        \"MYS\": 458,  // Malaysia\n        \"NAM\": 516,  // Namibia\n        \"NCL\": 540,  // New Caledonia\n        \"NER\": 562,  // Niger\n        \"NGA\": 566,  // Nigeria\n        \"NIC\": 558,  // Nicaragua\n        \"NLD\": 528,  // Netherlands\n        \"NOR\": 578,  // Norway\n        \"NPL\": 524,  // Nepal\n        \"NRU\": 520,  // Nauru\n        \"NZL\": 554,  // New Zealand\n        \"OMN\": 512,  // Oman\n        \"PAK\": 586,  // Pakistan\n        \"PAN\": 591,  // Panama\n        \"PER\": 604,  // Peru\n        \"PHL\": 608,  // Philippines\n        \"PLW\": 585,  // Palau\n        \"PNG\": 598,  // Papua New Guinea\n        \"POL\": 616,  // Poland\n        \"PRI\": 630,  // Puerto Rico\n        \"PRK\": 408,  // North Korea\n        \"PRT\": 620,  // Portugal\n        \"PRY\": 600,  // Paraguay\n        \"PSE\": 275,  // Palestine\n        \"QAT\": 634,  // Qatar\n        \"ROU\": 642,  // Romania\n        \"RUS\": 643,  // Russia\n        \"RWA\": 646,  // Rwanda\n        \"SAU\": 682,  // Saudi Arabia\n        \"SDN\": 729,  // Sudan\n        \"SEN\": 686,  // Senegal\n        \"SGP\": 702,  // Singapore\n        \"SLB\": 90,   // Solomon Islands\n        \"SLE\": 694,  // Sierra Leone\n        \"SLV\": 222,  // El Salvador\n        \"SMR\": 674,  // San Marino\n        \"SOM\": 706,  // Somalia\n        \"SRB\": 688,  // Serbia\n        \"SSD\": 728,  // South Sudan\n        \"STP\": 678,  // So Tom and Prncipe\n        \"SUR\": 740,  // Suriname\n        \"SVK\": 703,  // Slovakia\n        \"SVN\": 705,  // Slovenia\n        \"SWE\": 752,  // Sweden\n        \"SWZ\": 748,  // Eswatini\n        \"SYC\": 690,  // Seychelles\n        \"SYR\": 760,  // Syria\n        \"TCD\": 148,  // Chad\n        \"TGO\": 768,  // Togo\n        \"THA\": 764,  // Thailand\n        \"TJK\": 762,  // Tajikistan\n        \"TKM\": 795,  // Turkmenistan\n        \"TLS\": 626,  // Timor-Leste\n        \"TON\": 776,  // Tonga\n        \"TTO\": 780,  // Trinidad and Tobago\n        \"TUN\": 788,  // Tunisia\n        \"TUR\": 792,  // Turkey\n        \"TUV\": 798,  // Tuvalu\n        \"TWN\": 158,  // Taiwan\n        \"TZA\": 834,  // Tanzania\n        \"UGA\": 800,  // Uganda\n        \"UKR\": 804,  // Ukraine\n        \"URY\": 858,  // Uruguay\n        \"USA\": 840,  // United States\n        \"UZB\": 860,  // Uzbekistan\n        \"VAT\": 336,  // Vatican City\n        \"VCT\": 670,  // Saint Vincent and the Grenadines\n        \"VEN\": 862,  // Venezuela\n        \"VNM\": 704,  // Vietnam\n        \"VUT\": 548,  // Vanuatu\n        \"WSM\": 882,  // Samoa\n        \"XKX\": 383,  // Kosovo\n        \"YEM\": 887,  // Yemen\n        \"ZAF\": 710,  // South Africa\n        \"ZMB\": 894,  // Zambia\n        \"ZWE\": 716   // Zimbabwe\n      };\n\n      // Process data (same as taskpane.js)\n      const worldData = rows\n        .filter(r => r[0] && !isNaN(+r[1]))\n        .map(r => {\n          const iso = (r[0] || \"\").toUpperCase().trim();\n          const idVal = isoToId[iso];\n          return {\n            id: idVal,     // numeric ID matching topojson country.id\n            iso: iso,       // original ISO3 for tooltip\n            rate: +r[1]\n          };\n        })\n        .filter(d => d.id); // drop rows where iso isn't in lookup\n\n      if (worldData.length === 0) {\n        resolve(\"Error: No valid country data found. Please use ISO3 country codes (USA, GBR, DEU, etc.)\");\n        return;\n      }\n\n      // Use EXACT specification from taskpane.js map chart\n      const spec = {\n        $schema: \"https://vega.github.io/schema/vega-lite/v6.json\",\n        width: 800,\n        height: 450,\n        data: {\n          url: \"https://cdn.jsdelivr.net/npm/world-atlas@2/countries-110m.json\",\n          format: { type: \"topojson\", feature: \"countries\" }\n        },\n        transform: [\n          {\n            lookup: \"id\",\n            from: {\n              data: { values: worldData },\n              key: \"id\",\n              fields: [\"rate\", \"iso\"]\n            }\n          }\n        ],\n        projection: { type: \"equalEarth\" },\n        mark: { type: \"geoshape\", stroke: \"white\", strokeWidth: 0.5 },\n        encoding: {\n          color: {\n            field: \"rate\",\n            type: \"quantitative\",\n            scale: { scheme: \"blues\" }\n          },\n          tooltip: [\n            { field: \"iso\", type: \"nominal\", title: \"Country (ISO3)\" },\n            { field: \"rate\", type: \"quantitative\", title: \"Value\" }\n          ]\n        }\n      };\n      const chartId = `map_${invocation.address.replace(/[^A-Za-z0-9]/g, \"_\")}`;\n      createChart(spec, \"map\", chartId)\n        .then(() => resolve(\"Map\"))\n        .catch((error) => resolve(`Error: ${error.message}`));\n\n    } catch (error) {\n      resolve(`Error: ${error.message}`);\n    }\n  });\n}\n\n/**\n * CONTOUR custom function\n * Creates a contour plot from Excel data range\n * \n * @customfunction\n * @requiresAddress\n * @param {any[][]} data The data range including headers\n * @param {CustomFunctions.Invocation} invocation Invocation object\n * @returns {string} Status message\n */\nfunction CONTOUR(data, invocation) {\n  return new Promise((resolve) => {\n    try {\n      if (!data || data.length < 2) {\n        resolve(\"Error: Need at least header row + one data row\");\n        return;\n      }\n\n      const headers = data[0];\n      const rows = data.slice(1);\n\n      if (headers.length < 2) {\n        resolve(\"Error: Contour plot requires at least 2 columns (X values, Y values, optional Categories)\");\n        return;\n      }\n\n      // Convert rows -> objects (same as taskpane.js)\n      const processedData = rows.map(row => {\n        let obj = {};\n        headers.forEach((h, i) => {\n          obj[h] = row[i];\n        });\n        return obj;\n      });\n\n      // Filter out null/invalid data points\n      const filteredData = processedData.filter(d => \n        d[headers[0]] !== null && d[headers[0]] !== undefined && d[headers[0]] !== \"\" &&\n        d[headers[1]] !== null && d[headers[1]] !== undefined && d[headers[1]] !== \"\"\n      );\n\n      if (filteredData.length === 0) {\n        resolve(\"Error: No valid data points for contour plot\");\n        return;\n      }\n\n      // Calculate dynamic dimensions based on data range\n      const xValues = filteredData.map(d => parseFloat(d[headers[0]]));\n      const yValues = filteredData.map(d => parseFloat(d[headers[1]]));\n      const xRange = Math.max(...xValues) - Math.min(...xValues);\n      const yRange = Math.max(...yValues) - Math.min(...yValues);\n      \n      const dynamicWidth = Math.max(500, Math.min(800, xRange * 10));\n      const dynamicHeight = Math.max(400, Math.min(600, yRange * 10));\n\n      // Determine if we have grouping column\n      const hasGrouping = headers.length >= 3;\n\n      // Use EXACT specification matching taskpane.js contour chart\n      const spec = {\n        \"$schema\": \"https://vega.github.io/schema/vega/v6.json\",\n        \"description\": \"Contour plot from Excel selection - density estimate overlay\",\n        \"width\": dynamicWidth,\n        \"height\": dynamicHeight,\n        \"padding\": 5,\n        \"autosize\": \"pad\",\n        \"background\": \"white\",\n\n        \"signals\": [\n          {\n            \"name\": \"bandwidth\",\n            \"value\": -1,\n            \"description\": \"Bandwidth for density estimation (-1 for auto)\"\n          },\n          {\n            \"name\": \"resolve\",\n            \"value\": \"shared\",\n            \"description\": \"Scale resolution for contours\"\n          },\n          {\n            \"name\": \"counts\",\n            \"value\": true,\n            \"description\": \"Use counts vs density\"\n          }\n        ],\n\n        \"data\": [\n          {\n            \"name\": \"source\",\n            \"values\": filteredData,\n            \"transform\": [\n              {\n                \"type\": \"filter\",\n                \"expr\": `datum['${headers[0]}'] != null && datum['${headers[1]}'] != null`\n              }\n            ]\n          },\n          {\n            \"name\": \"density\",\n            \"source\": \"source\",\n            \"transform\": [\n              {\n                \"type\": \"kde2d\",\n                ...(hasGrouping && { \"groupby\": [headers[2]] }),\n                \"size\": [{\"signal\": \"width\"}, {\"signal\": \"height\"}],\n                \"x\": {\"expr\": `scale('x', datum['${headers[0]}'])`},\n                \"y\": {\"expr\": `scale('y', datum['${headers[1]}'])`},\n                \"bandwidth\": {\"signal\": \"[bandwidth, bandwidth]\"},\n                \"counts\": {\"signal\": \"counts\"}\n              }\n            ]\n          },\n          {\n            \"name\": \"contours\",\n            \"source\": \"density\",\n            \"transform\": [\n              {\n                \"type\": \"isocontour\",\n                \"field\": \"grid\",\n                \"resolve\": {\"signal\": \"resolve\"},\n                \"levels\": 5\n              }\n            ]\n          }\n        ],\n\n        \"scales\": [\n          {\n            \"name\": \"x\",\n            \"type\": \"linear\",\n            \"round\": true,\n            \"nice\": true,\n            \"zero\": false,\n            \"domain\": {\"data\": \"source\", \"field\": headers[0]},\n            \"range\": \"width\"\n          },\n          {\n            \"name\": \"y\",\n            \"type\": \"linear\",\n            \"round\": true,\n            \"nice\": true,\n            \"zero\": false,\n            \"domain\": {\"data\": \"source\", \"field\": headers[1]},\n            \"range\": \"height\"\n          },\n          ...(hasGrouping ? [{\n            \"name\": \"color\",\n            \"type\": \"ordinal\",\n            \"domain\": {\n              \"data\": \"source\",\n              \"field\": headers[2],\n              \"sort\": {\"order\": \"descending\"}\n            },\n            \"range\": \"category\"\n          }] : [{\n            \"name\": \"color\",\n            \"type\": \"ordinal\",\n            \"domain\": [\"Data\"],\n            \"range\": [\"#0078d4\"]\n          }])\n        ],\n\n        \"axes\": [\n          {\n            \"scale\": \"x\",\n            \"grid\": true,\n            \"domain\": false,\n            \"orient\": \"bottom\",\n            \"tickCount\": 5,\n            \"title\": headers[0],\n            \"labelFontSize\": 11,\n            \"titleFontSize\": 13,\n            \"labelFont\": \"Segoe UI\",\n            \"titleFont\": \"Segoe UI\",\n            \"labelColor\": \"#605e5c\",\n            \"titleColor\": \"#323130\",\n            \"gridColor\": \"#f3f2f1\"\n          },\n          {\n            \"scale\": \"y\",\n            \"grid\": true,\n            \"domain\": false,\n            \"orient\": \"left\",\n            \"titlePadding\": 5,\n            \"title\": headers[1],\n            \"labelFontSize\": 11,\n            \"titleFontSize\": 13,\n            \"labelFont\": \"Segoe UI\",\n            \"titleFont\": \"Segoe UI\",\n            \"labelColor\": \"#605e5c\",\n            \"titleColor\": \"#323130\",\n            \"gridColor\": \"#f3f2f1\"\n          }\n        ],\n\n        \"legends\": hasGrouping ? [\n          {\n            \"stroke\": \"color\",\n            \"symbolType\": \"stroke\",\n            \"title\": headers[2],\n            \"titleFont\": \"Segoe UI\",\n            \"titleFontSize\": 12,\n            \"titleColor\": \"#323130\",\n            \"labelFont\": \"Segoe UI\",\n            \"labelFontSize\": 11,\n            \"labelColor\": \"#605e5c\"\n          }\n        ] : [],\n\n        \"marks\": [\n          {\n            \"name\": \"points\",\n            \"type\": \"symbol\",\n            \"from\": {\"data\": \"source\"},\n            \"encode\": {\n              \"update\": {\n                \"x\": {\"scale\": \"x\", \"field\": headers[0]},\n                \"y\": {\"scale\": \"y\", \"field\": headers[1]},\n                \"size\": {\"value\": 16},\n                \"fill\": {\"value\": \"#cccccc\"},\n                \"fillOpacity\": {\"value\": 0.4},\n                \"stroke\": {\"value\": \"#999999\"},\n                \"strokeWidth\": {\"value\": 0.5}\n              }\n            }\n          },\n          {\n            \"type\": \"image\",\n            \"from\": {\"data\": \"density\"},\n            \"encode\": {\n              \"update\": {\n                \"x\": {\"value\": 0},\n                \"y\": {\"value\": 0},\n                \"width\": {\"signal\": \"width\"},\n                \"height\": {\"signal\": \"height\"},\n                \"aspect\": {\"value\": false}\n              }\n            },\n            \"transform\": [\n              {\n                \"type\": \"heatmap\",\n                \"field\": \"datum.grid\",\n                \"resolve\": {\"signal\": \"resolve\"},\n                \"color\": hasGrouping \n                  ? {\"expr\": `scale('color', datum.datum['${headers[2]}'])`}\n                  : {\"expr\": \"scale('color', 'Data')\"}\n              }\n            ]\n          },\n          {\n            \"type\": \"path\",\n            \"clip\": true,\n            \"from\": {\"data\": \"contours\"},\n            \"encode\": {\n              \"enter\": {\n                \"strokeWidth\": {\"value\": 1.5},\n                \"strokeOpacity\": {\"value\": 0.8},\n                \"stroke\": hasGrouping\n                  ? {\"scale\": \"color\", \"field\": headers[2]}\n                  : {\"value\": \"#0078d4\"},\n                \"fill\": {\"value\": null}\n              }\n            },\n            \"transform\": [\n              {\"type\": \"geopath\", \"field\": \"datum.contour\"}\n            ]\n          }\n        ],\n\n        \"config\": {\n          \"font\": \"Segoe UI\",\n          \"view\": {\"stroke\": \"transparent\"}\n        }\n      };\n\n      const chartId = `contour_${invocation.address.replace(/[^A-Za-z0-9]/g, \"_\")}`;\n      createChart(spec, \"contour\", chartId)\n        .then(() => resolve(\"Contour\"))\n        .catch((error) => resolve(`Error: ${error.message}`));\n\n    } catch (error) {\n      resolve(`Error: ${error.message}`);\n    }\n  });\n}\n\n/**\n * CANDLESTICK custom function\n * Creates a candlestick chart from Excel data range\n * \n * @customfunction\n * @requiresAddress\n * @param {any[][]} data The data range including headers\n * @param {CustomFunctions.Invocation} invocation Invocation object\n * @returns {string} Status message\n */\nfunction CANDLESTICK(data, invocation) {\n  return new Promise((resolve) => {\n    try {\n      if (!data || data.length < 2) {\n        resolve(\"Error: Need at least header row + one data row\");\n        return;\n      }\n\n      const headers = data[0];\n      const rows = data.slice(1);\n\n      if (headers.length < 5) {\n        resolve(\"Error: Candlestick chart requires 5 columns (Date, Open, High, Low, Close)\");\n        return;\n      }\n\n      // Convert rows -> objects (same as taskpane.js)\n      const processedData = rows.map(row => {\n        let obj = {};\n        headers.forEach((h, i) => {\n          obj[h] = row[i];\n        });\n        return obj;\n      });\n\n      // Helper function to convert Excel dates to JS dates\n      function excelDateToJSDate(serial) {\n        if (typeof serial === 'number') {\n          return new Date(Math.round((serial - 25569) * 86400 * 1000));\n        }\n        return new Date(serial);\n      }\n\n      // Process and validate data\n      const candlestickData = processedData.map((row, index) => {\n        const date = excelDateToJSDate(row[headers[0]]);\n        const open = parseFloat(row[headers[1]]) || 0;\n        const high = parseFloat(row[headers[2]]) || 0;\n        const low = parseFloat(row[headers[3]]) || 0;\n        const close = parseFloat(row[headers[4]]) || 0;\n        \n        if (isNaN(date.getTime()) || isNaN(open) || isNaN(high) || isNaN(low) || isNaN(close)) {\n          return null;\n        }\n        \n        return {\n          date: date.toISOString(),\n          open: open,\n          high: high,\n          low: low,\n          close: close\n        };\n      }).filter(Boolean);\n\n      if (candlestickData.length === 0) {\n        resolve(\"Error: No valid candlestick data found\");\n        return;\n      }\n\n      // Use EXACT specification from taskpane.js candlestick chart\n      const spec = {\n        \"$schema\": \"https://vega.github.io/schema/vega-lite/v6.json\",\n        \"width\": 600,\n        \"description\": \"Candlestick chart from Excel selection\",\n        \"background\": \"white\",\n        \"config\": { \"view\": { \"stroke\": \"transparent\" }},\n        \"data\": { \"values\": candlestickData },\n        \"encoding\": {\n          \"x\": {\n            \"field\": \"date\",\n            \"type\": \"temporal\",\n            \"title\": \"Date\",\n            \"axis\": {\n              \"format\": \"%m/%d\",\n              \"labelAngle\": -45,\n              \"labelFontSize\": 11,\n              \"titleFontSize\": 12,\n              \"labelColor\": \"#605e5c\",\n              \"titleColor\": \"#323130\",\n              \"font\": \"Segoe UI\"\n            }\n          },\n          \"y\": {\n            \"type\": \"quantitative\",\n            \"scale\": { \"zero\": false },\n            \"axis\": {\n              \"title\": \"Price\",\n              \"labelFontSize\": 11,\n              \"titleFontSize\": 12,\n              \"labelColor\": \"#605e5c\",\n              \"titleColor\": \"#323130\",\n              \"font\": \"Segoe UI\",\n              \"grid\": true,\n              \"gridColor\": \"#f3f2f1\"\n            }\n          },\n          \"color\": {\n            \"condition\": {\n              \"test\": \"datum.open < datum.close\",\n              \"value\": \"#06982d\"\n            },\n            \"value\": \"#ae1325\"\n          }\n        },\n        \"layer\": [\n          {\n            \"mark\": {\n              \"type\": \"rule\",\n              \"tooltip\": true\n            },\n            \"encoding\": {\n              \"y\": { \"field\": \"low\" },\n              \"y2\": { \"field\": \"high\" },\n              \"tooltip\": [\n                { \"field\": \"date\", \"type\": \"temporal\", \"title\": \"Date\", \"format\": \"%Y-%m-%d\" },\n                { \"field\": \"open\", \"type\": \"quantitative\", \"title\": \"Open\", \"format\": \".2f\" },\n                { \"field\": \"high\", \"type\": \"quantitative\", \"title\": \"High\", \"format\": \".2f\" },\n                { \"field\": \"low\", \"type\": \"quantitative\", \"title\": \"Low\", \"format\": \".2f\" },\n                { \"field\": \"close\", \"type\": \"quantitative\", \"title\": \"Close\", \"format\": \".2f\" }\n              ]\n            }\n          },\n          {\n            \"mark\": {\n              \"type\": \"bar\",\n              \"tooltip\": true\n            },\n            \"encoding\": {\n              \"y\": { \"field\": \"open\" },\n              \"y2\": { \"field\": \"close\" },\n              \"tooltip\": [\n                { \"field\": \"date\", \"type\": \"temporal\", \"title\": \"Date\", \"format\": \"%Y-%m-%d\" },\n                { \"field\": \"open\", \"type\": \"quantitative\", \"title\": \"Open\", \"format\": \".2f\" },\n                { \"field\": \"high\", \"type\": \"quantitative\", \"title\": \"High\", \"format\": \".2f\" },\n                { \"field\": \"low\", \"type\": \"quantitative\", \"title\": \"Low\", \"format\": \".2f\" },\n                { \"field\": \"close\", \"type\": \"quantitative\", \"title\": \"Close\", \"format\": \".2f\" }\n              ]\n            }\n          }\n        ],\n        \"config\": {\n          \"font\": \"Segoe UI\",\n          \"axis\": {\n            \"labelColor\": \"#605e5c\",\n            \"titleColor\": \"#323130\",\n            \"gridColor\": \"#f3f2f1\"\n          }\n        }\n      };\n      const chartId = `candlestick_${invocation.address.replace(/[^A-Za-z0-9]/g, \"_\")}`;\n      createChart(spec, \"candlestick\", chartId)\n        .then(() => resolve(\"Candlestick\"))\n        .catch((error) => resolve(`Error: ${error.message}`));\n\n    } catch (error) {\n      resolve(`Error: ${error.message}`);\n    }\n  });\n}\n\n/**\n * ARC custom function\n * Creates an arc diagram from Excel data range\n * \n * @customfunction\n * @requiresAddress\n * @param {any[][]} data The data range including headers\n * @param {CustomFunctions.Invocation} invocation Invocation object\n * @returns {string} Status message\n */\nfunction ARC(data, invocation) {\n  return new Promise((resolve) => {\n    try {\n      if (!data || data.length < 2) {\n        resolve(\"Error: Need at least header row + one data row\");\n        return;\n      }\n\n      const headers = data[0];\n      const rows = data.slice(1);\n\n      if (headers.length < 2) {\n        resolve(\"Error: Arc chart requires at least 2 columns (Source, Target, Weight optional)\");\n        return;\n      }\n\n      // Convert rows -> objects (same as taskpane.js)\n      const processedData = rows.map(row => {\n        let obj = {};\n        headers.forEach((h, i) => {\n          obj[h] = row[i];\n        });\n        return obj;\n      });\n\n      // EXACT data processing from taskpane.js - Transform Excel data for arc chart\n      const edges = processedData.map((row, index) => ({\n        source: row[headers[0]],\n        target: row[headers[1]],\n        value: headers.length >= 3 && row[headers[2]] ? row[headers[2]] : 1,\n        group: headers.length >= 4 && row[headers[3]] ? row[headers[3]] : \"default\"\n      }));\n\n      // Get unique nodes from edges\n      const nodeMap = new Map();\n      edges.forEach(edge => {\n        if (!nodeMap.has(edge.source)) {\n          nodeMap.set(edge.source, { \n            name: edge.source, \n            group: edge.group,\n            index: nodeMap.size\n          });\n        }\n        if (!nodeMap.has(edge.target)) {\n          nodeMap.set(edge.target, { \n            name: edge.target, \n            group: edge.group,\n            index: nodeMap.size\n          });\n        }\n      });\n\n      const nodes = Array.from(nodeMap.values());\n\n      // Transform edges to use node indices\n      const edgesWithIndices = edges.map(edge => ({\n        source: nodeMap.get(edge.source).index,\n        target: nodeMap.get(edge.target).index,\n        value: edge.value\n      }));\n\n      // Use EXACT specification from taskpane.js arc chart\n      const spec = {\n        $schema: \"https://vega.github.io/schema/vega/v5.json\",\n        description: \"Arc diagram from Excel selection\",\n        width: Math.max(600, nodes.length * 30),\n        height: 100,\n        padding: { top: 20, bottom: 20, left: 20, right: 20 },\n        background: \"white\",\n        config: { view: { stroke: \"transparent\" }},\n        data: [\n          {\n            name: \"edges\",\n            values: edgesWithIndices\n          },\n          {\n            name: \"sourceDegree\",\n            source: \"edges\",\n            transform: [\n              { type: \"aggregate\", groupby: [\"source\"], as: [\"count\"] }\n            ]\n          },\n          {\n            name: \"targetDegree\", \n            source: \"edges\",\n            transform: [\n              { type: \"aggregate\", groupby: [\"target\"], as: [\"count\"] }\n            ]\n          },\n          {\n            name: \"nodes\",\n            values: nodes,\n            transform: [\n              { type: \"window\", ops: [\"rank\"], as: [\"order\"] },\n              {\n                type: \"lookup\", from: \"sourceDegree\", key: \"source\",\n                fields: [\"index\"], as: [\"sourceDegree\"],\n                default: { count: 0 }\n              },\n              {\n                type: \"lookup\", from: \"targetDegree\", key: \"target\", \n                fields: [\"index\"], as: [\"targetDegree\"],\n                default: { count: 0 }\n              },\n              {\n                type: \"formula\", as: \"degree\",\n                expr: \"(datum.sourceDegree.count || 0) + (datum.targetDegree.count || 0)\"\n              }\n            ]\n          }\n        ],\n\n        scales: [\n          {\n            name: \"position\",\n            type: \"band\",\n            domain: { data: \"nodes\", field: \"order\", sort: true },\n            range: \"width\"\n          },\n          {\n            name: \"color\",\n            type: \"ordinal\",\n            range: { scheme: \"category20\" },\n            domain: { data: \"nodes\", field: \"group\" }\n          }\n        ],\n\n        marks: [\n          {\n            type: \"symbol\",\n            name: \"layout\",\n            interactive: false,\n            from: { data: \"nodes\" },\n            encode: {\n              enter: { opacity: { value: 0 } },\n              update: {\n                x: { scale: \"position\", field: \"order\" },\n                y: { value: 0 },\n                size: { field: \"degree\", mult: 8, offset: 50 },\n                fill: { scale: \"color\", field: \"group\" }\n              }\n            }\n          },\n          {\n            type: \"path\",\n            from: { data: \"edges\" },\n            encode: {\n              update: {\n                stroke: { value: \"#0078d4\" },\n                strokeOpacity: { value: 0.4 },\n                strokeWidth: { field: \"value\", mult: 2, offset: 1 }\n              }\n            },\n            transform: [\n              {\n                type: \"lookup\", from: \"layout\", key: \"datum.index\",\n                fields: [\"datum.source\", \"datum.target\"],\n                as: [\"sourceNode\", \"targetNode\"]\n              },\n              {\n                type: \"linkpath\",\n                sourceX: { expr: \"min(datum.sourceNode.x, datum.targetNode.x)\" },\n                targetX: { expr: \"max(datum.sourceNode.x, datum.targetNode.x)\" },\n                sourceY: { expr: \"0\" },\n                targetY: { expr: \"0\" },\n                shape: \"arc\"\n              }\n            ]\n          },\n          {\n            type: \"symbol\",\n            from: { data: \"layout\" },\n            encode: {\n              update: {\n                x: { field: \"x\" },\n                y: { field: \"y\" },\n                fill: { field: \"fill\" },\n                size: { field: \"size\" },\n                stroke: { value: \"white\" },\n                strokeWidth: { value: 1 },\n                tooltip: { \n                  signal: \"{'Node': datum.datum.name, 'Group': datum.datum.group, 'Connections': datum.datum.degree}\" \n                }\n              }\n            }\n          },\n          {\n            type: \"text\",\n            from: { data: \"nodes\" },\n            encode: {\n              update: {\n                x: { scale: \"position\", field: \"order\" },\n                y: { value: 25 },\n                fontSize: { value: 10 },\n                align: { value: \"center\" },\n                baseline: { value: \"top\" },\n                angle: { value: -45 },\n                text: { field: \"name\" },\n                fill: { value: \"#323130\" },\n                font: { value: \"Segoe UI\" }\n              }\n            }\n          }\n        ],\n        \n        config: {\n          view: { stroke: \"transparent\" },\n          font: \"Segoe UI\",\n          text: { font: \"Segoe UI\", fontSize: 10, fill: \"#605e5c\" }\n        }\n      };\n      const chartId = `arc_${invocation.address.replace(/[^A-Za-z0-9]/g, \"_\")}`;\n      createChart(spec, \"arc\", chartId)\n        .then(() => resolve(\"Arc\"))\n        .catch((error) => resolve(`Error: ${error.message}`));\n\n    } catch (error) {\n      resolve(`Error: ${error.message}`);\n    }\n  });\n}\n\n/**\n * TREE custom function\n * Creates a tree diagram from Excel data range\n * \n * @customfunction\n * @requiresAddress\n * @param {any[][]} data The data range including headers\n * @param {CustomFunctions.Invocation} invocation Invocation object\n * @returns {string} Status message\n */\nfunction TREE(data, invocation) {\n  return new Promise((resolve) => {\n    try {\n      if (!data || data.length < 2) {\n        resolve(\"Error: Need at least header row + one data row\");\n        return;\n      }\n\n      const headers = data[0];\n      const rows = data.slice(1);\n\n      if (headers.length < 2) {\n        resolve(\"Error: Tree chart requires at least 2 columns (Parent, Child, Value optional)\");\n        return;\n      }\n\n      // Process data same as taskpane.js\n      const nodes = new Map();\n\n      rows.forEach((row, i) => {\n        const parent = row[0] || \"\";\n        const child = row[1] || `node_${i}`;\n        const value = headers.length >= 3 ? (parseFloat(row[2]) || 1) : 1;\n        \n        // Add parent node if it doesn't exist and is not empty\n        if (parent && !nodes.has(parent)) {\n          nodes.set(parent, {\n            id: parent,\n            parent: \"\",\n            name: parent,\n            value: 1\n          });\n        }\n        \n        // Add child node\n        if (!nodes.has(child)) {\n          nodes.set(child, {\n            id: child,\n            parent: parent,\n            name: child,\n            value: value\n          });\n        } else {\n          // Update parent and value if child already exists\n          const existingNode = nodes.get(child);\n          existingNode.parent = parent;\n          existingNode.value = value;\n        }\n      });\n      \n      // Convert Map to array\n      const treeData = Array.from(nodes.values());\n      \n      // Find root nodes (nodes with no parent or parent not in dataset)\n      const allIds = new Set(treeData.map(d => d.id));\n      treeData.forEach(node => {\n        if (node.parent && !allIds.has(node.parent)) {\n          node.parent = \"\"; // Make it a root node if parent doesn't exist\n        }\n      });\n\n      // Calculate dynamic dimensions based on data size\n      const nodeCount = treeData.length;\n      const dynamicWidth = Math.max(600, Math.min(1200, nodeCount * 40));\n      const dynamicHeight = Math.max(400, Math.min(1600, nodeCount * 30));\n\n      // Use EXACT specification from taskpane.js tree chart\n      const spec = {\n        \"$schema\": \"https://vega.github.io/schema/vega/v6.json\",\n        \"description\": \"Tree diagram from Excel selection\",\n        \"width\": dynamicWidth,\n        \"height\": dynamicHeight,\n        \"padding\": 20,\n        \"background\": \"white\",\n        \"config\": { \"view\": { \"stroke\": \"transparent\" }},\n\n        \"signals\": [\n          {\n            \"name\": \"layout\", \n            \"value\": \"tidy\"\n          },\n          {\n            \"name\": \"links\", \n            \"value\": \"diagonal\"\n          }\n        ],\n\n        \"data\": [\n          {\n            \"name\": \"tree\",\n            \"values\": treeData,\n            \"transform\": [\n              {\n                \"type\": \"stratify\",\n                \"key\": \"id\",\n                \"parentKey\": \"parent\"\n              },\n              {\n                \"type\": \"tree\",\n                \"method\": {\"signal\": \"layout\"},\n                \"size\": [{\"signal\": \"height - 40\"}, {\"signal\": \"width - 100\"}],\n                \"as\": [\"y\", \"x\", \"depth\", \"children\"]\n              }\n            ]\n          },\n          {\n            \"name\": \"links\",\n            \"source\": \"tree\",\n            \"transform\": [\n              { \"type\": \"treelinks\" },\n              {\n                \"type\": \"linkpath\",\n                \"orient\": \"horizontal\",\n                \"shape\": {\"signal\": \"links\"}\n              }\n            ]\n          }\n        ],\n\n        \"scales\": [\n          {\n            \"name\": \"color\",\n            \"type\": \"ordinal\",\n            \"range\": [\"#0078d4\", \"#00bcf2\", \"#40e0d0\", \"#00cc6a\", \"#10893e\", \"#107c10\", \"#bad80a\", \"#ffb900\", \"#ff8c00\", \"#d13438\"],\n            \"domain\": {\"data\": \"tree\", \"field\": \"depth\"}\n          },\n          {\n            \"name\": \"size\",\n            \"type\": \"linear\",\n            \"range\": [100, 400],\n            \"domain\": {\"data\": \"tree\", \"field\": \"value\"}\n          }\n        ],\n\n        \"marks\": [\n          {\n            \"type\": \"path\",\n            \"from\": {\"data\": \"links\"},\n            \"encode\": {\n              \"update\": {\n                \"path\": {\"field\": \"path\"},\n                \"stroke\": {\"value\": \"#8a8886\"},\n                \"strokeWidth\": {\"value\": 2},\n                \"strokeOpacity\": {\"value\": 0.6}\n              }\n            }\n          },\n          {\n            \"type\": \"symbol\",\n            \"from\": {\"data\": \"tree\"},\n            \"encode\": {\n              \"enter\": {\n                \"stroke\": {\"value\": \"#ffffff\"},\n                \"strokeWidth\": {\"value\": 2}\n              },\n              \"update\": {\n                \"x\": {\"field\": \"x\"},\n                \"y\": {\"field\": \"y\"},\n                \"size\": {\"scale\": \"size\", \"field\": \"value\"},\n                \"fill\": {\"scale\": \"color\", \"field\": \"depth\"},\n                \"fillOpacity\": {\"value\": 0.8},\n                \"tooltip\": {\n                  \"signal\": \"{'Name': datum.name, 'ID': datum.id, 'Parent': datum.parent, 'Depth': datum.depth, 'Value': datum.value}\"\n                }\n              },\n              \"hover\": {\n                \"fillOpacity\": {\"value\": 1.0},\n                \"strokeWidth\": {\"value\": 3}\n              }\n            }\n          },\n          {\n            \"type\": \"text\",\n            \"from\": {\"data\": \"tree\"},\n            \"encode\": {\n              \"enter\": {\n                \"fontSize\": {\"value\": 11},\n                \"baseline\": {\"value\": \"middle\"},\n                \"font\": {\"value\": \"Segoe UI\"},\n                \"fontWeight\": {\"value\": \"bold\"}\n              },\n              \"update\": {\n                \"x\": {\"field\": \"x\"},\n                \"y\": {\"field\": \"y\"},\n                \"text\": {\"field\": \"name\"},\n                \"dx\": {\"signal\": \"datum.children ? -12 : 12\"},\n                \"align\": {\"signal\": \"datum.children ? 'right' : 'left'\"},\n                \"fill\": {\"value\": \"#323130\"}\n              }\n            }\n          }\n        ]\n      };\n      const chartId = `tree_${invocation.address.replace(/[^A-Za-z0-9]/g, \"_\")}`;\n      createChart(spec, \"tree\", chartId)\n        .then(() => resolve(\"Tree\"))\n        .catch((error) => resolve(`Error: ${error.message}`));\n\n    } catch (error) {\n      resolve(`Error: ${error.message}`);\n    }\n  });\n}\n\n/**\n * WORDCLOUD custom function\n * Creates a word cloud from Excel data range\n * \n * @customfunction\n * @requiresAddress\n * @param {any[][]} data The data range including headers\n * @param {CustomFunctions.Invocation} invocation Invocation object\n * @returns {string} Status message\n */\nfunction WORDCLOUD(data, invocation) {\n  return new Promise((resolve) => {\n    try {\n      if (!data || data.length < 2) {\n        resolve(\"Error: Need at least header row + one data row\");\n        return;\n      }\n\n      const headers = data[0];\n      const rows = data.slice(1);\n\n      if (headers.length < 1) {\n        resolve(\"Error: Wordcloud requires at least 1 column (Text data)\");\n        return;\n      }\n\n      // Convert rows -> objects (same as taskpane.js)\n      const processedData = rows.map(row => {\n        let obj = {};\n        headers.forEach((h, i) => {\n          obj[h] = row[i];\n        });\n        return obj;\n      });\n\n      // Use EXACT specification from taskpane.js wordcloud chart\n      const spec = {\n        $schema: \"https://vega.github.io/schema/vega/v5.json\",\n        description: \"Word cloud from Excel selection\",\n        width: 800,\n        height: 400,\n        padding: 0,\n        background: \"white\",\n        config: { view: { stroke: \"transparent\" }},\n        data: [\n          {\n            name: \"table\",\n            values: processedData,\n            transform: [\n              {\n                type: \"countpattern\",\n                field: headers[0], // Use first column as text source\n                case: \"upper\",\n                pattern: \"[\\\\w']{3,}\",\n                stopwords: \"(i|me|my|myself|we|us|our|ours|ourselves|you|your|yours|yourself|yourselves|he|him|his|himself|she|her|hers|herself|it|its|itself|they|them|their|theirs|themselves|what|which|who|whom|whose|this|that|these|those|am|is|are|was|were|be|been|being|have|has|had|having|do|does|did|doing|will|would|should|can|could|ought|i'm|you're|he's|she's|it's|we're|they're|i've|you've|we've|they've|i'd|you'd|he'd|she'd|we'd|they'd|i'll|you'll|he'll|she'll|we'll|they'll|isn't|aren't|wasn't|weren't|hasn't|haven't|hadn't|doesn't|don't|didn't|won't|wouldn't|shan't|shouldn't|can't|cannot|couldn't|mustn't|let's|that's|who's|what's|here's|there's|when's|where's|why's|how's|a|an|the|and|but|if|or|because|as|until|while|of|at|by|for|with|about|against|between|into|through|during|before|after|above|below|to|from|up|upon|down|in|out|on|off|over|under|again|further|then|once|here|there|when|where|why|how|all|any|both|each|few|more|most|other|some|such|no|nor|not|only|own|same|so|than|too|very|say|says|said|shall)\"\n              },\n              {\n                type: \"formula\", \n                as: \"angle\",\n                expr: \"[-45, 0, 45][~~(random() * 3)]\"\n              },\n              {\n                type: \"formula\", \n                as: \"weight\",\n                expr: \"if(datum.count > 10, 600, 300)\"\n              }\n            ]\n          }\n        ],\n        \n        scales: [\n          {\n            name: \"color\",\n            type: \"ordinal\",\n            domain: { data: \"table\", field: \"text\" },\n            range: [\"#d5a928\", \"#652c90\", \"#939597\", \"#2563eb\", \"#dc2626\", \"#059669\"]\n          }\n        ],\n        \n        marks: [\n          {\n            type: \"text\",\n            from: { data: \"table\" },\n            encode: {\n              enter: {\n                text: { field: \"text\" },\n                align: { value: \"center\" },\n                baseline: { value: \"alphabetic\" },\n                fill: { scale: \"color\", field: \"text\" }\n              },\n              update: {\n                fillOpacity: { value: 1 }\n              },\n              hover: {\n                fillOpacity: { value: 0.5 }\n              }\n            },\n            transform: [\n              {\n                type: \"wordcloud\",\n                size: [800, 400],\n                text: { field: \"text\" },\n                rotate: { field: \"datum.angle\" },\n                font: \"Helvetica Neue, Arial\",\n                fontSize: { field: \"datum.count\" },\n                fontWeight: { field: \"datum.weight\" },\n                fontSizeRange: [12, 56],\n                padding: 2\n              }\n            ]\n          }\n        ]\n      };\n      const chartId = `wordcloud_${invocation.address.replace(/[^A-Za-z0-9]/g, \"_\")}`;\n      createChart(spec, \"wordcloud\", chartId)\n        .then(() => resolve(\"Word Cloud\"))\n        .catch((error) => resolve(`Error: ${error.message}`));\n\n    } catch (error) {\n      resolve(`Error: ${error.message}`);\n    }\n  });\n}\n\n/**\n * STRIP custom function\n * Creates a strip plot from Excel data range\n * \n * @customfunction\n * @requiresAddress\n * @param {any[][]} data The data range including headers\n * @param {CustomFunctions.Invocation} invocation Invocation object\n * @returns {string} Status message\n */\nfunction STRIP(data, invocation) {\n  return new Promise((resolve) => {\n    try {\n      if (!data || data.length < 2) {\n        resolve(\"Error: Need at least header row + one data row\");\n        return;\n      }\n\n      const headers = data[0];\n      const rows = data.slice(1);\n\n      if (headers.length < 2) {\n        resolve(\"Error: Strip plot requires at least 2 columns (Categories, Values)\");\n        return;\n      }\n\n      // Convert rows -> objects (same as taskpane.js)\n      const processedData = rows.map(row => {\n        let obj = {};\n        headers.forEach((h, i) => {\n          obj[h] = row[i];\n        });\n        return obj;\n      });\n\n      // Use EXACT specification from taskpane.js strip chart\n      const spec = {\n        $schema: \"https://vega.github.io/schema/vega-lite/v6.json\",\n        description: \"Strip plot showing distribution using tick marks\",\n        background: \"white\",\n        config: { \n          view: { stroke: \"transparent\" },\n          axis: {\n            labelFontSize: 11,\n            titleFontSize: 12,\n            labelColor: \"#605E5C\",\n            titleColor: \"#323130\"\n          }\n        },\n        data: { values: processedData },\n        mark: {\n          type: \"tick\",\n          thickness: 2,\n          size: 15,\n          color: \"#0078d4\",\n          opacity: 0.8,\n          tooltip: true\n        },\n        encoding: {\n          y: { \n            field: headers[0],\n            type: \"ordinal\",\n            axis: {\n              title: headers[0],\n              labelAngle: 0\n            }\n          },\n          x: { \n            field: headers[1],\n            type: \"quantitative\",\n            axis: {\n              title: headers[1],\n              grid: true,\n              gridColor: \"#f3f2f1\",\n              gridOpacity: 0.5\n            }\n          },\n          // Add color encoding if 3rd column exists\n          ...(headers.length > 2 && {\n            color: {\n              field: headers[2],\n              type: \"nominal\",\n              scale: { scheme: \"category10\" },\n              legend: {\n                title: headers[2],\n                orient: \"right\",\n                titleFontSize: 11,\n                labelFontSize: 10\n              }\n            }\n          }),\n          tooltip: headers.map(h => ({ field: h, type: \"nominal\" }))\n        }\n      };\n      const chartId = `strip_${invocation.address.replace(/[^A-Za-z0-9]/g, \"_\")}`;\n      createChart(spec, \"strip\", chartId)\n        .then(() => resolve(\"Strip\"))\n        .catch((error) => resolve(`Error: ${error.message}`));\n\n    } catch (error) {\n      resolve(`Error: ${error.message}`);\n    }\n  });\n}\n\n/**\n * HEATMAP custom function\n * Creates a heatmap from Excel data range\n * \n * @customfunction\n * @requiresAddress\n * @param {any[][]} data The data range including headers\n * @param {CustomFunctions.Invocation} invocation Invocation object\n * @returns {string} Status message\n */\nfunction HEATMAP(data, invocation) {\n  return new Promise((resolve) => {\n    try {\n      if (!data || data.length < 2) {\n        resolve(\"Error: Need at least header row + one data row\");\n        return;\n      }\n\n      const headers = data[0];\n      const rows = data.slice(1);\n\n      if (headers.length < 3) {\n        resolve(\"Error: Heatmap requires 3 columns (Y-categories, X-categories, Values)\");\n        return;\n      }\n\n      // Convert rows -> objects (same as taskpane.js)\n      const processedData = rows.map(row => {\n        let obj = {};\n        headers.forEach((h, i) => {\n          obj[h] = row[i];\n        });\n        return obj;\n      });\n\n      const spec = {\n        $schema: \"https://vega.github.io/schema/vega-lite/v5.json\",\n        description: \"Heatmap from Excel selection\",\n        background: \"white\",\n        data: { values: processedData },\n        mark: {\n          type: \"rect\",\n          stroke: \"white\",\n          tooltip: true\n        },\n        encoding: {\n          y: {\n            field: headers[0],\n            type: \"ordinal\",\n            title: headers[0],\n            axis: {\n              domain: false,\n              ticks: false,\n              labels: true,\n              labelAngle: 0,\n              labelPadding: 5\n            }\n          },\n          x: {\n            field: headers[1],\n            type: \"ordinal\",\n            title: headers[1],\n            axis: {\n              domain: false,\n              ticks: false,\n              labels: true,\n              labelAngle: 0\n            }\n          },\n          color: {\n            aggregate: \"mean\",\n            field: headers[2],\n            type: \"quantitative\",\n            legend: {\n              title: null,\n              direction: \"vertical\",\n              orient: \"right\",\n              titleAlign: \"center\",\n              labelAlign: \"center\"\n            }\n          }\n        },\n        config: {\n          view: { stroke: \"transparent\" },\n          font: \"Segoe UI\",\n          text: { font: \"Segoe UI\", fontSize: 12, fill: \"#605E5C\" },\n          axis: {\n            ticks: false,\n            grid: false,\n            domain: false,\n            labelColor: \"#605E5C\",\n            labelFontSize: 12,\n            titleFontSize: 14,\n            titleColor: \"#323130\"\n          },\n          legend: {\n            titleFont: \"Segoe UI\",\n            titleFontWeight: \"bold\",\n            titleColor: \"#605E5C\",\n            labelFont: \"Segoe UI\",\n            labelFontSize: 12,\n            labelColor: \"#605E5C\",\n            titleAlign: \"center\",\n            labelAlign: \"center\"\n          }\n        }\n      };\n\n      const chartId = `heatmap_${invocation.address.replace(/[^A-Za-z0-9]/g, \"_\")}`;\n      createChart(spec, \"heatmap\", chartId)\n        .then(() => resolve(\"Heatmap\"))\n        .catch((error) => resolve(`Error: ${error.message}`));\n\n    } catch (error) {\n      resolve(`Error: ${error.message}`);\n    }\n  });\n}\n\n/**\n * TABLEBUBBLE custom function\n * Creates a table bubble chart from Excel data range\n * \n * @customfunction\n * @requiresAddress\n * @param {any[][]} data The data range including headers\n * @param {CustomFunctions.Invocation} invocation Invocation object\n * @returns {string} Status message\n */\nfunction TABLEBUBBLE(data, invocation) {\n  return new Promise((resolve) => {\n    try {\n      if (!data || data.length < 2) {\n        resolve(\"Error: Need at least header row + one data row\");\n        return;\n      }\n      const headers = data[0];\n      const rows = data.slice(1);\n      if (headers.length < 3) {\n        resolve(\"Error: Table bubble chart requires 3 columns (Y-categories, X-categories, Values)\");\n        return;\n      }\n      // Convert rows -> objects (same as taskpane.js)\n      const processedData = rows.map(row => {\n        let obj = {};\n        headers.forEach((h, i) => {\n          obj[h] = row[i];\n        });\n        return obj;\n      });\n      const spec = {\n        $schema: \"https://vega.github.io/schema/vega-lite/v5.json\",\n        description: \"Table Bubble Chart from Excel selection\",\n        background: \"white\",\n        data: { values: processedData },\n        mark: {\n          type: \"circle\",\n          opacity: 0.9,\n          stroke: \"transparent\",\n          tooltip: true\n        },\n        encoding: {\n          y: {\n            field: headers[0],\n            type: \"ordinal\",\n            sort: \"descending\",\n            title: headers[0],\n            axis: {\n              domain: false,\n              ticks: false,\n              labels: true,\n              labelAngle: 0,\n              labelPadding: 5\n            }\n          },\n          x: {\n            field: headers[1],\n            type: \"ordinal\",\n            title: headers[1],\n            axis: {\n              domain: false,\n              ticks: false,\n              labels: true,\n              labelAngle: 0\n            }\n          },\n          size: {\n            aggregate: \"sum\",\n            field: headers[2],\n            type: \"quantitative\",\n            legend: {\n              title: headers[2],\n              direction: \"vertical\",\n              orient: \"right\",\n              titleAlign: \"center\",\n              labelAlign: \"center\"\n            }\n          },\n          color: {\n            aggregate: \"sum\",\n            field: headers[2],\n            type: \"quantitative\",\n            scale: {\n              range: [\"#2999AA\", \"orange\"]\n            },\n            legend: null\n          }\n        },\n        config: {\n          view: { stroke: \"transparent\" },\n          font: \"Segoe UI\",\n          text: { font: \"Segoe UI\", fontSize: 12, fill: \"#605E5C\" },\n          axis: {\n            ticks: false,\n            grid: false,\n            domain: false,\n            labelColor: \"#605E5C\",\n            labelFontSize: 12,\n            titleFontSize: 14,\n            titleColor: \"#323130\"\n          },\n          legend: {\n            titleFont: \"Segoe UI\",\n            titleFontWeight: \"bold\",\n            titleColor: \"#605E5C\",\n            labelFont: \"Segoe UI\",\n            labelFontSize: 12,\n            labelColor: \"#605E5C\",\n            titleAlign: \"center\",\n            labelAlign: \"center\"\n          }\n        }\n      };\n      const chartId = `tablebubble_${invocation.address.replace(/[^A-Za-z0-9]/g, \"_\")}`;\n      createChart(spec, \"tablebubble\", chartId)\n        .then(() => resolve(\"Table Bubble\"))\n        .catch((error) => resolve(`Error: ${error.message}`));\n    } catch (error) {\n      resolve(`Error: ${error.message}`);\n    }\n  });\n}\n\n/**\n * BULLET custom function\n * Creates a bullet chart from Excel data range\n * \n * @customfunction\n * @requiresAddress\n * @param {any[][]} data The data range including headers\n * @param {CustomFunctions.Invocation} invocation Invocation object\n * @returns {string} Status message\n */\nfunction BULLET(data, invocation) {\n  return new Promise((resolve) => {\n    try {\n      if (!data || data.length < 2) {\n        resolve(\"Error: Need at least header row + one data row\");\n        return;\n      }\n\n      const headers = data[0];\n      const rows = data.slice(1);\n\n      if (headers.length < 7) {\n        resolve(\"Error: Bullet chart requires 7 columns (Title, Poor max, Satisfactory max, Good max, Actual, Forecast, Target)\");\n        return;\n      }\n\n      // Convert to bullet chart data format (same as taskpane.js)\n      const processedData = rows.map(r => ({\n        title: r[0],\n        ranges: [+r[1], +r[2], +r[3]],\n        measures: [+r[4], +r[5]],\n        markers: [+r[6]]\n      }));\n\n      // Use EXACT specification from taskpane.js bullet chart\n      const spec = {\n        \"$schema\": \"https://vega.github.io/schema/vega-lite/v6.json\",\n        background: \"white\",\n        config: { view: { stroke: \"transparent\" }},\n        \"data\": { \"values\": processedData },\n        \"facet\": {\n          \"row\": {\n            \"field\": \"title\", \"type\": \"ordinal\",\n            \"header\": { \"labelAngle\": 0, \"title\": \"\", \"labelAlign\": \"left\" }\n          }\n        },\n        \"spacing\": 10,\n        \"spec\": {\n          \"encoding\": {\n            \"x\": {\n              \"type\": \"quantitative\",\n              \"scale\": { \"nice\": false },\n              \"title\": null\n            }\n          },\n          \"layer\": [\n            { \"mark\": { \"type\": \"bar\", \"color\": \"#eee\" }, \"encoding\": { \"x\": { \"field\": \"ranges[2]\" } } },\n            { \"mark\": { \"type\": \"bar\", \"color\": \"#ddd\" }, \"encoding\": { \"x\": { \"field\": \"ranges[1]\" } } },\n            { \"mark\": { \"type\": \"bar\", \"color\": \"#ccc\" }, \"encoding\": { \"x\": { \"field\": \"ranges[0]\" } } },\n            { \"mark\": { \"type\": \"bar\", \"color\": \"lightsteelblue\", \"size\": 10 }, \"encoding\": { \"x\": { \"field\": \"measures[1]\" } } },\n            { \"mark\": { \"type\": \"bar\", \"color\": \"steelblue\", \"size\": 10 }, \"encoding\": { \"x\": { \"field\": \"measures[0]\" } } },\n            { \"mark\": { \"type\": \"tick\", \"color\": \"black\" }, \"encoding\": { \"x\": { \"field\": \"markers[0]\" } } }\n          ]\n        },\n        \"resolve\": { \"scale\": { \"x\": \"independent\" } },\n        \"config\": { \"tick\": { \"thickness\": 2 }, \"scale\": { \"barBandPaddingInner\": 0 } }\n      };\n      const chartId = `bullet_${invocation.address.replace(/[^A-Za-z0-9]/g, \"_\")}`;\n      createChart(spec, \"bullet\", chartId)\n        .then(() => resolve(\"Bullet\"))\n        .catch((error) => resolve(`Error: ${error.message}`));\n\n    } catch (error) {\n      resolve(`Error: ${error.message}`);\n    }\n  });\n}\n\n/**\n * HORIZON custom function\n * Creates a horizon chart from Excel data range\n * \n * @customfunction\n * @requiresAddress\n * @param {any[][]} data The data range including headers\n * @param {CustomFunctions.Invocation} invocation Invocation object\n * @returns {string} Status message\n */\nfunction HORIZON(data, invocation) {\n  return new Promise((resolve) => {\n    try {\n      if (!data || data.length < 2) {\n        resolve(\"Error: Need at least header row + one data row\");\n        return;\n      }\n\n      const headers = data[0];\n      const rows = data.slice(1);\n\n      if (headers.length < 2) {\n        resolve(\"Error: Horizon chart requires 2 columns (X values, Y values)\");\n        return;\n      }\n\n      // Convert rows -> objects and transform data (same as taskpane.js)\n      const horizonData = rows.map((row, index) => ({\n        x: row[0] || index + 1,\n        y: parseFloat(row[1]) || 0\n      }));\n\n      // Calculate data range and bands (same as taskpane.js)\n      const yValues = horizonData.map(d => d.y);\n      const maxY = Math.max(...yValues);\n      const minY = Math.min(...yValues);\n      const range = maxY - minY;\n      \n      // Define number of bands (typically 2-4 for horizon graphs)\n      const numBands = 3;\n      const bandHeight = range / (numBands * 2); // Divide by 2 for positive and negative\n      const baseline = minY + range / 2; // Use middle as baseline\n      \n      // Calculate dynamic dimensions\n      const dataPoints = horizonData.length;\n      const dynamicWidth = Math.max(300, Math.min(800, dataPoints * 15));\n\n      // Use EXACT specification from taskpane.js horizon chart\n      const spec = {\n        \"$schema\": \"https://vega.github.io/schema/vega-lite/v6.json\",\n        \"description\": \"Horizon Graph from Excel selection (IDL methodology)\",\n        \"width\": dynamicWidth,\n        \"height\": 60,\n        \"background\": \"white\",\n        \"config\": { \n          \"view\": { \"stroke\": \"transparent\" },\n          \"area\": {\"interpolate\": \"monotone\"}\n        },\n        \"data\": { \"values\": horizonData },\n        \"encoding\": {\n          \"x\": {\n            \"field\": \"x\",\n            \"type\": headers[0].toLowerCase().includes('date') ? \"temporal\" : \"quantitative\",\n            \"scale\": {\"zero\": false, \"nice\": false},\n            \"axis\": {\n              \"title\": headers[0],\n              \"labelFontSize\": 10,\n              \"titleFontSize\": 12,\n              \"labelColor\": \"#605e5c\",\n              \"titleColor\": \"#323130\",\n              \"font\": \"Segoe UI\"\n            }\n          },\n          \"y\": {\n            \"type\": \"quantitative\",\n            \"scale\": {\"domain\": [0, bandHeight]},\n            \"axis\": {\n              \"title\": headers[1],\n              \"orient\": \"left\",\n              \"labelFontSize\": 10,\n              \"titleFontSize\": 12,\n              \"labelColor\": \"#605e5c\",\n              \"titleColor\": \"#323130\",\n              \"font\": \"Segoe UI\",\n              \"tickCount\": 3\n            }\n          }\n        },\n        \"layer\": [\n          // Band 1 (lightest positive)\n          {\n            \"transform\": [\n              {\"calculate\": `max(0, min(datum.y - ${baseline}, ${bandHeight}))`, \"as\": \"band1\"}\n            ],\n            \"mark\": {\n              \"type\": \"area\",\n              \"clip\": true,\n              \"opacity\": 0.3,\n              \"color\": \"#4a90e2\",\n              \"interpolate\": \"monotone\"\n            },\n            \"encoding\": {\n              \"y\": {\"field\": \"band1\"}\n            }\n          },\n          // Band 2 (medium positive)\n          {\n            \"transform\": [\n              {\"calculate\": `max(0, min(datum.y - ${baseline} - ${bandHeight}, ${bandHeight}))`, \"as\": \"band2\"}\n            ],\n            \"mark\": {\n              \"type\": \"area\",\n              \"clip\": true,\n              \"opacity\": 0.6,\n              \"color\": \"#2e7bd6\",\n              \"interpolate\": \"monotone\"\n            },\n            \"encoding\": {\n              \"y\": {\"field\": \"band2\"}\n            }\n          },\n          // Band 3 (darkest positive)\n          {\n            \"transform\": [\n              {\"calculate\": `max(0, datum.y - ${baseline} - ${bandHeight * 2})`, \"as\": \"band3\"}\n            ],\n            \"mark\": {\n              \"type\": \"area\",\n              \"clip\": true,\n              \"opacity\": 0.9,\n              \"color\": \"#1a5bb8\",\n              \"interpolate\": \"monotone\"\n            },\n            \"encoding\": {\n              \"y\": {\"field\": \"band3\"}\n            }\n          },\n          // Band -1 (lightest negative, mirrored)\n          {\n            \"transform\": [\n              {\"calculate\": `max(0, min(${baseline} - datum.y, ${bandHeight}))`, \"as\": \"nband1\"}\n            ],\n            \"mark\": {\n              \"type\": \"area\",\n              \"clip\": true,\n              \"opacity\": 0.3,\n              \"color\": \"#e74c3c\",\n              \"interpolate\": \"monotone\"\n            },\n            \"encoding\": {\n              \"y\": {\"field\": \"nband1\"}\n            }\n          },\n          // Band -2 (medium negative, mirrored)\n          {\n            \"transform\": [\n              {\"calculate\": `max(0, min(${baseline} - datum.y - ${bandHeight}, ${bandHeight}))`, \"as\": \"nband2\"}\n            ],\n            \"mark\": {\n              \"type\": \"area\",\n              \"clip\": true,\n              \"opacity\": 0.6,\n              \"color\": \"#c0392b\",\n              \"interpolate\": \"monotone\"\n            },\n            \"encoding\": {\n              \"y\": {\"field\": \"nband2\"}\n            }\n          },\n          // Band -3 (darkest negative, mirrored)\n          {\n            \"transform\": [\n              {\"calculate\": `max(0, ${baseline} - datum.y - ${bandHeight * 2})`, \"as\": \"nband3\"}\n            ],\n            \"mark\": {\n              \"type\": \"area\",\n              \"clip\": true,\n              \"opacity\": 0.9,\n              \"color\": \"#a93226\",\n              \"interpolate\": \"monotone\"\n            },\n            \"encoding\": {\n              \"y\": {\"field\": \"nband3\"}\n            }\n          }\n        ]\n      };\n      const chartId = `horizon_${invocation.address.replace(/[^A-Za-z0-9]/g, \"_\")}`;\n      createChart(spec, \"horizon\", chartId)\n        .then(() => resolve(\"Horizon\"))\n        .catch((error) => resolve(`Error: ${error.message}`));\n\n    } catch (error) {\n      resolve(`Error: ${error.message}`);\n    }\n  });\n}\n\n/**\n * DUMBBELL custom function\n * Creates a dumbbell chart from Excel data range\n * \n * @customfunction\n * @requiresAddress\n * @param {any[][]} data The data range including headers\n * @param {CustomFunctions.Invocation} invocation Invocation object\n * @returns {string} Status message\n */\nfunction DUMBBELL(data, invocation) {\n  return new Promise((resolve) => {\n    try {\n      if (!data || data.length < 2) {\n        resolve(\"Error: Need at least header row + one data row\");\n        return;\n      }\n\n      const headers = data[0];\n      const rows = data.slice(1);\n\n      if (headers.length < 3) {\n        resolve(\"Error: Dumbbell chart requires 3 columns: Category, Value 1, Value 2\");\n        return;\n      }\n\n      // Convert rows -> objects\n      const processedData = rows.map(row => {\n        let obj = {};\n        headers.forEach((h, i) => {\n          obj[h] = row[i];\n        });\n        return obj;\n      });\n\n      // Transform wide data (Category | Value1 | Value2) to long format for Vega-Lite\n      const dumbellData = [];\n      \n      processedData.forEach(row => {\n        const category = row[headers[0]];\n        const value1 = parseFloat(row[headers[1]]) || 0;\n        const value2 = parseFloat(row[headers[2]]) || 0;\n        \n        // Add both data points for each category\n        dumbellData.push({\n          category: category,\n          period: headers[1], // First value label\n          value: value1\n        });\n        \n        dumbellData.push({\n          category: category,\n          period: headers[2], // Second value label  \n          value: value2\n        });\n      });\n\n      // Calculate dynamic dimensions based on number of categories\n      const categories = [...new Set(processedData.map(d => d[headers[0]]))];\n      const categoryCount = categories.length;\n      \n      // Auto-adjust height and padding based on category count\n      let dynamicHeight, paddingInner, paddingOuter;\n      \n      if (categoryCount <= 3) {\n        // Few categories: smaller height, minimal padding\n        dynamicHeight = Math.max(200, categoryCount * 80);\n        paddingInner = 0.3;\n        paddingOuter = 0.2;\n      } else if (categoryCount <= 6) {\n        // Medium categories: moderate height and padding\n        dynamicHeight = Math.max(300, categoryCount * 60);\n        paddingInner = 0.2;\n        paddingOuter = 0.1;\n      } else {\n        // Many categories: larger height, tight padding\n        dynamicHeight = Math.max(400, Math.min(600, categoryCount * 50));\n        paddingInner = 0.1;\n        paddingOuter = 0.05;\n      }\n\n      // Use EXACT specification matching taskpane.js\n      const spec = {\n        $schema: \"https://vega.github.io/schema/vega-lite/v6.json\",\n        description: \"Dumbbell chart from Excel selection\",\n        background: \"white\",\n        config: { view: { stroke: \"transparent\" }},\n        width: 500,\n        height: dynamicHeight,\n        data: { values: dumbellData },\n        encoding: {\n          x: { \n            field: \"value\", \n            type: \"quantitative\", \n            title: null,\n            scale: { zero: false },\n            axis: {\n              labelFontSize: 12,\n              labelColor: \"#605e5c\",\n              grid: true,\n              gridColor: \"#f3f2f1\",\n              labelAlign: \"center\"\n            }\n          },\n          y: { \n            field: \"category\", \n            type: \"nominal\", \n            title: null,\n            scale: { paddingInner: paddingInner, paddingOuter: paddingOuter },\n            axis: {\n              offset: 5,\n              ticks: false,\n              minExtent: 70,\n              domain: false,\n              labelFontSize: 12,\n              labelColor: \"#605e5c\"\n            }\n          }\n        },\n        layer: [\n          {\n            mark: \"line\",\n            encoding: {\n              detail: { field: \"category\", type: \"nominal\" },\n              color: { value: \"#d1d5db\" }\n            }\n          },\n          {\n            mark: { \n              type: \"point\", \n              filled: true,\n              tooltip: true\n            },\n            encoding: {\n              color: { \n                field: \"period\", \n                type: \"ordinal\",\n                scale: {\n                  domain: [headers[1], headers[2]],\n                  range: [\"#87ceeb\", \"#1e3a8a\"]\n                },\n                title: \"Measure\",\n                legend: {\n                  titleFontSize: 12,\n                  labelFontSize: 11,\n                  titleColor: \"#323130\",\n                  labelColor: \"#605e5c\"\n                }\n              },\n              size: { value: 100 },\n              opacity: { value: 1 },\n              tooltip: [\n                { field: \"category\", type: \"nominal\", title: \"Category\" },\n                { field: \"period\", type: \"nominal\", title: \"Measure\" },\n                { field: \"value\", type: \"quantitative\", title: \"Value\", format: \",.1f\" }\n              ]\n            }\n          }\n        ],\n        config: {\n          font: \"Segoe UI\",\n          axis: {\n            labelColor: \"#605e5c\",\n            titleColor: \"#323130\",\n            gridColor: \"#f3f2f1\"\n          },\n          legend: {\n            titleColor: \"#323130\",\n            labelColor: \"#605e5c\"\n          }\n        }\n      };\n      const chartId = `dumbbell_${invocation.address.replace(/[^A-Za-z0-9]/g, \"_\")}`;\n      createChart(spec, \"dumbbell\", chartId)\n        .then(() => resolve(\"Dumbbell\"))\n        .catch((error) => resolve(`Error: ${error.message}`));\n\n    } catch (error) {\n      resolve(`Error: ${error.message}`);\n    }\n  });\n}\n\n/**\n * SLOPE custom function\n * Creates a slope chart from Excel data range\n * \n * @customfunction\n * @requiresAddress\n * @param {any[][]} data The data range including headers\n * @param {CustomFunctions.Invocation} invocation Invocation object\n * @returns {string} Status message\n */\nfunction SLOPE(data, invocation) {\n  return new Promise((resolve) => {\n    try {\n      if (!data || data.length < 2) {\n        resolve(\"Error: Need at least header row + one data row\");\n        return;\n      }\n\n      const headers = data[0];\n      const rows = data.slice(1);\n\n      if (headers.length < 3) {\n        resolve(\"Error: Slope chart requires 3 columns (Time Period, Category, Value)\");\n        return;\n      }\n\n      // Convert rows -> objects (same as taskpane.js)\n      const processedData = rows.map(row => {\n        let obj = {};\n        headers.forEach((h, i) => {\n          obj[h] = row[i];\n        });\n        return obj;\n      });\n\n      const timePeriods = [...new Set(processedData.map(d => d[headers[0]]))];\n      const categories = [...new Set(processedData.map(d => d[headers[1]]))];\n      \n      // Filter data for first and last periods only (same as taskpane.js)\n      const firstPeriod = timePeriods[0];\n      const lastPeriod = timePeriods[timePeriods.length - 1];\n      \n      const slopeData = processedData.filter(d => \n        d[headers[0]] === firstPeriod || d[headers[0]] === lastPeriod\n      );\n\n      // Check if values are percentages (between -1 and 1)\n      const allValues = slopeData.map(d => d[headers[2]]);\n      const isPercentage = allValues.every(v => v >= -1 && v <= 1);\n      const formatString = isPercentage ? \".1%\" : \",.0f\";\n\n      // Calculate dynamic dimensions based on number of categories\n      const dynamicHeight = Math.max(300, Math.min(600, categories.length * 40));\n      const dynamicWidth = 500;\n\n      // Use EXACT specification from taskpane.js slope chart\n      const spec = {\n        $schema: \"https://vega.github.io/schema/vega-lite/v6.json\",\n        description: \"Slope chart from Excel selection\",\n        background: \"white\",\n        config: { \n          view: { stroke: \"transparent\" },\n          autosize: { type: \"fit\", contains: \"padding\" }\n        },\n        width: dynamicWidth,\n        height: dynamicHeight,\n        data: { values: slopeData },\n        encoding: {\n          x: {\n            field: headers[0],\n            type: \"ordinal\",\n            axis: {\n              title: null,\n              labelFontSize: 14,\n              labelFontWeight: \"bold\",\n              labelPadding: 10,\n              domain: false,\n              ticks: false,\n              labelColor: \"#323130\"\n            },\n            scale: { padding: 0.1 }\n          },\n          y: {\n            field: headers[2],\n            type: \"quantitative\",\n            axis: null,\n            scale: { zero: false }\n          },\n          color: {\n            field: headers[1],\n            type: \"nominal\",\n            legend: null,\n            scale: { scheme: \"category10\" }\n          }\n        },\n        layer: [\n          // Background grid lines\n          {\n            mark: {\n              type: \"rule\",\n              strokeDash: [2, 2],\n              opacity: 0.3\n            },\n            data: { values: [{}] },\n            encoding: {\n              x: { datum: firstPeriod },\n              x2: { datum: lastPeriod },\n              y: { value: 0 },\n              color: { value: \"#e0e0e0\" }\n            }\n          },\n          // Slope lines\n          {\n            mark: {\n              type: \"line\",\n              strokeWidth: 2,\n              opacity: 0.7,\n              tooltip: true\n            },\n            encoding: {\n              detail: { field: headers[1], type: \"nominal\" },\n              tooltip: [\n                { field: headers[1], type: \"nominal\", title: \"Category\" },\n                { field: headers[0], type: \"nominal\", title: \"Period\" },\n                { field: headers[2], type: \"quantitative\", title: \"Value\", format: formatString }\n              ]\n            }\n          },\n          // Points at the ends\n          {\n            mark: {\n              type: \"circle\",\n              size: 100,\n              opacity: 1,\n              tooltip: true\n            }\n          },\n          // Left side value labels\n          {\n            transform: [\n              { filter: `datum['${headers[0]}'] == '${firstPeriod}'` }\n            ],\n            mark: {\n              type: \"text\",\n              align: \"right\",\n              baseline: \"middle\",\n              dx: -8,\n              fontSize: 11,\n              fontWeight: \"normal\"\n            },\n            encoding: {\n              text: { \n                field: headers[2], \n                type: \"quantitative\",\n                format: formatString\n              }\n            }\n          },\n          // Left side category labels (for top values)\n          {\n            transform: [\n              { filter: `datum['${headers[0]}'] == '${firstPeriod}'` },\n              {\n                window: [{ op: \"rank\", as: \"rank\" }],\n                sort: [{ field: headers[2], order: \"descending\" }]\n              },\n              { filter: \"datum.rank <= 3\" }\n            ],\n            mark: {\n              type: \"text\",\n              align: \"right\",\n              baseline: \"bottom\",\n              dx: -8,\n              dy: -12,\n              fontSize: 10,\n              fontWeight: \"bold\",\n              fontStyle: \"italic\"\n            },\n            encoding: {\n              text: { field: headers[1], type: \"nominal\" }\n            }\n          },\n          // Right side value labels\n          {\n            transform: [\n              { filter: `datum['${headers[0]}'] == '${lastPeriod}'` }\n            ],\n            mark: {\n              type: \"text\",\n              align: \"left\",\n              baseline: \"middle\",\n              dx: 8,\n              fontSize: 11,\n              fontWeight: \"normal\"\n            },\n            encoding: {\n              text: { \n                field: headers[2], \n                type: \"quantitative\",\n                format: formatString\n              }\n            }\n          },\n          // Right side category labels\n          {\n            transform: [\n              { filter: `datum['${headers[0]}'] == '${lastPeriod}'` }\n            ],\n            mark: {\n              type: \"text\",\n              align: \"left\",\n              baseline: \"middle\",\n              dx: 35,\n              fontSize: 10,\n              fontWeight: \"bold\"\n            },\n            encoding: {\n              text: { field: headers[1], type: \"nominal\" }\n            }\n          }\n        ],\n        config: {\n          view: { stroke: \"transparent\" },\n          font: \"Segoe UI\",\n          text: { \n            font: \"Segoe UI\", \n            fontSize: 11, \n            fill: \"#605E5C\" \n          },\n          axis: {\n            labelColor: \"#605e5c\",\n            titleColor: \"#323130\",\n            gridColor: \"#f3f2f1\"\n          }\n        }\n      };\n      const chartId = `slope_${invocation.address.replace(/[^A-Za-z0-9]/g, \"_\")}`;\n      createChart(spec, \"slope\", chartId)\n        .then(() => resolve(\"Slope\"))\n        .catch((error) => resolve(`Error: ${error.message}`));\n\n    } catch (error) {\n      resolve(`Error: ${error.message}`);\n    }\n  });\n}\n\n/**\n * MEKKO custom function\n * Creates a Mekko chart from Excel data range\n * \n * @customfunction\n * @requiresAddress\n * @param {any[][]} data The data range including headers\n * @param {CustomFunctions.Invocation} invocation Invocation object\n * @returns {string} Status message\n */\nfunction MEKKO(data, invocation) {\n  return new Promise((resolve) => {\n    try {\n      if (!data || data.length < 2) {\n        resolve(\"Error: Need at least header row + one data row\");\n        return;\n      }\n\n      const headers = data[0];\n      const rows = data.slice(1);\n\n      if (headers.length < 3) {\n        resolve(\"Error: Mekko chart requires 3 columns (Category, Subcategory, Value)\");\n        return;\n      }\n\n      // Convert rows -> objects (same as taskpane.js)\n      const processedData = rows.map(row => {\n        let obj = {};\n        headers.forEach((h, i) => {\n          obj[h] = row[i];\n        });\n        return obj;\n      });\n\n      // Use EXACT specification from taskpane.js mekko chart\n      const spec = {\n        $schema: \"https://vega.github.io/schema/vega/v5.json\",\n        description: \"Mekko chart from Excel selection\",\n        width: 800,\n        height: 500,\n        background: \"white\",\n        config: { view: { stroke: \"transparent\" }},\n        view: { stroke: null },\n        padding: { top: 60, bottom: 80, left: 60, right: 60 },\n        data: [\n          {\n            name: \"table\",\n            values: processedData\n          },\n          {\n            name: \"categories\",\n            source: \"table\",\n            transform: [\n              {\n                type: \"aggregate\",\n                fields: [headers[2]],\n                ops: [\"sum\"],\n                as: [\"categoryTotal\"],\n                groupby: [headers[0]]\n              },\n              {\n                type: \"stack\",\n                offset: \"normalize\",\n                sort: { field: \"categoryTotal\", order: \"descending\" },\n                field: \"categoryTotal\",\n                as: [\"x0\", \"x1\"]\n              },\n              {\n                type: \"formula\",\n                as: \"Percent\",\n                expr: \"datum.x1-datum.x0\"\n              },\n              {\n                type: \"formula\",\n                as: \"Label\",\n                expr: `datum.${headers[0]} + ' (' + format(datum.Percent,'.1%') + ')'`\n              }\n            ]\n          },\n          {\n            name: \"finalTable\",\n            source: \"table\",\n            transform: [\n              {\n                type: \"stack\",\n                offset: \"normalize\",\n                groupby: [headers[0]],\n                sort: { field: headers[2], order: \"descending\" },\n                field: headers[2],\n                as: [\"y0\", \"y1\"]\n              },\n              {\n                type: \"stack\",\n                groupby: [headers[0]],\n                sort: { field: headers[2], order: \"descending\" },\n                field: headers[2],\n                as: [\"z0\", \"z1\"]\n              },\n              {\n                type: \"lookup\",\n                from: \"categories\",\n                key: headers[0],\n                values: [\"x0\", \"x1\"],\n                fields: [headers[0]]\n              },\n              {\n                type: \"formula\",\n                as: \"Percent\",\n                expr: \"datum.y1-datum.y0\"\n              },\n              {\n                type: \"formula\",\n                as: \"Label\",\n                expr: `[datum.${headers[1]}, format(datum.${headers[2]}, '.0f') + ' (' + format(datum.Percent, '.1%') + ')']`\n              },\n              {\n                type: \"window\",\n                sort: { field: \"y0\", order: \"ascending\" },\n                ops: [\"row_number\"],\n                fields: [null],\n                as: [\"rank\"],\n                groupby: [headers[0]]\n              }\n            ]\n          }\n        ],\n        scales: [\n          {\n            name: \"x\",\n            type: \"linear\",\n            range: \"width\",\n            domain: { data: \"finalTable\", field: \"x1\" }\n          },\n          {\n            name: \"y\",\n            type: \"linear\",\n            range: \"height\",\n            nice: false,\n            zero: true,\n            domain: { data: \"finalTable\", field: \"z1\" }\n          },\n          {\n            name: \"opacity\",\n            type: \"linear\",\n            range: [1, 0.6],\n            domain: { data: \"finalTable\", field: \"rank\" }\n          },\n          {\n            name: \"color\",\n            type: \"ordinal\",\n            range: { scheme: \"category20\" },\n            domain: {\n              data: \"categories\",\n              field: headers[0],\n              sort: { field: \"x0\", order: \"ascending\", op: \"sum\" }\n            }\n          }\n        ],\n        axes: [\n          {\n            orient: \"left\",\n            scale: \"y\",\n            zindex: 1,\n            format: \"\",\n            tickCount: 5,\n            tickSize: 15,\n            labelColor: { value: \"#333740\" },\n            labelFontWeight: { value: \"normal\" },\n            labelFontSize: { value: 12 },\n            labelFont: { value: \"Segoe UI\" },\n            offset: 5,\n            domain: false,\n            encode: {\n              labels: {\n                update: {\n                  text: { signal: `format(datum.value, '.0f')` }\n                }\n              }\n            }\n          }\n        ],\n        marks: [\n          {\n            type: \"rect\",\n            name: \"bars\",\n            from: { data: \"finalTable\" },\n            encode: {\n              update: {\n                x: { scale: \"x\", field: \"x0\" },\n                x2: { scale: \"x\", field: \"x1\" },\n                y: { scale: \"y\", field: \"z0\" },\n                y2: { scale: \"y\", field: \"z1\" },\n                fill: { scale: \"color\", field: headers[0] },\n                stroke: { value: \"white\" },\n                strokeWidth: { value: 1 },\n                fillOpacity: { scale: \"opacity\", field: \"rank\" },\n                tooltip: { signal: \"datum\" }\n              }\n            }\n          },\n          {\n            type: \"text\",\n            name: \"labels\",\n            interactive: false,\n            from: { data: \"bars\" },\n            encode: {\n              update: {\n                x: { signal: \"(datum.x2 - datum.x)*0.5 + datum.x\" },\n                align: { value: \"center\" },\n                text: { field: \"datum.Label\" },\n                y: { signal: \"(datum.y2 - datum.y)*0.5 + datum.y\" },\n                fill: { value: \"white\" },\n                font: { value: \"Segoe UI\" },\n                lineHeight: { value: 12 },\n                fontSize: { value: 10 },\n                opacity: { signal: \"(datum.x2 - datum.x) > 0.05 && (datum.y2 - datum.y) > 20 ? 1 : 0\" }\n              }\n            }\n          },\n          {\n            type: \"text\",\n            name: \"categoryLabels\",\n            from: { data: \"categories\" },\n            encode: {\n              update: {\n                x: { scale: \"x\", signal: \"(datum.x1-datum.x0)/2 + datum.x0\" },\n                y: { signal: \"-15\" },\n                text: { field: headers[0] },\n                align: { value: \"center\" },\n                baseline: { value: \"bottom\" },\n                fill: { value: \"#333740\" },\n                fontWeight: { value: \"bold\" },\n                fontSize: { value: 12 },\n                font: { value: \"Segoe UI\" }\n              }\n            }\n          },\n          {\n            type: \"text\",\n            name: \"categoryPercentages\",\n            from: { data: \"categories\" },\n            encode: {\n              update: {\n                x: { scale: \"x\", signal: \"(datum.x1-datum.x0)/2 + datum.x0\" },\n                y: { signal: \"height + 30\" },\n                text: { field: \"Label\" },\n                align: { value: \"center\" },\n                baseline: { value: \"top\" },\n                fill: { value: \"#666666\" },\n                fontWeight: { value: \"normal\" },\n                fontSize: { value: 10 },\n                font: { value: \"Segoe UI\" }\n              }\n            }\n          }\n        ]\n      };\n      const chartId = `mekko_${invocation.address.replace(/[^A-Za-z0-9]/g, \"_\")}`;\n      createChart(spec, \"mekko\", chartId)\n        .then(() => resolve(\"Mekko\"))\n        .catch((error) => resolve(`Error: ${error.message}`));\n\n    } catch (error) {\n      resolve(`Error: ${error.message}`);\n    }\n  });\n}\n\n/**\n * MARIMEKKO custom function\n * Creates a marimekko chart from Excel data range\n * \n * @customfunction\n * @requiresAddress\n * @param {any[][]} data The data range including headers\n * @param {CustomFunctions.Invocation} invocation Invocation object\n * @returns {string} Status message\n */\nfunction MARIMEKKO(data, invocation) {\n  return new Promise((resolve) => {\n    try {\n      if (!data || data.length < 2) {\n        resolve(\"Error: Need at least header row + one data row\");\n        return;\n      }\n\n      const headers = data[0];\n      const rows = data.slice(1);\n\n      if (headers.length < 3) {\n        resolve(\"Error: Marimekko chart requires at least 3 columns: Category, Subcategory, Value\");\n        return;\n      }\n\n      // Convert rows -> objects (same as taskpane.js)\n      const processedData = rows.map(row => {\n        let obj = {};\n        headers.forEach((h, i) => {\n          obj[h] = row[i];\n        });\n        return obj;\n      });\n\n      // Use EXACT specification from taskpane.js marimekko chart\n      const spec = {\n        \"$schema\": \"https://vega.github.io/schema/vega/v5.json\",\n        \"description\": \"Marimekko Chart from Excel selection\",\n        \"width\": 600,\n        \"height\": 400,\n        \"background\": \"white\",\n        \"config\": { \"view\": { \"stroke\": \"transparent\" }},\n        \"padding\": { \"top\": 30, \"bottom\": 60, \"left\": 60, \"right\": 60 },\n        \"data\": [\n          {\n            \"name\": \"table\",\n            \"values\": processedData,\n            \"transform\": [\n              {\n                \"type\": \"formula\",\n                \"as\": \"Category\",\n                \"expr\": `datum['${headers[0]}']`\n              },\n              {\n                \"type\": \"formula\", \n                \"as\": \"Subcategory\",\n                \"expr\": `datum['${headers[1]}']`\n              },\n              {\n                \"type\": \"formula\",\n                \"as\": \"Value\", \n                \"expr\": `datum['${headers[2]}']`\n              }\n            ]\n          },\n          {\n            \"name\": \"categories\",\n            \"source\": \"table\",\n            \"transform\": [\n              {\n                \"type\": \"aggregate\",\n                \"fields\": [\"Value\"],\n                \"ops\": [\"sum\"],\n                \"as\": [\"categoryTotal\"],\n                \"groupby\": [\"Category\"]\n              },\n              {\n                \"type\": \"stack\",\n                \"offset\": \"normalize\",\n                \"sort\": { \"field\": \"categoryTotal\", \"order\": \"descending\" },\n                \"field\": \"categoryTotal\",\n                \"as\": [\"x0\", \"x1\"]\n              },\n              {\n                \"type\": \"formula\",\n                \"as\": \"Percent\",\n                \"expr\": \"datum.x1 - datum.x0\"\n              }\n            ]\n          },\n          {\n            \"name\": \"finalTable\",\n            \"source\": \"table\",\n            \"transform\": [\n              {\n                \"type\": \"stack\",\n                \"offset\": \"normalize\",\n                \"groupby\": [\"Category\"],\n                \"sort\": { \"field\": \"Value\", \"order\": \"descending\" },\n                \"field\": \"Value\",\n                \"as\": [\"y0\", \"y1\"]\n              },\n              {\n                \"type\": \"lookup\",\n                \"from\": \"categories\",\n                \"key\": \"Category\",\n                \"values\": [\"x0\", \"x1\"],\n                \"fields\": [\"Category\"]\n              },\n              {\n                \"type\": \"formula\",\n                \"as\": \"Percent\",\n                \"expr\": \"datum.y1 - datum.y0\"\n              }\n            ]\n          }\n        ],\n        \"scales\": [\n          {\n            \"name\": \"x\",\n            \"type\": \"linear\",\n            \"range\": \"width\",\n            \"domain\": { \"data\": \"finalTable\", \"field\": \"x1\" }\n          },\n          {\n            \"name\": \"y\",\n            \"type\": \"linear\",\n            \"range\": \"height\",\n            \"nice\": false,\n            \"zero\": true,\n            \"domain\": { \"data\": \"finalTable\", \"field\": \"y1\" }\n          },\n          {\n            \"name\": \"color\",\n            \"type\": \"ordinal\",\n            \"range\": { \"scheme\": \"category10\" },\n            \"domain\": {\n              \"data\": \"categories\",\n              \"field\": \"Category\",\n              \"sort\": { \"field\": \"x0\", \"order\": \"ascending\", \"op\": \"sum\" }\n            }\n          }\n        ],\n        \"axes\": [\n          {\n            \"orient\": \"left\",\n            \"scale\": \"y\",\n            \"format\": \"%\",\n            \"tickCount\": 5,\n            \"labelColor\": \"#333333\",\n            \"labelFontSize\": 11,\n            \"domain\": false\n          },\n          {\n            \"orient\": \"bottom\",\n            \"scale\": \"x\",\n            \"format\": \"%\",\n            \"tickCount\": 5,\n            \"labelColor\": \"#333333\", \n            \"labelFontSize\": 11,\n            \"domain\": false\n          }\n        ],\n        \"marks\": [\n          {\n            \"type\": \"rect\",\n            \"name\": \"bars\",\n            \"from\": { \"data\": \"finalTable\" },\n            \"encode\": {\n              \"update\": {\n                \"x\": { \"scale\": \"x\", \"field\": \"x0\" },\n                \"x2\": { \"scale\": \"x\", \"field\": \"x1\" },\n                \"y\": { \"scale\": \"y\", \"field\": \"y0\" },\n                \"y2\": { \"scale\": \"y\", \"field\": \"y1\" },\n                \"fill\": { \"scale\": \"color\", \"field\": \"Category\" },\n                \"stroke\": { \"value\": \"white\" },\n                \"strokeWidth\": { \"value\": 1 },\n                \"opacity\": { \"value\": 0.8 },\n                \"tooltip\": { \n                  \"signal\": \"{'Category': datum.Category, 'Subcategory': datum.Subcategory, 'Value': datum.Value, 'Percentage': format(datum.Percent, '.1%')}\" \n                }\n              },\n              \"hover\": {\n                \"opacity\": { \"value\": 1.0 }\n              }\n            }\n          },\n          {\n            \"type\": \"text\",\n            \"name\": \"valueLabels\",\n            \"from\": { \"data\": \"finalTable\" },\n            \"encode\": {\n              \"update\": {\n                \"x\": { \"scale\": \"x\", \"signal\": \"(datum.x1 - datum.x0)/2 + datum.x0\" },\n                \"y\": { \"scale\": \"y\", \"signal\": \"(datum.y1 - datum.y0)/2 + datum.y0\" },\n                \"text\": { \n                  \"signal\": \"datum.Percent > 0.027 ? [datum.Subcategory, format(datum.Value, ',.0f') + ' (' + format(datum.Percent, '.0%') + ')'] : []\" \n                },\n                \"align\": { \"value\": \"center\" },\n                \"baseline\": { \"value\": \"middle\" },\n                \"fill\": { \"value\": \"white\" },\n                \"fontSize\": { \"value\": 10 },\n                \"fontWeight\": { \"value\": \"normal\" },\n                \"font\": { \"value\": \"Segoe UI\" },\n                \"lineHeight\": { \"value\": 12 },\n                \"opacity\": { \"signal\": \"datum.Percent > 0.027 ? 1 : 0\" }\n              }\n            }\n          }\n        ]\n      };\n      const chartId = `marimekko_${invocation.address.replace(/[^A-Za-z0-9]/g, \"_\")}`;\n      createChart(spec, \"marimekko\", chartId)\n        .then(() => resolve(\"Marimekko\"))\n        .catch((error) => resolve(`Error: ${error.message}`));\n\n    } catch (error) {\n      resolve(`Error: ${error.message}`);\n    }\n  });\n}\n\n/**\n * BUMP custom function\n * Creates a bump chart from Excel data range\n * \n * @customfunction\n * @requiresAddress\n * @param {any[][]} data The data range including headers\n * @param {CustomFunctions.Invocation} invocation Invocation object\n * @returns {string} Status message\n */\nfunction BUMP(data, invocation) {\n  return new Promise((resolve) => {\n    try {\n      if (!data || data.length < 2) {\n        resolve(\"Error: Need at least header row + one data row\");\n        return;\n      }\n\n      const headers = data[0];\n      const rows = data.slice(1);\n\n      if (headers.length < 3) {\n        resolve(\"Error: Bump chart requires 3 columns: Time periods, Categories, Rank values\");\n        return;\n      }\n\n      // Convert rows -> objects (same as taskpane.js)\n      const processedData = rows.map(row => {\n        let obj = {};\n        headers.forEach((h, i) => {\n          obj[h] = row[i];\n        });\n        return obj;\n      });\n\n      // Calculate width based on number of unique x-values\n      const uniqueX = [...new Set(processedData.map(d => d[headers[0]]))];\n      const dynamicWidth = Math.max(400, uniqueX.length * 80);\n\n      // Use EXACT specification from taskpane.js bump chart\n      const spec = {\n        $schema: \"https://vega.github.io/schema/vega-lite/v6.json\",\n        description: \"Bump chart from Excel selection\",\n        background: \"white\",\n        config: { view: { stroke: \"transparent\" }},\n        data: { values: processedData },\n        width: dynamicWidth,\n        height: 200,\n        autosize: {\n          type: \"fit\",\n          contains: \"padding\"\n        },\n        padding: { left: 10, right: 10, top: 5, bottom: 5 },\n        encoding: {\n          x: {\n            field: headers[0],\n            type: \"nominal\",\n            axis: { title: \"\" },\n            scale: { type: \"point\", padding: 0.2 }   // reduced from 1 to 0.2\n          },\n          y: {\n            field: headers[2],      \n            type: \"ordinal\",\n            axis: false\n          }\n        },\n        layer: [\n          {\n            mark: { type: \"line\", interpolate: \"monotone\" },\n            encoding: {\n              color: {\n                field: headers[1],   \n                type: \"nominal\",\n                legend: false\n              }\n            }\n          },\n          {\n            mark: { type: \"circle\", size: 400, tooltip: true },\n            encoding: {\n              color: {\n                field: headers[1],\n                type: \"nominal\",\n                legend: false\n              }\n            }\n          },\n          {\n            mark: { type: \"text\", color: \"white\" },\n            encoding: {\n              text: { field: headers[2] }\n            }\n          },\n          {\n            // Left-side labels\n            transform: [\n              { window: [{ op: \"rank\", as: \"rank\" }], sort: [{ field: headers[0], order: \"descending\" }] },\n              { filter: \"datum.rank === 1\" }\n            ],\n            mark: {\n              type: \"text\",\n              align: \"left\",\n              baseline: \"middle\",\n              dx: 15,\n              fontWeight: \"bold\",\n              fontSize: 12\n            },\n            encoding: {\n              text: { field: headers[1], type: \"nominal\" },\n              color: { field: headers[1], type: \"nominal\", legend: false }\n            }\n          },\n          {\n            // Right-side labels\n            transform: [\n              { window: [{ op: \"rank\", as: \"rank\" }], sort: [{ field: headers[0], order: \"ascending\" }] },\n              { filter: \"datum.rank === 1\" }\n            ],\n            mark: {\n              type: \"text\",\n              align: \"right\",\n              baseline: \"middle\",\n              dx: -15,\n              fontWeight: \"bold\",\n              fontSize: 12\n            },\n            encoding: {\n              text: { field: headers[1], type: \"nominal\" },\n              color: { field: headers[1], type: \"nominal\", legend: false }\n            }\n          }\n        ],\n        config: {\n          view: { stroke: \"transparent\" },\n          line: { strokeWidth: 3, strokeCap: \"round\", strokeJoin: \"round\" },\n          axis: {\n            ticks: false,\n            grid: false,\n            domain: false,\n            labelColor: \"#666666\",\n            labelFontSize: 12\n          }\n        }\n      };\n      const chartId = `bump_${invocation.address.replace(/[^A-Za-z0-9]/g, \"_\")}`;\n      createChart(spec, \"bump\", chartId)\n        .then(() => resolve(\"Bump\"))\n        .catch((error) => resolve(`Error: ${error.message}`));\n\n    } catch (error) {\n      resolve(`Error: ${error.message}`);\n    }\n  });\n}\n\n/**\n * WAFFLE custom function\n * Creates a waffle chart from Excel data range\n * \n * @customfunction\n * @requiresAddress\n * @param {any[][]} data The data range including headers\n * @param {CustomFunctions.Invocation} invocation Invocation object\n * @returns {string} Status message\n */\nfunction WAFFLE(data, invocation) {\n  return new Promise((resolve) => {\n    try {\n      if (!data || data.length < 2) {\n        resolve(\"Error: Need at least header row + one data row\");\n        return;\n      }\n\n      const headers = data[0];\n      const rows = data.slice(1);\n\n      if (headers.length < 2) {\n        resolve(\"Error: Waffle chart requires 2 columns: Category names, Values\");\n        return;\n      }\n\n      // Convert rows -> objects (same as taskpane.js)\n      const processedData = rows.map(row => {\n        let obj = {};\n        headers.forEach((h, i) => {\n          obj[h] = row[i];\n        });\n        return obj;\n      });\n\n      // Use EXACT specification from taskpane.js waffle chart\n      const spec = {\n        $schema: \"https://vega.github.io/schema/vega-lite/v5.json\",\n        description: \"Waffle chart from Excel selection\",\n        background: \"white\",\n        config: { view: { stroke: \"transparent\" }},\n        data: { values: processedData },\n        transform: [\n          {\n            joinaggregate: [{\"op\": \"sum\", \"field\": headers[1], \"as\": \"TotalValue\"}]\n          },\n          {\n            calculate: `round(datum.${headers[1]}/datum.TotalValue * 100)`,\n            as: \"PercentOfTotal\"\n          },\n          {\n            aggregate: [{\"op\": \"min\", \"field\": \"PercentOfTotal\", \"as\": \"Percent\"}],\n            groupby: [headers[0]]\n          },\n          {\"calculate\": \"sequence(1,101)\", \"as\": \"Sequence\"},\n          {\"flatten\": [\"Sequence\"]},\n          {\n            calculate: `if(datum.Sequence <= datum.Percent, datum.${headers[0]},'_blank')`,\n            as: \"Plot\"\n          },\n          {\"calculate\": \"ceil (datum.Sequence / 10)\", \"as\": \"row\"},\n          {\"calculate\": \"datum.Sequence - datum.row * 10\", \"as\": \"col\"}\n        ],\n        facet: {\"column\": {\"field\": headers[0], \"header\": {\"labelOrient\": \"bottom\"}}},\n        spec: {\n          layer: [\n            {\n              mark: {\n                type: \"circle\",\n                filled: true,\n                tooltip: true,\n                stroke: \"#9e9b9b\",\n                strokeWidth: 0.7\n              },\n              encoding: {\n                x: {\"field\": \"col\", \"type\": \"ordinal\", \"axis\": null},\n                y: {\"field\": \"row\", \"type\": \"ordinal\", \"axis\": null, \"sort\": \"-y\"},\n                color: {\n                  condition: {\"test\": \"datum.Plot == '_blank'\", \"value\": \"#e6e3e3\"},\n                  scale: {\"scheme\": \"set1\"},\n                  field: \"Plot\",\n                  type: \"nominal\",\n                  legend: null\n                },\n                size: {\"value\": 241},\n                tooltip: [{\"field\": headers[0], \"type\": \"nominal\"}]\n              }\n            },\n            {\n              mark: {\"type\": \"text\", \"fontSize\": 30, \"fontWeight\": \"bold\"},\n              encoding: {\n                y: {\"value\": 30},\n                text: {\n                  condition: {\n                    test: \"datum.Sequence == 1\",\n                    value: {\"expr\": \"datum.Percent + '%'\"}\n                  }\n                },\n                color: {\"scale\": {\"scheme\": \"set1\"}, \"field\": \"Plot\"}\n              }\n            }\n          ]\n        },\n        config: {\n          view: {\"stroke\": \"transparent\"},\n          font: \"Segoe UI\",\n          text: {\"font\": \"Segoe UI\", \"fontSize\": 12, \"fill\": \"#605E5C\"},\n          axis: {\n            ticks: false,\n            grid: false,\n            domain: false,\n            labelColor: \"#605E5C\",\n            labelFontSize: 12\n          },\n          header: {\n            titleFont: \"Segoe UI\",\n            titleFontSize: 16,\n            titleColor: \"#757575\",\n            labelFont: \"Segoe UI\",\n            labelFontSize: 13,\n            labelColor: \"#605E5C\"\n          },\n          legend: {\n            titleFont: \"Segoe UI\",\n            titleFontWeight: \"bold\",\n            titleColor: \"#605E5C\",\n            labelFont: \"Segoe UI\",\n            labelFontSize: 13,\n            labelColor: \"#605E5C\",\n            symbolType: \"circle\",\n            symbolSize: 75\n          }\n        }\n      };\n      const chartId = `waffle_${invocation.address.replace(/[^A-Za-z0-9]/g, \"_\")}`;\n      createChart(spec, \"waffle\", chartId)\n        .then(() => resolve(\"Waffle\"))\n        .catch((error) => resolve(`Error: ${error.message}`));\n\n    } catch (error) {\n      resolve(`Error: ${error.message}`);\n    }\n  });\n}\n\n/**\n * LOLLIPOP custom function\n * Creates a lollipop chart from Excel data range\n * \n * @customfunction\n * @requiresAddress\n * @param {any[][]} data The data range including headers\n * @param {CustomFunctions.Invocation} invocation Invocation object\n * @returns {string} Status message\n */\nfunction LOLLIPOP(data, invocation) {\n  return new Promise((resolve) => {\n    try {\n      if (!data || data.length < 2) {\n        resolve(\"Error: Need at least header row + one data row\");\n        return;\n      }\n\n      const headers = data[0];\n      const rows = data.slice(1);\n\n      if (headers.length < 2) {\n        resolve(\"Error: Lollipop chart requires 2 columns: Category names, Values\");\n        return;\n      }\n\n      // Convert rows -> objects (same as taskpane.js)\n      const processedData = rows.map(row => {\n        let obj = {};\n        headers.forEach((h, i) => {\n          obj[h] = row[i];\n        });\n        return obj;\n      });\n\n      // Use EXACT specification from taskpane.js lollipop chart\n      const spec = {\n        $schema: \"https://vega.github.io/schema/vega-lite/v5.json\",\n        description: \"Lollipop chart from Excel selection\",\n        background: \"white\",\n        config: { view: { stroke: \"transparent\" }},\n        data: { values: processedData },\n        encoding: {\n          y: {\n            field: headers[0],\n            type: \"nominal\",\n            sort: \"-x\",\n            axis: {\n              domain: false,\n              title: null,\n              ticks: false,\n              labelFont: \"Segoe UI\",\n              labelFontSize: 14,\n              labelPadding: 10,\n              labelColor: \"#605e5c\"\n            }\n          },\n          x: {\n            field: headers[1],\n            type: \"quantitative\",\n            axis: {\n              domain: false,\n              ticks: false,\n              grid: true,\n              gridColor: \"#e0e0e0\",\n              labelFont: \"Segoe UI\",\n              labelFontSize: 12,\n              labelColor: \"#605e5c\",\n              title: headers[1],\n              titleFont: \"Segoe UI\",\n              titleFontSize: 14,\n              titleColor: \"#323130\"\n            }\n          },\n          color: { value: \"#0078d4\" }\n        },\n        layer: [\n          {\n            mark: {\n              type: \"rule\",\n              tooltip: true,\n              strokeWidth: 3,\n              opacity: 0.7\n            }\n          },\n          {\n            mark: {\n              type: \"circle\",\n              tooltip: true,\n              size: 300,\n              opacity: 0.9\n            },\n            encoding: {\n              size: {\n                field: headers[1],\n                type: \"quantitative\",\n                scale: {\n                  range: [200, 800]\n                },\n                legend: null\n              }\n            }\n          }\n        ],\n        config: {\n          autosize: {\n            type: \"fit\",\n            contains: \"padding\"\n          },\n          view: { stroke: \"transparent\" },\n          font: \"Segoe UI\",\n          text: { font: \"Segoe UI\", fontSize: 12, fill: \"#605E5C\" }\n        }\n      };\n      const chartId = `lollipop_${invocation.address.replace(/[^A-Za-z0-9]/g, \"_\")}`;\n      createChart(spec, \"lollipop\", chartId)\n        .then(() => resolve(\"Lollipop\"))\n        .catch((error) => resolve(`Error: ${error.message}`));\n\n    } catch (error) {\n      resolve(`Error: ${error.message}`);\n    }\n  });\n}\n\n/**\n * VIOLIN custom function\n * Creates a violin chart from Excel data range\n * \n * @customfunction\n * @requiresAddress\n * @param {any[][]} data The data range including headers\n * @param {CustomFunctions.Invocation} invocation Invocation object\n * @returns {string} Status message\n */\nfunction VIOLIN(data, invocation) {\n  return new Promise((resolve) => {\n    try {\n      if (!data || data.length < 2) {\n        resolve(\"Error: Need at least header row + one data row\");\n        return;\n      }\n\n      const headers = data[0];\n      const rows = data.slice(1);\n\n      if (headers.length < 2) {\n        resolve(\"Error: Violin chart requires 2 columns: Categories/Groups, Continuous values\");\n        return;\n      }\n\n      // Convert rows -> objects\n      const processedData = rows.map(row => {\n        let obj = {};\n        headers.forEach((h, i) => {\n          obj[h] = row[i];\n        });\n        return obj;\n      });\n\n      // Use EXACT specification as provided\n      const spec = {\n        $schema: \"https://vega.github.io/schema/vega-lite/v5.20.1.json\",\n        description: \"Violin chart from Excel selection\",\n        background: \"white\",\n        config: {\n          view: { continuousWidth: 300, continuousHeight: 300, stroke: null },\n          facet: { spacing: 0 }\n        },\n        data: { values: processedData },\n        mark: { type: \"area\", orient: \"horizontal\" },\n        encoding: {\n          color: { field: headers[0], type: \"nominal\" },\n          column: {\n            field: headers[0],\n            header: {\n              labelOrient: \"bottom\",\n              labelPadding: 0,\n              titleOrient: \"bottom\"\n            },\n            type: \"nominal\"\n          },\n          x: {\n            axis: { grid: false, labels: false, ticks: true, values: [0] },\n            field: \"density\",\n            impute: null,\n            stack: \"center\",\n            title: null,\n            type: \"quantitative\"\n          },\n          y: { field: headers[1], type: \"quantitative\" }\n        },\n        transform: [\n          {\n            density: headers[1],\n            groupby: [headers[0]],\n            as: [headers[1], \"density\"]\n          }\n        ],\n        width: 100\n      };\n      const chartId = `violin_${invocation.address.replace(/[^A-Za-z0-9]/g, \"_\")}`;\n      createChart(spec, \"violin\", chartId)\n        .then(() => resolve(\"Violin\"))\n        .catch((error) => resolve(`Error: ${error.message}`));\n\n    } catch (error) {\n      resolve(`Error: ${error.message}`);\n    }\n  });\n}\n\n/**\n * GANTT custom function\n * Creates a Gantt chart from Excel data range\n * \n * @customfunction\n * @requiresAddress\n * @param {any[][]} data The data range including headers\n * @param {CustomFunctions.Invocation} invocation Invocation object\n * @returns {string} Status message\n */\nfunction GANTT(data, invocation) {\n  return new Promise((resolve) => {\n    try {\n      if (!data || data.length < 2) {\n        resolve(\"Error: Need at least header row + one data row\");\n        return;\n      }\n\n      const headers = data[0];\n      const rows = data.slice(1);\n\n      if (headers.length < 6) {\n        resolve(\"Error: Gantt chart requires 6 columns (Parent ID, Task ID, Task Name, Start Date, End Date, Progress)\");\n        return;\n      }\n\n      // Helper function to convert Excel dates (same as taskpane.js)\n      function excelDateToJSDate(serial) {\n        return new Date(Math.round((serial - 25569) * 86400 * 1000));\n      }\n\n      const ganttData = rows.map(row => {\n        const parentId = row[0] || null;   // col 1 = parent id\n        const id = row[1];                 // col 2 = task id\n        const name = row[2] || `Task ${id}`;\n        if (!id) return null;\n\n        const start = typeof row[3] === \"number\" ? excelDateToJSDate(row[3]) : new Date(row[3]);\n        const end = typeof row[4] === \"number\" ? excelDateToJSDate(row[4]) : new Date(row[4]);\n        if (!(start instanceof Date) || isNaN(start) || !(end instanceof Date) || isNaN(end)) return null;\n\n        let progress = 0;\n        if (row[5]) {\n          if (typeof row[5] === \"string\" && row[5].includes(\"%\")) {\n            progress = parseFloat(row[5]) / 100;\n          } else if (row[5] > 1) {\n            progress = row[5] / 100;\n          } else {\n            progress = row[5];\n          }\n        }\n\n        const dependencies = row[6] ? String(row[6]).split(\",\").map(d => d.trim()) : [];\n\n        return { id, parentId, name, startDate: start, endDate: end, progress, dependencies };\n      }).filter(Boolean);\n\n      // Precompute progressEnd\n      ganttData.forEach(task => {\n        const duration = task.endDate - task.startDate;\n        task.progressEnd = new Date(task.startDate.getTime() + duration * task.progress);\n      });\n\n      // Build parent->children map\n      const childrenMap = new Map();\n      ganttData.forEach(task => {\n        if (!childrenMap.has(task.parentId)) {\n          childrenMap.set(task.parentId, []);\n        }\n        childrenMap.get(task.parentId).push(task);\n      });\n\n      // Sort children by startDate\n      for (let [pid, childList] of childrenMap.entries()) {\n        childList.sort((a, b) => a.startDate - b.startDate);\n      }\n\n      // Recursive hierarchy ordering\n      function buildHierarchy(parentId = null, level = 0) {\n        const ordered = [];\n        const tasks = childrenMap.get(parentId) || [];\n        for (const task of tasks) {\n          task.level = level;\n          ordered.push(task);\n          ordered.push(...buildHierarchy(task.id, level + 1));\n        }\n        return ordered;\n      }\n\n      const orderedTasks = buildHierarchy(null);\n\n      // Use EXACT specification from taskpane.js gantt chart\n      const spec = {\n        $schema: \"https://vega.github.io/schema/vega-lite/v5.json\",\n        description: \"Gantt Chart from Excel Data\",\n        width: 800,\n        height: Math.max(300, orderedTasks.length * 30),\n        data: { values: orderedTasks },\n        layer: [\n          {\n            mark: { type: \"bar\", opacity: 0.3, height: 20 },\n            encoding: {\n              y: { field: \"name\", type: \"nominal\", axis: { title: null, labelFontSize: 11 }, sort: null },\n              x: { field: \"startDate\", type: \"temporal\", axis: { title: \"Timeline\", format: \"%b %d\", labelAngle: -45 } },\n              x2: { field: \"endDate\", type: \"temporal\" },\n              color: { field: \"level\", type: \"ordinal\", scale: { scheme: \"category10\" }, legend: { title: \"Level\" } },\n              tooltip: [\n                { field: \"name\", type: \"nominal\", title: \"Task\" },\n                { field: \"startDate\", type: \"temporal\", title: \"Start\", format: \"%Y-%m-%d\" },\n                { field: \"endDate\", type: \"temporal\", title: \"End\", format: \"%Y-%m-%d\" },\n                { field: \"progress\", type: \"quantitative\", title: \"Progress\", format: \".0%\" }\n              ]\n            }\n          },\n          {\n            mark: { type: \"bar\", opacity: 0.8, height: 20 },\n            encoding: {\n              y: { field: \"name\", type: \"nominal\", sort: null },\n              x: { field: \"startDate\", type: \"temporal\" },\n              x2: { field: \"progressEnd\", type: \"temporal\" },\n              color: { field: \"level\", type: \"ordinal\", scale: { scheme: \"category10\" } }\n            }\n          },\n          {\n            mark: { type: \"text\", align: \"left\", baseline: \"middle\", dx: 5, fontSize: 10 },\n            encoding: {\n              y: { field: \"name\", type: \"nominal\", sort: null },\n              x: { field: \"endDate\", type: \"temporal\" },\n              text: { field: \"progress\", type: \"quantitative\", format: \".0%\" },\n              color: { value: \"#666\" }\n            }\n          },\n          {\n            mark: { type: \"rule\", strokeDash: [4, 4], opacity: 0.5 },\n            data: { values: [{ date: new Date().toISOString() }] },\n            encoding: {\n              x: { field: \"date\", type: \"temporal\" },\n              color: { value: \"red\" },\n              size: { value: 1 }\n            }\n          }\n        ],\n        config: { view: { stroke: null }, axis: { grid: true, gridColor: \"#f0f0f0\" } }\n      };\n      const chartId = `gantt_${invocation.address.replace(/[^A-Za-z0-9]/g, \"_\")}`;\n      createChart(spec, \"gantt\", chartId)\n        .then(() => resolve(\"Gantt\"))\n        .catch((error) => resolve(`Error: ${error.message}`));\n\n    } catch (error) {\n      resolve(`Error: ${error.message}`);\n    }\n  });\n}\n\n/**\n * SANKEY custom function\n * Creates a Sankey diagram from Excel data range\n * \n * @customfunction\n * @requiresAddress\n * @param {any[][]} data The data range including headers\n * @param {CustomFunctions.Invocation} invocation Invocation object\n * @returns {string} Status message\n */\nfunction SANKEY(data, invocation) {\n  return new Promise((resolve) => {\n    try {\n      if (!data || data.length < 2) {\n        resolve(\"Error: Need at least header row + one data row\");\n        return;\n      }\n\n      const headers = data[0];\n      const rows = data.slice(1);\n\n      if (headers.length < 3) {\n        resolve(\"Error: Sankey chart requires 3 columns (Source, Target, Value)\");\n        return;\n      }\n\n      // Parse links from Source-Target-Value format\n      const links = rows\n        .filter(r => r[0] && r[1] && !isNaN(+r[2]))\n        .map(r => ({\n          source: String(r[0]).trim(),\n          destination: String(r[1]).trim(),\n          value: +r[2]\n        }));\n\n      if (links.length === 0) {\n        resolve(\"Error: No valid data found for Sankey chart\");\n        return;\n      }\n\n      // Helper function to assign stage levels to nodes using topological sort\n      const assignNodeStages = (links) => {\n        const nodeStages = new Map();\n        const inDegree = new Map();\n        const outEdges = new Map();\n        \n        // Build graph\n        const allNodes = new Set();\n        links.forEach(link => {\n          allNodes.add(link.source);\n          allNodes.add(link.destination);\n          \n          if (!outEdges.has(link.source)) {\n            outEdges.set(link.source, []);\n          }\n          outEdges.get(link.source).push(link.destination);\n          \n          inDegree.set(link.destination, (inDegree.get(link.destination) || 0) + 1);\n        });\n        \n        // Find source nodes (stage 0)\n        const queue = [];\n        allNodes.forEach(node => {\n          if (!inDegree.has(node) || inDegree.get(node) === 0) {\n            queue.push(node);\n            nodeStages.set(node, 0);\n          }\n        });\n        \n        // Handle cycles or no clear sources\n        if (queue.length === 0 && allNodes.size > 0) {\n          const firstNode = Array.from(allNodes)[0];\n          queue.push(firstNode);\n          nodeStages.set(firstNode, 0);\n        }\n        \n        // Topological sort to assign stages\n        const processed = new Set();\n        while (queue.length > 0) {\n          const current = queue.shift();\n          if (processed.has(current)) continue;\n          processed.add(current);\n          \n          const currentStage = nodeStages.get(current) || 0;\n          const neighbors = outEdges.get(current) || [];\n          \n          neighbors.forEach(neighbor => {\n            const newStage = currentStage + 1;\n            const existingStage = nodeStages.get(neighbor);\n            \n            if (existingStage === undefined || newStage > existingStage) {\n              nodeStages.set(neighbor, newStage);\n            }\n            \n            if (!processed.has(neighbor)) {\n              queue.push(neighbor);\n            }\n          });\n        }\n        \n        // Assign stage 0 to any remaining unprocessed nodes\n        allNodes.forEach(node => {\n          if (!nodeStages.has(node)) {\n            nodeStages.set(node, 0);\n          }\n        });\n        \n        return nodeStages;\n      };\n\n      // Auto-detect node stages using topological sort\n      const nodeStages = assignNodeStages(links);\n      \n      // Get all unique nodes\n      const allNodes = new Set();\n      links.forEach(link => {\n        allNodes.add(link.source);\n        allNodes.add(link.destination);\n      });\n\n      // Create category definitions with stack assignments\n      const categories = [];\n      const nodeToStack = new Map();\n      let sortCounter = 1;\n\n      // Group nodes by stage\n      const stageGroups = new Map();\n      allNodes.forEach(node => {\n        const stage = nodeStages.get(node);\n        if (!stageGroups.has(stage)) {\n          stageGroups.set(stage, []);\n        }\n        stageGroups.get(stage).push(node);\n      });\n\n      // Create categories for each node with proper stack assignment\n      const sortedStages = Array.from(stageGroups.keys()).sort((a, b) => a - b);\n      sortedStages.forEach((stage, stageIndex) => {\n        const nodesInStage = stageGroups.get(stage);\n        nodesInStage.sort(); // Sort alphabetically within stage\n        \n        nodesInStage.forEach((node, nodeIndex) => {\n          const stackNumber = stageIndex + 1;\n          nodeToStack.set(node, stackNumber);\n          \n          categories.push({\n            category: node,\n            stack: stackNumber,\n            sort: nodeIndex + 1,\n            labels: stageIndex === 0 ? \"left\" : null\n          });\n        });\n      });\n\n      // Combine categories and links into input data\n      const inputData = [...categories, ...links];\n\n      const spec = {\n        $schema: \"https://vega.github.io/schema/vega/v5.json\",\n        description: \"Sankey diagram\",\n        width: 800,\n        height: 600,\n        padding: { bottom: 20, left: 80, right: 80, top: 40 },\n        background: \"white\",\n        signals: [\n          {\n            name: \"standardGap\",\n            value: 14,\n            description: \"Gap as a percentage of full domain\"\n          },\n          {\n            name: \"base\",\n            value: \"center\",\n            description: \"How to stack (center or zero)\"\n          }\n        ],\n        data: [\n          {\n            name: \"input\",\n            values: inputData\n          },\n          {\n            name: \"stacks\",\n            source: \"input\",\n            transform: [\n              { type: \"filter\", expr: \"datum.source != null\" },\n              { type: \"formula\", as: \"end\", expr: \"['source','destination']\" },\n              { type: \"formula\", as: \"name\", expr: \"[datum.source, datum.destination]\" },\n              { type: \"project\", fields: [\"end\", \"name\", \"value\"] },\n              { type: \"flatten\", fields: [\"end\", \"name\"] },\n              {\n                type: \"lookup\",\n                from: \"input\",\n                key: \"category\",\n                values: [\"stack\", \"sort\", \"gap\", \"labels\"],\n                fields: [\"name\"],\n                as: [\"stack\", \"sort\", \"gap\", \"labels\"]\n              },\n              {\n                type: \"aggregate\",\n                fields: [\"value\", \"stack\", \"sort\", \"gap\", \"labels\"],\n                groupby: [\"end\", \"name\"],\n                ops: [\"sum\", \"max\", \"max\", \"max\", \"max\"],\n                as: [\"value\", \"stack\", \"sort\", \"gap\", \"labels\"]\n              },\n              {\n                type: \"aggregate\",\n                fields: [\"value\", \"stack\", \"sort\", \"gap\", \"labels\"],\n                groupby: [\"name\"],\n                ops: [\"max\", \"max\", \"max\", \"max\", \"max\"],\n                as: [\"value\", \"stack\", \"sort\", \"gap\", \"labels\"]\n              },\n              { type: \"formula\", as: \"gap\", expr: \"datum.gap ? datum.gap : 0\" }\n            ]\n          },\n          {\n            name: \"maxValue\",\n            source: [\"stacks\"],\n            transform: [\n              {\n                type: \"aggregate\",\n                fields: [\"value\"],\n                groupby: [\"stack\"],\n                ops: [\"sum\"],\n                as: [\"value\"]\n              },\n              {\n                type: \"aggregate\",\n                fields: [\"value\"],\n                ops: [\"max\"],\n                as: [\"value\"]\n              }\n            ]\n          },\n          {\n            name: \"plottedStacks\",\n            source: [\"stacks\"],\n            transform: [\n              {\n                type: \"formula\",\n                as: \"spacer\",\n                expr: \"(data('maxValue')[0].value/100)*(standardGap+datum.gap)\"\n              },\n              { type: \"formula\", as: \"type\", expr: \"['data','spacer']\" },\n              { type: \"formula\", as: \"spacedValue\", expr: \"[datum.value, datum.spacer]\" },\n              { type: \"flatten\", fields: [\"type\", \"spacedValue\"] },\n              {\n                type: \"stack\",\n                groupby: [\"stack\"],\n                sort: { field: \"sort\", order: \"descending\" },\n                field: \"spacedValue\",\n                offset: { signal: \"base\" }\n              },\n              { type: \"formula\", expr: \"((datum.value)/2)+datum.y0\", as: \"yc\" }\n            ]\n          },\n          {\n            name: \"finalTable\",\n            source: [\"plottedStacks\"],\n            transform: [{ type: \"filter\", expr: \"datum.type == 'data'\" }]\n          },\n          {\n            name: \"linkTable\",\n            source: [\"input\"],\n            transform: [\n              { type: \"filter\", expr: \"datum.source != null\" },\n              {\n                type: \"lookup\",\n                from: \"finalTable\",\n                key: \"name\",\n                values: [\"y0\", \"y1\", \"stack\", \"sort\"],\n                fields: [\"source\"],\n                as: [\"sourceStacky0\", \"sourceStacky1\", \"sourceStack\", \"sourceSort\"]\n              },\n              {\n                type: \"lookup\",\n                from: \"finalTable\",\n                key: \"name\",\n                values: [\"y0\", \"y1\", \"stack\", \"sort\"],\n                fields: [\"destination\"],\n                as: [\"destinationStacky0\", \"destinationStacky1\", \"destinationStack\", \"destinationSort\"]\n              },\n              {\n                type: \"stack\",\n                groupby: [\"source\"],\n                sort: { field: \"destinationSort\", order: \"descending\" },\n                field: \"value\",\n                offset: \"zero\",\n                as: [\"syi0\", \"syi1\"]\n              },\n              { type: \"formula\", expr: \"datum.syi0+datum.sourceStacky0\", as: \"sy0\" },\n              { type: \"formula\", expr: \"datum.sy0+datum.value\", as: \"sy1\" },\n              {\n                type: \"stack\",\n                groupby: [\"destination\"],\n                sort: { field: \"sourceSort\", order: \"descending\" },\n                field: \"value\",\n                offset: \"zero\",\n                as: [\"dyi0\", \"dyi1\"]\n              },\n              { type: \"formula\", expr: \"datum.dyi0+datum.destinationStacky0\", as: \"dy0\" },\n              { type: \"formula\", expr: \"datum.dy0+datum.value\", as: \"dy1\" },\n              { type: \"formula\", expr: \"((datum.value)/2)+datum.sy0\", as: \"syc\" },\n              { type: \"formula\", expr: \"((datum.value)/2)+datum.dy0\", as: \"dyc\" },\n              {\n                type: \"linkpath\",\n                orient: \"horizontal\",\n                shape: \"diagonal\",\n                sourceY: { expr: \"scale('y', datum.syc)\" },\n                sourceX: { expr: \"scale('x', toNumber(datum.sourceStack)) + bandwidth('x')\" },\n                targetY: { expr: \"scale('y', datum.dyc)\" },\n                targetX: { expr: \"scale('x', datum.destinationStack)\" }\n              },\n              { type: \"formula\", expr: \"range('y')[0]-scale('y', datum.value)\", as: \"strokeWidth\" }\n            ]\n          }\n        ],\n        scales: [\n          {\n            name: \"x\",\n            type: \"band\",\n            range: \"width\",\n            domain: { data: \"finalTable\", field: \"stack\" },\n            paddingInner: 0.88\n          },\n          {\n            name: \"y\",\n            type: \"linear\",\n            range: \"height\",\n            domain: { data: \"finalTable\", field: \"y1\" },\n            reverse: false\n          },\n          {\n            name: \"color\",\n            type: \"ordinal\",\n            range: [\n              \"#1f77b4\", \"#ff7f0e\", \"#2ca02c\", \"#d62728\", \"#9467bd\",\n              \"#8c564b\", \"#e377c2\", \"#7f7f7f\", \"#bcbd22\", \"#17becf\",\n              \"#aec7e8\", \"#ffbb78\", \"#98df8a\", \"#ff9896\", \"#c5b0d5\",\n              \"#c49c94\", \"#f7b6d2\", \"#c7c7c7\", \"#dbdb8d\", \"#9edae5\"\n            ],\n            domain: { data: \"stacks\", field: \"name\" }\n          }\n        ],\n        marks: [\n          {\n            type: \"rect\",\n            from: { data: \"finalTable\" },\n            encode: {\n              update: {\n                x: { scale: \"x\", field: \"stack\" },\n                width: { scale: \"x\", band: 1 },\n                y: { scale: \"y\", field: \"y0\" },\n                y2: { scale: \"y\", field: \"y1\" },\n                fill: { scale: \"color\", field: \"name\" },\n                fillOpacity: { value: 0.75 },\n                strokeWidth: { value: 0 },\n                stroke: { scale: \"color\", field: \"name\" }\n              },\n              hover: {\n                tooltip: { signal: \"{'Name': datum.name, 'Value': format(datum.value, ',.2f')}\" },\n                fillOpacity: { value: 1 }\n              }\n            }\n          },\n          {\n            type: \"path\",\n            name: \"links\",\n            from: { data: \"linkTable\" },\n            clip: true,\n            encode: {\n              update: {\n                strokeWidth: { field: \"strokeWidth\" },\n                path: { field: \"path\" },\n                strokeOpacity: { signal: \"0.3\" },\n                stroke: { field: \"destination\", scale: \"color\" }\n              },\n              hover: {\n                strokeOpacity: { value: 0.8 },\n                tooltip: {\n                  signal: \"{'Source': datum.source, 'Destination': datum.destination, 'Value': format(datum.value, ',.2f')}\"\n                }\n              }\n            }\n          },\n          {\n            type: \"group\",\n            name: \"labelText\",\n            zindex: 1,\n            from: {\n              facet: {\n                data: \"finalTable\",\n                name: \"labelFacet\",\n                groupby: [\"name\", \"stack\", \"yc\", \"value\", \"labels\"]\n              }\n            },\n            clip: false,\n            encode: {\n              update: {\n                x: {\n                  signal: \"datum.labels=='left' ? scale('x', datum.stack)-8 : scale('x', datum.stack) + bandwidth('x') + 8\"\n                },\n                yc: { scale: \"y\", signal: \"datum.yc\" },\n                width: { signal: \"0\" },\n                height: { signal: \"0\" }\n              }\n            },\n            marks: [\n              {\n                type: \"text\",\n                name: \"heading\",\n                from: { data: \"labelFacet\" },\n                encode: {\n                  update: {\n                    x: { value: 0 },\n                    y: { value: -2 },\n                    text: { field: \"name\" },\n                    align: { signal: \"datum.labels=='left' ? 'right' : 'left'\" },\n                    fontWeight: { value: \"bold\" },\n                    fontSize: { value: 11 }\n                  }\n                }\n              },\n              {\n                type: \"text\",\n                name: \"amount\",\n                from: { data: \"labelFacet\" },\n                encode: {\n                  update: {\n                    x: { value: 0 },\n                    y: { value: 12 },\n                    text: { signal: \"format(datum.value, ',.0f')\" },\n                    align: { signal: \"datum.labels=='left' ? 'right' : 'left'\" },\n                    fontSize: { value: 10 }\n                  }\n                }\n              }\n            ]\n          },\n          {\n            type: \"rect\",\n            from: { data: \"labelText\" },\n            encode: {\n              update: {\n                x: { field: \"bounds.x1\", offset: -2 },\n                x2: { field: \"bounds.x2\", offset: 2 },\n                y: { field: \"bounds.y1\", offset: -2 },\n                y2: { field: \"bounds.y2\", offset: 2 },\n                fill: { value: \"white\" },\n                opacity: { value: 0.8 },\n                cornerRadius: { value: 4 }\n              }\n            }\n          }\n        ],\n        config: {\n          view: { stroke: \"transparent\" },\n          text: { fontSize: 11, fill: \"#333333\" }\n        }\n      };\n\n      const chartId = `sankey_${invocation.address.replace(/[^A-Za-z0-9]/g, \"_\")}`;\n      createChart(spec, \"sankey\", chartId)\n        .then(() => resolve(\"Sankey\"))\n        .catch((error) => resolve(`Error: ${error.message}`));\n\n    } catch (error) {\n      resolve(`Error: ${error.message}`);\n    }\n  });\n}\n\n/**\n * RIDGELINE custom function\n * Creates a ridgeline (joyplot) chart from Excel data range\n * \n * @customfunction\n * @requiresAddress\n * @param {any[][]} data The data range including headers\n * @param {CustomFunctions.Invocation} invocation Invocation object\n * @returns {string} Status message\n */\nfunction RIDGELINE(data, invocation) {\n  return new Promise((resolve) => {\n    try {\n      if (!data || data.length < 2) {\n        resolve(\"Error: Need at least header row + one data row\");\n        return;\n      }\n\n      const headers = data[0];\n      const rows = data.slice(1);\n\n      if (headers.length < 3) {\n        resolve(\"Error: Ridgeline chart requires 3 columns (Time/X-axis, Categories, Values)\");\n        return;\n      }\n\n      // Convert rows -> objects (same as taskpane.js)\n      const processedData = rows.map(row => {\n        let obj = {};\n        headers.forEach((h, i) => {\n          obj[h] = row[i];\n        });\n        return obj;\n      });\n\n      // Use EXACT specification from taskpane.js ridgeline chart\n      const spec = {\n        $schema: \"https://vega.github.io/schema/vega-lite/v6.json\",\n        description: \"Ridgeline (Joyplot) chart from Excel selection\",\n        background: \"white\",\n        config: { view: { stroke: \"transparent\" }},\n        data: { values: processedData },\n        mark: {\n          type: \"area\",\n          fillOpacity: 0.7,\n          strokeOpacity: 1,\n          strokeWidth: 1,\n          interpolate: \"monotone\"\n        },\n        width: 400,\n        height: 20,\n        encoding: {\n          x: {\n            field: headers[0],       // date/time column\n            type: \"ordinal\",\n            title: headers[0]\n          },\n          y: {\n            aggregate: \"sum\",\n            field: headers[2],       // value column\n            type: \"quantitative\",\n            scale: { range: [20, -40] },\n            axis: {\n              title: null,\n              values: [0],\n              domain: false,\n              labels: false,\n              ticks: false\n            }\n          },\n          row: {\n            field: headers[1],       // category column\n            type: \"nominal\",\n            title: headers[1],\n            header: {\n              title: null,\n              labelAngle: 0,\n              labelOrient: \"left\",\n              labelAlign: \"left\",\n              labelPadding: 0\n            },\n            sort: { field: headers[0], op: \"max\", order: \"ascending\" }\n          },\n          fill: {\n            field: headers[1],\n            type: \"nominal\",\n            legend: null,\n            scale: { scheme: \"plasma\" }\n          }\n        },\n        resolve: { scale: { y: \"independent\" } },\n        config: {\n          view: { stroke: \"transparent\" },\n          facet: { spacing: 20 },\n          header: {\n            labelFontSize: 12,\n            labelFontWeight: 500,\n            labelAngle: 0,\n            labelAnchor: \"end\",\n            labelOrient: \"top\",\n            labelPadding: -19\n          },\n          axis: {\n            domain: false,\n            grid: false,\n            ticks: false,\n            tickCount: 5,\n            labelFontSize: 12,\n            titleFontSize: 12,\n            titleFontWeight: 400,\n            titleColor: \"#605E5C\"\n          }\n        }\n      };\n      const chartId = `ridgeline_${invocation.address.replace(/[^A-Za-z0-9]/g, \"_\")}`;\n      createChart(spec, \"ridgeline\", chartId)\n        .then(() => resolve(\"Ridgeline\"))\n        .catch((error) => resolve(`Error: ${error.message}`));\n\n    } catch (error) {\n      resolve(`Error: ${error.message}`);\n    }\n  });\n}\n\n/**\n * VARIANCE custom function\n * Creates a variance chart from Excel data range\n * \n * @customfunction\n * @requiresAddress\n * @param {any[][]} data The data range including headers\n * @param {CustomFunctions.Invocation} invocation Invocation object\n * @returns {string} Status message\n */\nfunction VARIANCE(data, invocation) {\n  return new Promise((resolve) => {\n    try {\n      if (!data || data.length < 2) {\n        resolve(\"Error: Need at least header row + one data row\");\n        return;\n      }\n\n      const headers = data[0];\n      const rows = data.slice(1);\n\n      if (headers.length < 3) {\n        resolve(\"Error: Variance chart requires 3 columns (Business Unit, First Metric, Second Metric)\");\n        return;\n      }\n\n      // Convert rows -> objects\n      const processedData = rows.map(row => {\n        let obj = {};\n        headers.forEach((h, i) => {\n          obj[h] = row[i];\n        });\n        return obj;\n      });\n\n      const spec = {\n        \"$schema\": \"https://vega.github.io/schema/vega-lite/v5.json\",\n        \"data\": { \"values\": processedData },\n        \"transform\": [\n          {\n            \"aggregate\": [\n              {\"op\": \"sum\", \"field\": headers[1], \"as\": headers[1]},\n              {\"op\": \"sum\", \"field\": headers[2], \"as\": headers[2]}\n            ],\n            \"groupby\": [headers[0]]\n          },\n          {\n            \"calculate\": `datum['${headers[1]}'] - datum['${headers[2]}']`,\n            \"as\": \"Variance Absolute\"\n          },\n          {\n            \"calculate\": `datum['${headers[2]}'] === 0 ? 0 : datum['${headers[1]}']/datum['${headers[2]}']-1`,\n            \"as\": \"Variance Percent\"\n          }\n        ],\n        \"hconcat\": [\n          {\n            \"width\": 350,\n            \"height\": {\"step\": 50},\n            \"view\": {\"stroke\": \"transparent\"},\n            \"encoding\": {\n              \"color\": {\n                \"type\": \"nominal\",\n                \"scale\": {\n                  \"domain\": [headers[1], headers[2]],\n                  \"range\": [\"#404040\", \"silver\"]\n                },\n                \"legend\": {\"title\": null, \"orient\": \"top\"}\n              },\n              \"y\": {\n                \"field\": headers[0],\n                \"type\": \"nominal\",\n                \"sort\": null,\n                \"axis\": {\"domain\": false, \"offset\": 0, \"ticks\": false, \"title\": \"\", \"labelPadding\": 35}\n              },\n              \"x\": {\n                \"type\": \"quantitative\",\n                \"axis\": {\n                  \"domain\": false,\n                  \"labels\": false,\n                  \"title\": null,\n                  \"ticks\": false,\n                  \"grid\": true,\n                  \"gridColor\": {\n                    \"condition\": {\"test\": \"datum.value === 0\", \"value\": \"#605E5C\"},\n                    \"value\": \"transparent\"\n                  }\n                }\n              }\n            },\n            \"layer\": [\n              {\n                \"mark\": {\n                  \"type\": \"bar\",\n                  \"tooltip\": true,\n                  \"cornerRadius\": 3,\n                  \"yOffset\": 12,\n                  \"height\": {\"band\": 0.5}\n                },\n                \"encoding\": {\n                  \"x\": {\"field\": headers[2]},\n                  \"color\": {\"datum\": headers[2]}\n                }\n              },\n              {\n                \"mark\": {\n                  \"type\": \"bar\",\n                  \"tooltip\": true,\n                  \"cornerRadius\": 3,\n                  \"yOffset\": 0,\n                  \"height\": {\"band\": 0.5}\n                },\n                \"encoding\": {\n                  \"x\": {\"field\": headers[1]},\n                  \"color\": {\"datum\": headers[1]}\n                }\n              },\n              {\n                \"mark\": {\n                  \"type\": \"text\",\n                  \"align\": {\n                    \"expr\": `datum['${headers[1]}'] < 0 ? 'right' : 'left'`\n                  },\n                  \"dx\": {\"expr\": `datum['${headers[1]}'] < 0 ? -5 : 5`},\n                  \"color\": \"black\",\n                  \"fontSize\": 11\n                },\n                \"encoding\": {\n                  \"x\": {\"field\": headers[1], \"type\": \"quantitative\"},\n                  \"text\": {\"field\": headers[1], \"type\": \"quantitative\", \"format\": \",\"}\n                }\n              }\n            ]\n          },\n          {\n            \"width\": 150,\n            \"height\": {\"step\": 50},\n            \"view\": {\"stroke\": \"transparent\"},\n            \"encoding\": {\n              \"y\": {\n                \"field\": headers[0],\n                \"type\": \"nominal\",\n                \"sort\": null,\n                \"axis\": null\n              },\n              \"x\": {\n                \"field\": \"Variance Absolute\",\n                \"type\": \"quantitative\",\n                \"axis\": {\n                  \"domain\": false,\n                  \"labels\": false,\n                  \"title\": null,\n                  \"ticks\": false,\n                  \"grid\": true,\n                  \"gridWidth\": 1,\n                  \"gridColor\": {\n                    \"condition\": {\"test\": \"datum.value === 0\", \"value\": \"#605E5C\"},\n                    \"value\": \"transparent\"\n                  }\n                }\n              }\n            },\n            \"layer\": [\n              {\n                \"mark\": {\n                  \"type\": \"bar\",\n                  \"tooltip\": true,\n                  \"cornerRadius\": 3,\n                  \"yOffset\": 0,\n                  \"height\": {\"band\": 0.5}\n                },\n                \"encoding\": {\n                  \"fill\": {\n                    \"condition\": {\n                      \"test\": \"datum['Variance Absolute'] < 0\",\n                      \"value\": \"#b92929\"\n                    },\n                    \"value\": \"#329351\"\n                  }\n                }\n              },\n              {\n                \"mark\": {\n                  \"type\": \"text\",\n                  \"align\": {\n                    \"expr\": \"datum['Variance Absolute'] < 0 ? 'right' : 'left'\"\n                  },\n                  \"dx\": {\"expr\": \"datum['Variance Absolute'] < 0 ? -5 : 5\"}\n                },\n                \"encoding\": {\n                  \"text\": {\n                    \"field\": \"Variance Absolute\",\n                    \"type\": \"quantitative\",\n                    \"format\": \"+,\"\n                  }\n                }\n              }\n            ]\n          },\n          {\n            \"width\": 150,\n            \"height\": {\"step\": 50},\n            \"view\": {\"stroke\": \"transparent\"},\n            \"transform\": [\n              {\n                \"calculate\": `datum['${headers[2]}'] === 0 ? 'n/m' : format(datum['Variance Percent'], '+.1%')`,\n                \"as\": \"PercentDisplay\"\n              }\n            ],\n            \"encoding\": {\n              \"y\": {\n                \"field\": headers[0],\n                \"type\": \"nominal\",\n                \"sort\": null,\n                \"axis\": null\n              },\n              \"x\": {\n                \"field\": \"Variance Percent\",\n                \"type\": \"quantitative\",\n                \"axis\": {\n                  \"domain\": false,\n                  \"labels\": false,\n                  \"title\": null,\n                  \"ticks\": false,\n                  \"grid\": true,\n                  \"gridColor\": {\n                    \"condition\": {\"test\": \"datum.value === 0\", \"value\": \"#605E5C\"},\n                    \"value\": \"transparent\"\n                  }\n                }\n              }\n            },\n            \"layer\": [\n              {\n                \"mark\": {\"type\": \"rule\", \"tooltip\": true},\n                \"encoding\": {\n                  \"strokeWidth\": {\"value\": 2},\n                  \"stroke\": {\n                    \"condition\": {\n                      \"test\": \"datum['Variance Absolute'] < 0\",\n                      \"value\": \"#b92929\"\n                    },\n                    \"value\": \"#329351\"\n                  }\n                }\n              },\n              {\n                \"mark\": {\"type\": \"circle\", \"tooltip\": true},\n                \"encoding\": {\n                  \"size\": {\"value\": 100},\n                  \"color\": {\n                    \"condition\": {\n                      \"test\": \"datum['Variance Absolute'] < 0\",\n                      \"value\": \"#b92929\"\n                    },\n                    \"value\": \"#329351\"\n                  }\n                }\n              },\n              {\n                \"mark\": {\n                  \"type\": \"text\",\n                  \"align\": {\n                    \"expr\": \"datum['Variance Absolute'] < 0 ? 'right' : 'left'\"\n                  },\n                  \"dx\": {\"expr\": \"datum['Variance Absolute'] < 0 ? -10 : 10\"}\n                },\n                \"encoding\": {\n                  \"text\": {\n                    \"field\": \"PercentDisplay\",\n                    \"type\": \"nominal\"\n                  }\n                }\n              }\n            ]\n          }\n        ],\n        \"config\": {\n          \"view\": {\"stroke\": \"transparent\"},\n          \"padding\": {\"left\": 5, \"top\": 20, \"right\": 5, \"bottom\": 5},\n          \"font\": \"Segoe UI\",\n          \"axis\": {\n            \"labelFontSize\": 12,\n            \"labelPadding\": 10,\n            \"offset\": 5,\n            \"labelFont\": \"Segoe UI\",\n            \"labelColor\": \"#252423\"\n          },\n          \"text\": {\"fontSize\": 12, \"font\": \"Segoe UI\", \"color\": \"#605E5C\"},\n          \"concat\": {\"spacing\": 50},\n          \"legend\": {\n            \"labelFontSize\": 12,\n            \"labelFont\": \"Segoe UI\",\n            \"labelColor\": \"#605E5C\"\n          }\n        }\n      };\n      const chartId = `variance_${invocation.address.replace(/[^A-Za-z0-9]/g, \"_\")}`;\n      createChart(spec, \"variance\", chartId)\n        .then(() => resolve(\"Variance\"))\n        .catch((error) => resolve(`Error: ${error.message}`));\n\n    } catch (error) {\n      resolve(`Error: ${error.message}`);\n    }\n  });\n}\n\n/**\n * DEVIATION custom function\n * Creates a deviation chart from Excel data range\n * \n * @customfunction\n * @requiresAddress\n * @param {any[][]} data The data range including headers\n * @param {CustomFunctions.Invocation} invocation Invocation object\n * @returns {string} Status message\n */\nfunction DEVIATION(data, invocation) {\n  return new Promise((resolve) => {\n    try {\n      if (!data || data.length < 2) {\n        resolve(\"Error: Need at least header row + one data row\");\n        return;\n      }\n\n      const headers = data[0];\n      const rows = data.slice(1);\n\n      if (headers.length < 3) {\n        resolve(\"Error: Deviation chart requires 3 columns (Date/Period, Actual Values, Target/Baseline Values)\");\n        return;\n      }\n\n      // Convert rows -> objects (same as taskpane.js)\n      const processedData = rows.map(row => {\n        let obj = {};\n        headers.forEach((h, i) => {\n          obj[h] = row[i];\n        });\n        return obj;\n      });\n\n      // Use EXACT specification from taskpane.js deviation chart\n      const spec = {\n        $schema: \"https://vega.github.io/schema/vega-lite/v6.json\",\n        description: \"Deviation chart from Excel selection\",\n        background: \"white\",\n        config: { view: { stroke: \"transparent\" }},\n        data: { values: processedData },\n        layer: [\n          {\n            mark: { type: \"line\", tooltip: true, color: \"grey\" },\n            encoding: {\n              x: { field: headers[0], type: \"ordinal\" },\n              y: { field: headers[1], type: \"quantitative\" }\n            }\n          },\n          {\n            mark: { type: \"circle\", size: 80, color: \"grey\", tooltip: true },\n            encoding: {\n              x: { field: headers[0], type: \"ordinal\" },\n              y: { field: headers[1], type: \"quantitative\" }\n            }\n          },\n          {\n            mark: { type: \"rule\", strokeWidth: 2, tooltip: true },\n            encoding: {\n              x: { field: headers[0], type: \"ordinal\" },\n              y: { field: headers[1], type: \"quantitative\" },\n              y2: { field: headers[2] },\n              color: {\n                condition: { test: `datum[\"${headers[1]}\"] < datum[\"${headers[2]}\"]`, value: \"red\" },\n                value: \"green\"\n              }\n            }\n          },\n          {\n            mark: { type: \"circle\", size: 60, tooltip: true },\n            encoding: {\n              x: { field: headers[0], type: \"ordinal\" },\n              y: { field: headers[2], type: \"quantitative\" },\n              color: {\n                condition: { test: `datum[\"${headers[1]}\"] < datum[\"${headers[2]}\"]`, value: \"red\" },\n                value: \"green\"\n              }\n            }\n          }\n        ],\n        encoding: {\n          x: { \n            field: headers[0], \n            type: \"ordinal\", \n            axis: { \n              title: null,\n              labelAngle: 0\n            } \n          },\n          y: { type: \"quantitative\", axis: { title: \"\" } }\n        },\n        config: {\n          view: { stroke: \"transparent\" },\n          line: { strokeWidth: 3, strokeCap: \"round\", strokeJoin: \"round\" },\n          axis: {\n            ticks: false,\n            grid: false,\n            domain: false,\n            labelColor: \"#605E5C\",\n            labelFontSize: 12\n          }\n        }\n      };\n      const chartId = `deviation_${invocation.address.replace(/[^A-Za-z0-9]/g, \"_\")}`;\n      createChart(spec, \"deviation\", chartId)\n        .then(() => resolve(\"Deviation\"))\n        .catch((error) => resolve(`Error: ${error.message}`));\n\n    } catch (error) {\n      resolve(`Error: ${error.message}`);\n    }\n  });\n}\n\n/**\n * RIBBON custom function\n * Creates a ribbon chart from Excel data range\n * \n * @customfunction\n * @requiresAddress\n * @param {any[][]} data The data range including headers\n * @param {CustomFunctions.Invocation} invocation Invocation object\n * @returns {string} Status message\n */\nfunction RIBBON(data, invocation) {\n  return new Promise((resolve) => {\n    try {\n      if (!data || data.length < 2) {\n        resolve(\"Error: Need at least header row + one data row\");\n        return;\n      }\n\n      const headers = data[0];\n      const rows = data.slice(1);\n\n      if (headers.length < 3) {\n        resolve(\"Error: Ribbon chart requires 3 columns (Time periods, Categories, Values)\");\n        return;\n      }\n\n      // Convert rows -> objects (same as taskpane.js)\n      const processedData = rows.map(row => {\n        let obj = {};\n        headers.forEach((h, i) => {\n          obj[h] = row[i];\n        });\n        return obj;\n      });\n\n      // Calculate dynamic dimensions based on data\n      const uniquePeriods = [...new Set(processedData.map(d => d[headers[0]]))];\n      const dynamicWidth = Math.max(600, uniquePeriods.length * 100);\n      const dynamicHeight = 400;\n\n      // Use EXACT specification from taskpane.js ribbon chart\n      const spec = {\n        $schema: \"https://vega.github.io/schema/vega-lite/v6.json\",\n        description: \"Ribbon chart from Excel selection\",\n        background: \"white\",\n        width: dynamicWidth,\n        height: dynamicHeight,\n        config: { view: { stroke: \"transparent\" }},\n        data: { values: processedData },\n        layer: [\n          {\n            mark: { \n              type: \"area\", \n              interpolate: \"monotone\", \n              tooltip: true,\n              opacity: 0.8\n            },\n            encoding: {\n              x: {\n                field: headers[0],\n                type: \"ordinal\",\n                scale: {\n                  type: \"point\",\n                  padding: 0.3\n                },\n                axis: {\n                  title: headers[0],\n                  labelAngle: -45,\n                  labelFontSize: 12,\n                  titleFontSize: 14,\n                  labelPadding: 10,\n                  titlePadding: 20\n                }\n              },\n              y: {\n                aggregate: \"sum\",\n                field: headers[2],\n                type: \"quantitative\",\n                axis: {\n                  title: headers[2],\n                  labelFontSize: 12,\n                  titleFontSize: 14,\n                  grid: true,\n                  gridOpacity: 0.3\n                },\n                stack: \"center\"\n              },\n              color: {\n                field: headers[1],\n                type: \"nominal\",\n                legend: {\n                  title: headers[1],\n                  titleFontSize: 12,\n                  labelFontSize: 11,\n                  orient: \"right\"\n                }\n              },\n              order: {\n                aggregate: \"sum\",\n                field: headers[2],\n                type: \"quantitative\"\n              }\n            }\n          }\n        ],\n        config: {\n          view: { stroke: \"transparent\" },\n          font: \"Segoe UI\",\n          axis: {\n            ticks: false,\n            grid: true,\n            gridColor: \"#f0f0f0\",\n            gridOpacity: 0.5,\n            gridWidth: 1,\n            domain: false,\n            labelColor: \"#605e5c\",\n            titleColor: \"#323130\"\n          },\n          legend: {\n            titleFont: \"Segoe UI\",\n            titleFontWeight: \"bold\",\n            titleColor: \"#323130\",\n            labelFont: \"Segoe UI\",\n            labelColor: \"#605e5c\",\n            symbolType: \"circle\",\n            symbolSize: 75\n          }\n        }\n      };\n      const chartId = `ribbon_${invocation.address.replace(/[^A-Za-z0-9]/g, \"_\")}`;\n      createChart(spec, \"ribbon\", chartId)\n        .then(() => resolve(\"Ribbon\"))\n        .catch((error) => resolve(`Error: ${error.message}`));\n\n    } catch (error) {\n      resolve(`Error: ${error.message}`);\n    }\n  });\n}\n\n/**\n * HEATMAP_BAR custom function\n * Creates a heatmap with bars from Excel data range\n * \n * @customfunction\n * @requiresAddress\n * @param {any[][]} data The data range including headers\n * @param {CustomFunctions.Invocation} invocation Invocation object\n * @returns {string} Status message\n */\nfunction HEATMAP_BAR(data, invocation) {\n  return new Promise((resolve) => {\n    try {\n      if (!data || data.length < 2) {\n        resolve(\"Error: Need at least header row + one data row\");\n        return;\n      }\n\n      const headers = data[0];\n      const rows = data.slice(1);\n\n      if (headers.length < 3) {\n        resolve(\"Error: Heatmap requires 3 columns (Y-categories, X-categories, Values)\");\n        return;\n      }\n\n      // Convert rows -> objects (same as taskpane.js)\n      const processedData = rows.map(row => {\n        let obj = {};\n        headers.forEach((h, i) => {\n          obj[h] = row[i];\n        });\n        return obj;\n      });\n\n      // Use EXACT specification from taskpane.js heatmap chart\n      const spec = {\n        $schema: \"https://vega.github.io/schema/vega-lite/v5.json\",\n        description: \"Heatmap with marginal bars from Excel selection\",\n        background: \"white\",\n        config: { view: { stroke: \"transparent\" }},\n        data: { values: processedData },\n        spacing: 15,\n        bounds: \"flush\",\n        vconcat: [\n          {\n            height: 60,\n            mark: {\n              type: \"bar\",\n              stroke: null,\n              cornerRadiusEnd: 2,\n              tooltip: true,\n              color: \"lightgrey\"\n            },\n            encoding: {\n              x: {\n                field: headers[1],\n                type: \"ordinal\",\n                axis: null\n              },\n              y: {\n                field: headers[2],\n                aggregate: \"mean\",\n                type: \"quantitative\",\n                axis: null\n              }\n            }\n          },\n          {\n            spacing: 15,\n            bounds: \"flush\",\n            hconcat: [\n              {\n                mark: {\n                  type: \"rect\",\n                  stroke: \"white\",\n                  tooltip: true\n                },\n                encoding: {\n                  y: {\n                    field: headers[0],\n                    type: \"ordinal\",\n                    title: headers[0],\n                    axis: {\n                      domain: false,\n                      ticks: false,\n                      labels: true,\n                      labelAngle: 0,\n                      labelPadding: 5\n                    }\n                  },\n                  x: {\n                    field: headers[1],\n                    type: \"ordinal\",\n                    title: headers[1],\n                    axis: {\n                      domain: false,\n                      ticks: false,\n                      labels: true,\n                      labelAngle: 0\n                    }\n                  },\n                  color: {\n                    aggregate: \"mean\",\n                    field: headers[2],\n                    type: \"quantitative\",\n                    title: headers[2],\n                    scale: {\n                      scheme: \"blues\"\n                    },\n                    legend: {\n                      direction: \"vertical\",\n                      gradientLength: 120\n                    }\n                  }\n                }\n              },\n              {\n                mark: {\n                  type: \"bar\",\n                  stroke: null,\n                  cornerRadiusEnd: 2,\n                  tooltip: true,\n                  color: \"lightgrey\"\n                },\n                width: 60,\n                encoding: {\n                  y: {\n                    field: headers[0],\n                    type: \"ordinal\",\n                    axis: null\n                  },\n                  x: {\n                    field: headers[2],\n                    type: \"quantitative\",\n                    aggregate: \"mean\",\n                    axis: null\n                  }\n                }\n              }\n            ]\n          }\n        ],\n        config: {\n          autosize: {\n            type: \"fit\",\n            contains: \"padding\"\n          },\n          view: { stroke: \"transparent\" },\n          font: \"Segoe UI\",\n          text: { font: \"Segoe UI\", fontSize: 12, fill: \"#605E5C\" },\n          axis: {\n            ticks: false,\n            grid: false,\n            domain: false,\n            labelColor: \"#605E5C\",\n            labelFontSize: 12,\n            titleFontSize: 14,\n            titleColor: \"#323130\"\n          },\n          legend: {\n            titleFont: \"Segoe UI\",\n            titleFontWeight: \"bold\",\n            titleColor: \"#605E5C\",\n            labelFont: \"Segoe UI\",\n            labelFontSize: 12,\n            labelColor: \"#605E5C\"\n          }\n        }\n      };\n      const chartId = `heatmap_bar_${invocation.address.replace(/[^A-Za-z0-9]/g, \"_\")}`;\n      createChart(spec, \"heatmap_bar\", chartId)\n        .then(() => resolve(\"Heatmap with Bars\"))\n        .catch((error) => resolve(`Error: ${error.message}`));\n\n    } catch (error) {\n      resolve(`Error: ${error.message}`);\n    }\n  });\n}\n\n/**\n * SCATTER_LINE custom function\n * Creates a scatter plot with regression line from Excel data range\n * \n * @customfunction\n * @requiresAddress\n * @param {any[][]} data The data range including headers\n * @param {CustomFunctions.Invocation} invocation Invocation object\n * @returns {string} Status message\n */\nfunction SCATTER_LINE(data, invocation) {\n  return new Promise((resolve) => {\n    try {\n      if (!data || data.length < 2) {\n        resolve(\"Error: Need at least header row + one data row\");\n        return;\n      }\n      const headers = data[0];\n      const rows = data.slice(1);\n      if (headers.length < 2) {\n        resolve(\"Error: Scatter plot requires at least 2 columns (X, Y values)\");\n        return;\n      }\n      // Convert rows -> objects (same as taskpane.js)\n      const processedData = rows.map(row => {\n        let obj = {};\n        headers.forEach((h, i) => {\n          obj[h] = row[i];\n        });\n        return obj;\n      });\n      // Layered specification with scatter plot + Loess regression\n      const spec = {\n        $schema: \"https://vega.github.io/schema/vega-lite/v6.json\",\n        description: \"Colored scatter plot with Loess regression from Excel selection\",\n        background: \"white\",\n        config: { \n          view: { stroke: \"transparent\" },\n          font: \"Segoe UI\",\n          axis: {\n            labelColor: \"#605e5c\",\n            titleColor: \"#323130\",\n            gridColor: \"#f3f2f1\"\n          },\n          legend: {\n            titleColor: \"#323130\",\n            labelColor: \"#605e5c\"\n          }\n        },\n        data: { values: processedData },\n        layer: [\n          {\n            // Scatter plot layer\n            mark: { type: \"point\", size: 100, tooltip: true },\n            encoding: {\n              x: { \n                field: headers[0], \n                type: \"quantitative\",\n                scale: { zero: false },\n                axis: {\n                  title: headers[0],\n                  labelFontSize: 12,\n                  titleFontSize: 14\n                }\n              },\n              y: { \n                field: headers[1], \n                type: \"quantitative\",\n                scale: { zero: false },\n                axis: {\n                  title: headers[1],\n                  labelFontSize: 12,\n                  titleFontSize: 14\n                }\n              }\n            }\n          },\n          {\n            // Loess regression line layer\n            mark: { \n              type: \"line\", \n              color: \"firebrick\",\n              strokeWidth: 2\n            },\n            transform: [\n              {\n                loess: headers[1],\n                on: headers[0]\n              }\n            ],\n            encoding: {\n              x: { \n                field: headers[0], \n                type: \"quantitative\"\n              },\n              y: { \n                field: headers[1], \n                type: \"quantitative\"\n              }\n            }\n          }\n        ]\n      };\n      const chartId = `scatter_line_${invocation.address.replace(/[^A-Za-z0-9]/g, \"_\")}`;\n      createChart(spec, \"scatter_line\", chartId)\n        .then(() => resolve(\"Scatter with Line\"))\n        .catch((error) => resolve(`Error: ${error.message}`));\n    } catch (error) {\n      resolve(`Error: ${error.message}`);\n    }\n  });\n}\n\n/**\n * LINE_RECTANGLE custom function\n * Creates a line chart with highlighted rectangles from Excel data range\n * \n * @customfunction\n * @requiresAddress\n * @param {any[][]} data The data range including headers\n * @param {CustomFunctions.Invocation} invocation Invocation object\n * @returns {string} Status message\n */\nfunction LINE_RECTANGLE(data, invocation) {\n  return new Promise((resolve) => {\n    try {\n      if (!data || data.length < 2) {\n        resolve(\"Error: Need at least header row + one data row\");\n        return;\n      }\n      \n      const headers = data[0];\n      const rows = data.slice(1);\n      \n      // Convert rows -> objects\n      const processedData = rows.map(row => {\n        let obj = {};\n        headers.forEach((h, i) => {\n          obj[h] = row[i];\n        });\n        return obj;\n      });\n      \n      // Transform data for line chart\n      const transformedData = [];\n      processedData.forEach(row => {\n        if (row[headers[1]] !== null && row[headers[1]] !== undefined && row[headers[1]] !== \"\") {\n          transformedData.push({\n            [headers[0]]: row[headers[0]], // Period\n            value: parseFloat(row[headers[1]]) || 0  // Value\n          });\n        }\n      });\n      \n      // Extract rectangle regions from Highlight column (3rd column)\n      const rectangleData = [];\n      let currentHighlight = null;\n      let startPeriod = null;\n      \n      processedData.forEach((row, index) => {\n        const highlight = row[headers[2]]; // Highlight column\n        const period = row[headers[0]];\n        \n        if (highlight && highlight !== \"\") {\n          if (currentHighlight !== highlight) {\n            // Save previous rectangle if exists\n            if (currentHighlight !== null && startPeriod !== null) {\n              rectangleData.push({\n                start: startPeriod,\n                end: processedData[index - 1][headers[0]],\n                event: currentHighlight\n              });\n            }\n            // Start new rectangle\n            currentHighlight = highlight;\n            startPeriod = period;\n          }\n          \n          // If last row, close the rectangle\n          if (index === processedData.length - 1) {\n            rectangleData.push({\n              start: startPeriod,\n              end: period,\n              event: currentHighlight\n            });\n          }\n        } else {\n          // Empty highlight, close current rectangle if exists\n          if (currentHighlight !== null && startPeriod !== null) {\n            rectangleData.push({\n              start: startPeriod,\n              end: processedData[index - 1][headers[0]],\n              event: currentHighlight\n            });\n            currentHighlight = null;\n            startPeriod = null;\n          }\n        }\n      });\n      \n      // Create Vega-Lite spec with layered chart\n      const spec = {\n        $schema: \"https://vega.github.io/schema/vega-lite/v6.json\",\n        description: \"Line chart with highlighted rectangles\",\n        background: \"white\",\n        config: { view: { stroke: \"transparent\" }},\n        layer: [\n          {\n            mark: { type: \"rect\", opacity: 0.2 },\n            data: { values: rectangleData },\n            encoding: {\n              x: { \n                field: \"start\", \n                type: \"ordinal\"\n              },\n              x2: { \n                field: \"end\", \n                type: \"ordinal\"\n              },\n              color: {\n                field: \"event\", \n                type: \"nominal\",\n                scale: { scheme: \"pastel1\" },\n                legend: {\n                  title: headers[2] || \"Highlights\",  // Use 3rd column header\n                  titleFontSize: 12,\n                  labelFontSize: 11\n                }\n              }\n            }\n          },\n          {\n            mark: { \n              type: \"line\", \n              point: false,\n              tooltip: true,\n              strokeWidth: 2,\n              color: \"#323130\"\n            },\n            data: { values: transformedData },\n            encoding: {\n              x: { \n                field: headers[0], \n                type: \"ordinal\",\n                axis: {\n                  title: headers[0],\n                  labelFontSize: 12,\n                  titleFontSize: 14,\n                  labelAngle: -45,\n                  labelAlign: \"right\"\n                }\n              },\n              y: { \n                field: \"value\", \n                type: \"quantitative\",\n                axis: {\n                  title: headers[1],\n                  labelFontSize: 12,\n                  titleFontSize: 14\n                }\n              }\n            }\n          },\n          {\n            mark: { \n              type: \"point\",\n              filled: true,\n              size: 60,\n              color: \"#323130\"\n            },\n            data: { values: transformedData },\n            encoding: {\n              x: { \n                field: headers[0], \n                type: \"ordinal\",\n                axis: {\n                  title: headers[0],\n                  labelFontSize: 12,\n                  titleFontSize: 14,\n                  labelAngle: -45,\n                  labelAlign: \"right\"\n                }\n              },\n              y: { \n                field: \"value\", \n                type: \"quantitative\"\n              }\n            }\n          }\n        ],\n        config: {\n          font: \"Segoe UI\",\n          axis: {\n            labelColor: \"#605e5c\",\n            titleColor: \"#323130\",\n            gridColor: \"#f3f2f1\"\n          },\n          legend: {\n            titleColor: \"#323130\",\n            labelColor: \"#605e5c\"\n          }\n        }\n      };\n      \n      const chartId = `line_rectangle_${invocation.address.replace(/[^A-Za-z0-9]/g, \"_\")}`;\n      createChart(spec, \"line_rectangle\", chartId)\n        .then(() => resolve(\"Line with Rectangles\"))\n        .catch((error) => resolve(`Error: ${error.message}`));\n        \n    } catch (error) {\n      resolve(`Error: ${error.message}`);\n    }\n  });\n}\n\n/**\n * Create chart\n */\nasync function createChart(spec, chartType, chartId) {\n  // chartId comes directly from caller (cell address based)\n  const hiddenDiv = document.createElement(\"div\");\n  hiddenDiv.style.display = \"none\";\n  hiddenDiv.id = chartId;\n  document.body.appendChild(hiddenDiv);\n\n  if (typeof vegaEmbed === 'undefined') {\n    await loadVegaLibraries();\n  }\n\n  const result = await vegaEmbed(hiddenDiv, spec, { actions: false });\n  const pngUrl = await result.view.toImageURL(\"png\");\n\n  const response = await fetch(pngUrl);\n  const blob = await response.blob();\n  const reader = new FileReader();\n\n  return new Promise((resolve, reject) => {\n    reader.onloadend = async () => {\n      try {\n        const base64data = reader.result.split(\",\")[1];\n        await insertChart(base64data, chartType, chartId);\n        document.body.removeChild(hiddenDiv);\n        resolve();\n      } catch (err) {\n        if (document.body.contains(hiddenDiv)) document.body.removeChild(hiddenDiv);\n        reject(err);\n      }\n    };\n    reader.readAsDataURL(blob);\n  });\n}\n\n/**\n * Insert chart\n */\nasync function insertChart(base64data, chartType, chartId) {\n  return Excel.run(async (context) => {\n    const sheet = context.workbook.worksheets.getActiveWorksheet();\n\n    // Remove old chart and get its position\n    const oldPosition = await removeExistingCharts(context, sheet, chartType, chartId);\n\n    let left, top, targetWidth, targetHeight;\n\n    if (oldPosition) {\n      left = oldPosition.left;\n      top = oldPosition.top;\n      targetWidth = oldPosition.width;\n      targetHeight = oldPosition.height;\n    } else {\n      const range = context.workbook.getSelectedRange();\n      range.load(\"left, top, width, height\");\n      await context.sync();\n      left = range.left;\n      top = range.top;\n    }\n\n    const image = sheet.shapes.addImage(base64data);\n    image.left = left;\n    image.top = top;\n    if (oldPosition) {\n      image.lockAspectRatio = false;\n      image.width = targetWidth;\n      image.height = targetHeight;\n    } else {\n      image.lockAspectRatio = true;\n    }\n    image.name = `${chartType.charAt(0).toUpperCase() + chartType.slice(1)}Chart_${chartId}`;\n\n    await context.sync();\n  });\n}\n\n/**\n * Remove existing chart\n */\nasync function removeExistingCharts(context, sheet, chartType, chartId) {\n  const shapes = sheet.shapes;\n  shapes.load(\"items\");\n  await context.sync();\n\n  const chartName = `${chartType.charAt(0).toUpperCase() + chartType.slice(1)}Chart_${chartId}`;\n  let oldPosition = null;\n\n  shapes.items.forEach(shape => {\n    shape.load([\"name\", \"left\", \"top\", \"width\", \"height\"]);\n  });\n  await context.sync();\n\n  for (let shape of shapes.items) {\n    if (shape.name === chartName) {\n      oldPosition = {\n        left: shape.left,\n        top: shape.top,\n        width: shape.width,\n        height: shape.height,\n      };\n      shape.delete();\n    }\n  }\n\n  await context.sync();\n  return oldPosition;\n}\n\n/**\n * Load Vega libraries\n */\nfunction loadVegaLibraries() {\n  return new Promise((resolve, reject) => {\n    if (typeof vegaEmbed !== 'undefined') {\n      resolve();\n      return;\n    }\n\n    // Load libraries in sequence (same as taskpane.html)\n    const scripts = [\n      'https://cdn.jsdelivr.net/npm/vega@6',\n      'https://cdn.jsdelivr.net/npm/vega-lite@6', \n      'https://cdn.jsdelivr.net/npm/vega-embed@6'\n    ];\n\n    let loadedCount = 0;\n    \n    scripts.forEach((src, index) => {\n      const script = document.createElement('script');\n      script.src = src;\n      script.onload = () => {\n        loadedCount++;\n        if (loadedCount === scripts.length) {\n          resolve();\n        }\n      };\n      script.onerror = () => reject(new Error(`Failed to load ${src}`));\n      document.head.appendChild(script);\n    });\n  });\n}\n\nif (typeof CustomFunctions !== 'undefined') {\n  CustomFunctions.associate(\"LINE\", LINE);\n  CustomFunctions.associate(\"STEP\", STEP);\n  CustomFunctions.associate(\"COLUMN\", COLUMN);\n  CustomFunctions.associate(\"BAR\", BAR);\n  CustomFunctions.associate(\"BUTTERFLY\", BUTTERFLY);\n  CustomFunctions.associate(\"BEESWARM\", BEESWARM);\n  CustomFunctions.associate(\"FUNNEL\", FUNNEL);\n  CustomFunctions.associate(\"PIE\", PIE);\n  CustomFunctions.associate(\"DONUT\", DONUT);\n  CustomFunctions.associate(\"GAUGE\", GAUGE);\n  CustomFunctions.associate(\"AREA\", AREA);\n  CustomFunctions.associate(\"SCATTER\", SCATTER);\n  CustomFunctions.associate(\"BUBBLE\", BUBBLE);\n  CustomFunctions.associate(\"RADIAL\", RADIAL);\n  CustomFunctions.associate(\"CHORD\", CHORD);\n  CustomFunctions.associate(\"CIRCLEPACKING\", CIRCLEPACKING);\n  CustomFunctions.associate(\"CIRCULARBAR\", CIRCULARBAR);\n  CustomFunctions.associate(\"RING\", RING);\n  CustomFunctions.associate(\"BOX\", BOX);\n  CustomFunctions.associate(\"RADAR\", RADAR);\n  CustomFunctions.associate(\"WATERFALL\", WATERFALL);\n  CustomFunctions.associate(\"SUNBURST\", SUNBURST);\n  CustomFunctions.associate(\"TREEMAP\", TREEMAP);\n  CustomFunctions.associate(\"HISTOGRAM\", HISTOGRAM);\n  CustomFunctions.associate(\"DENSITY\", DENSITY);\n  CustomFunctions.associate(\"CANDLESTICK\", CANDLESTICK);\n  CustomFunctions.associate(\"MAP\", MAP);\n  CustomFunctions.associate(\"CONTOUR\", CONTOUR);\n  CustomFunctions.associate(\"ARC\", ARC);\n  CustomFunctions.associate(\"TREE\", TREE);\n  CustomFunctions.associate(\"WORDCLOUD\", WORDCLOUD);\n  CustomFunctions.associate(\"STRIP\", STRIP);\n  CustomFunctions.associate(\"HEATMAP\", HEATMAP);\n  CustomFunctions.associate(\"TABLEBUBBLE\", TABLEBUBBLE);\n  CustomFunctions.associate(\"BULLET\", BULLET);\n  CustomFunctions.associate(\"HORIZON\", HORIZON);\n  CustomFunctions.associate(\"STREAMGRAPH\", STREAMGRAPH);\n  CustomFunctions.associate(\"DUMBBELL\", DUMBBELL);\n  CustomFunctions.associate(\"SLOPE\", SLOPE);\n  CustomFunctions.associate(\"MEKKO\", MEKKO);\n  CustomFunctions.associate(\"MARIMEKKO\", MARIMEKKO);\n  CustomFunctions.associate(\"BUMP\", BUMP);\n  CustomFunctions.associate(\"FAN\", FAN);\n  CustomFunctions.associate(\"WAFFLE\", WAFFLE);\n  CustomFunctions.associate(\"LOLLIPOP\", LOLLIPOP);\n  CustomFunctions.associate(\"VIOLIN\", VIOLIN);\n  CustomFunctions.associate(\"GANTT\", GANTT);\n  CustomFunctions.associate(\"SANKEY\", SANKEY);\n  CustomFunctions.associate(\"RIBBON\", RIBBON);\n  CustomFunctions.associate(\"RIDGELINE\", RIDGELINE);\n  CustomFunctions.associate(\"DEVIATION\", DEVIATION);\n  CustomFunctions.associate(\"VARIANCE\", VARIANCE);\n  CustomFunctions.associate(\"HEATMAP_BAR\", HEATMAP_BAR);\n  CustomFunctions.associate(\"SCATTER_LINE\", SCATTER_LINE);\n  CustomFunctions.associate(\"LINE_RECTANGLE\", LINE_RECTANGLE);\n}\nCustomFunctions.associate(\"LINE\", LINE);\nCustomFunctions.associate(\"STEP\", STEP);\nCustomFunctions.associate(\"FAN\", FAN);\nCustomFunctions.associate(\"COLUMN\", COLUMN);\nCustomFunctions.associate(\"BAR\", BAR);\nCustomFunctions.associate(\"BUTTERFLY\", BUTTERFLY);\nCustomFunctions.associate(\"BEESWARM\", BEESWARM);\nCustomFunctions.associate(\"FUNNEL\", FUNNEL);\nCustomFunctions.associate(\"GAUGE\", GAUGE);\nCustomFunctions.associate(\"PIE\", PIE);\nCustomFunctions.associate(\"DONUT\", DONUT);\nCustomFunctions.associate(\"CHORD\", CHORD);\nCustomFunctions.associate(\"CIRCLEPACKING\", CIRCLEPACKING);\nCustomFunctions.associate(\"CIRCULARBAR\", CIRCULARBAR);\nCustomFunctions.associate(\"AREA\", AREA);\nCustomFunctions.associate(\"STREAMGRAPH\", STREAMGRAPH);\nCustomFunctions.associate(\"SCATTER\", SCATTER);\nCustomFunctions.associate(\"BUBBLE\", BUBBLE);\nCustomFunctions.associate(\"RING\", RING);\nCustomFunctions.associate(\"RADIAL\", RADIAL);\nCustomFunctions.associate(\"BOX\", BOX);\nCustomFunctions.associate(\"RADAR\", RADAR);\nCustomFunctions.associate(\"WATERFALL\", WATERFALL);\nCustomFunctions.associate(\"SUNBURST\", SUNBURST);\nCustomFunctions.associate(\"TREEMAP\", TREEMAP);\nCustomFunctions.associate(\"HISTOGRAM\", HISTOGRAM);\nCustomFunctions.associate(\"DENSITY\", DENSITY);\nCustomFunctions.associate(\"MAP\", MAP);\nCustomFunctions.associate(\"CONTOUR\", CONTOUR);\nCustomFunctions.associate(\"CANDLESTICK\", CANDLESTICK);\nCustomFunctions.associate(\"ARC\", ARC);\nCustomFunctions.associate(\"TREE\", TREE);\nCustomFunctions.associate(\"WORDCLOUD\", WORDCLOUD);\nCustomFunctions.associate(\"STRIP\", STRIP);\nCustomFunctions.associate(\"HEATMAP\", HEATMAP);\nCustomFunctions.associate(\"TABLEBUBBLE\", TABLEBUBBLE);\nCustomFunctions.associate(\"BULLET\", BULLET);\nCustomFunctions.associate(\"HORIZON\", HORIZON);\nCustomFunctions.associate(\"DUMBBELL\", DUMBBELL);\nCustomFunctions.associate(\"SLOPE\", SLOPE);\nCustomFunctions.associate(\"MEKKO\", MEKKO);\nCustomFunctions.associate(\"MARIMEKKO\", MARIMEKKO);\nCustomFunctions.associate(\"BUMP\", BUMP);\nCustomFunctions.associate(\"WAFFLE\", WAFFLE);\nCustomFunctions.associate(\"LOLLIPOP\", LOLLIPOP);\nCustomFunctions.associate(\"VIOLIN\", VIOLIN);\nCustomFunctions.associate(\"GANTT\", GANTT);\nCustomFunctions.associate(\"SANKEY\", SANKEY);\nCustomFunctions.associate(\"RIDGELINE\", RIDGELINE);\nCustomFunctions.associate(\"VARIANCE\", VARIANCE);\nCustomFunctions.associate(\"DEVIATION\", DEVIATION);\nCustomFunctions.associate(\"RIBBON\", RIBBON);\nCustomFunctions.associate(\"HEATMAP_BAR\", HEATMAP_BAR);\nCustomFunctions.associate(\"SCATTER_LINE\", SCATTER_LINE);\nCustomFunctions.associate(\"LINE_RECTANGLE\", LINE_RECTANGLE);"],"names":["e","t","r","Symbol","n","iterator","o","toStringTag","i","c","prototype","Generator","u","Object","create","_regeneratorDefine2","f","p","y","G","v","a","d","bind","length","l","TypeError","call","done","value","return","GeneratorFunction","GeneratorFunctionPrototype","getPrototypeOf","setPrototypeOf","__proto__","displayName","_regenerator","w","m","defineProperty","_invoke","enumerable","configurable","writable","_typeof","constructor","asyncGeneratorStep","Promise","resolve","then","_asyncToGenerator","arguments","apply","_next","_throw","_slicedToArray","Array","isArray","_arrayWithHoles","next","push","_iterableToArrayLimit","_unsupportedIterableToArray","_nonIterableRest","ownKeys","keys","getOwnPropertySymbols","filter","getOwnPropertyDescriptor","_objectSpread","forEach","_defineProperty","getOwnPropertyDescriptors","defineProperties","_toConsumableArray","_arrayLikeToArray","_arrayWithoutHoles","from","_iterableToArray","_nonIterableSpread","_createForOfIteratorHelper","_n","F","s","toString","slice","name","test","toPrimitive","String","_toPrimitive","_toPropertyKey","LINE","data","invocation","headers","processedData","map","row","obj","h","transformedData","valueColumns","colName","undefined","parseFloat","createChart","$schema","description","background","config","view","stroke","values","mark","type","point","tooltip","strokeWidth","encoding","x","field","axis","title","labelFontSize","titleFontSize","labelAngle","color","scale","scheme","legend","font","labelColor","titleColor","gridColor","size","filled","concat","address","replace","catch","error","message","STEP","rows","stepData","index","serial","date","Date","Math","round","price","isNaN","getTime","toISOString","Boolean","FAN","fanData","actual","p50","p75_low","p75_high","p95_low","p95_high","sort","b","_step","splitYear","_iterator","err","isTemporalX","toLowerCase","includes","xValues","xEncoding","format","yAxisConfig","grid","spec","width","height","layer","some","transform","opacity","y2","strokeDash","COLUMN","categoryField","valueField","groupField","categoryGroups","cat","grp","Set","add","needsGrouping","groups","shadeCounter","key","level","shadeLevel","stack","xOffset","fillOpacity","domain","range","BAR","yOffset","BUTTERFLY","maxLeft","max","abs","maxRight","maxValue","spacing","hconcat","valid","aggregate","align","text","BEESWARM","group","id","uniqueGroups","padding","left","right","top","bottom","autosize","signals","update","scales","axes","orient","labelAlign","labelBaseline","labelFont","titleFont","domainColor","ticks","tickColor","marks","encode","enter","fill","xfocus","band","yfocus","signal","zindex","hover","iterations","static","forces","force","radius","strength","FUNNEL","total","reduce","sum","isPercentage","every","val","Number","isInteger","dataWithPercentages","label","toFixed","toLocaleString","numBars","colorRange","lighten","g","labelPadding","dx","fontSize","fontWeight","GAUGE","gaugeRow","PIE","outerRadius","theta","DONUT","innerRadius","CHORD","nodeSet","nodeLabels","nodeIndex","matrix","source","dest","sourceIdx","destIdx","nodeTotals","j","totalSum","chords","currentAngle","totalPadding","availableAngle","PI","angleSize","startAngle","endAngle","usedAngles","start","end","ribbonsPaths","sourceChord","targetChord","sourceAngleSpan","sourceStart","sourceEnd","targetAngleSpan","targetStart","targetEnd","s0x","cos","s0y","sin","s1x","s1y","t0x","t0y","t1x","t1y","sourceLargeArc","targetLargeArc","path","target","sourceLabel","targetLabel","CIRCLEPACKING","nodes","Map","parent","child","has","set","existingNode","get","hierarchicalData","allIds","node","nodeCount","chartSize","min","CIRCULARBAR","idx","anglePerBar","barWidth","thetaStart","thetaEnd","theta2","zero","rangeMin","radius2","radiusOffset","AREA","line","x1","y1","x2","gradient","stops","offset","STREAMGRAPH","xAxisType","firstColValue","parsedDate","interpolate","tickSize","SCATTER","shape","BUBBLE","RING","numRings","ringWidth","ringGap","maxRadius","generateRingColor","saturation","lightness","chartData","assign","ringPositions","currentOuter","outer","inner","middle","legendStartY","flat","RADIAL","window","op","as","order","BOX","category","extent","RADAR","radarData","dimensions","seriesIndex","seriesName","dimension","indexOf","series","uniqueDimensions","nice","domainMin","facet","strokeOpacity","baseline","WATERFALL","processedDataRaw","numDataPoints","dynamicWidth","maxAmount","paddingInner","paddingOuter","condition","SUNBURST","TREEMAP","treeData","find","parentKey","method","ratio","expr","interactive","HISTOGRAM","numericData","minVal","maxVal","binWidth","niceMin","floor","niceMax","ceil","DENSITY","density","bandwidth","MAP","isoToId","worldData","iso","toUpperCase","trim","rate","url","feature","lookup","fields","projection","CONTOUR","filteredData","yValues","xRange","yRange","dynamicHeight","hasGrouping","CANDLESTICK","candlestickData","open","high","low","close","ARC","edges","nodeMap","edge","edgesWithIndices","groupby","ops","default","count","mult","sourceX","targetX","sourceY","targetY","angle","TREE","WORDCLOUD","case","pattern","stopwords","rotate","fontSizeRange","STRIP","thickness","gridOpacity","HEATMAP","labels","direction","titleAlign","titleFontWeight","TABLEBUBBLE","BULLET","ranges","measures","markers","HORIZON","horizonData","maxY","minY","bandHeight","dataPoints","DUMBBELL","dumbellData","value1","value2","period","categoryCount","minExtent","detail","SLOPE","timePeriods","categories","firstPeriod","lastPeriod","slopeData","formatString","contains","labelFontWeight","datum","dy","fontStyle","MEKKO","tickCount","lineHeight","MARIMEKKO","BUMP","uniqueX","strokeCap","strokeJoin","WAFFLE","joinaggregate","calculate","header","symbolType","symbolSize","LOLLIPOP","VIOLIN","continuousWidth","continuousHeight","column","labelOrient","titleOrient","impute","GANTT","excelDateToJSDate","buildHierarchy","_step3","parentId","ordered","_iterator3","childrenMap","task","ganttData","progress","startDate","endDate","dependencies","split","duration","progressEnd","_step2","_iterator2","entries","_step2$value","orderedTasks","SANKEY","links","destination","nodeStages","inDegree","outEdges","allNodes","link","queue","firstNode","processed","_loop","current","shift","currentStage","neighbor","newStage","existingStage","assignNodeStages","nodeToStack","stageGroups","stage","stageIndex","nodesInStage","stackNumber","reverse","clip","yc","cornerRadius","RIDGELINE","labelAnchor","VARIANCE","DEVIATION","RIBBON","uniquePeriods","titlePadding","gridWidth","HEATMAP_BAR","bounds","vconcat","cornerRadiusEnd","gradientLength","SCATTER_LINE","loess","on","LINE_RECTANGLE","rectangleData","currentHighlight","startPeriod","highlight","event","_x","_x2","_x3","_createChart","_callee2","chartType","chartId","hiddenDiv","result","pngUrl","response","blob","reader","_context2","document","createElement","style","display","body","appendChild","vegaEmbed","loadVegaLibraries","actions","toImageURL","fetch","FileReader","reject","onloadend","_callee","base64data","_t","_context","insertChart","removeChild","readAsDataURL","_x4","_x5","_x6","_insertChart","_callee4","_context4","Excel","run","_ref4","_callee3","context","sheet","oldPosition","targetWidth","targetHeight","image","_context3","workbook","worksheets","getActiveWorksheet","removeExistingCharts","getSelectedRange","load","sync","shapes","addImage","lockAspectRatio","charAt","_x1","_x7","_x8","_x9","_x0","_removeExistingCharts","_callee5","chartName","_iterator4","_step4","_context5","items","delete","scripts","loadedCount","src","script","onload","onerror","Error","head","CustomFunctions","associate"],"sourceRoot":""}